---
title: 多元数据分析作业
authors:
  - name: 周杰 113120230073
    affiliation: The GanNan medical University 
    roles: writing
    corresponding: true
bibliography: references.bib
---

113120230073 周杰

## 设抽了五个样品，每个样品只测了一个指标，它们分别是1 ,2 ,4.5 ,6 ,8。若样本间采用欧式距离，试用最短距离法、最长距离法、类平均法分别对其进行分类，并给出聚类图。

我们有五个样品：

x1=1,x2=2,x3=4.5,x4=6,x5=8x_1 = 1,\quad x_2 = 2,\quad x_3 = 4.5,\quad x_4 = 6,\quad x_5 = 8x1​=1,x2​=2,x3​=4.5,x4​=6,x5​=8

并采用**欧式距离**（Euclidean distance），即：

d(xi,xj)=∣xi−xj∣

## 一、计算样本间距离矩阵

| 样本    | 1   | 2   | 4.5 | 6   | 8   |
|---------|-----|-----|-----|-----|-----|
| **1**   | 0   | 1   | 3.5 | 5   | 7   |
| **2**   | 1   | 0   | 2.5 | 4   | 6   |
| **4.5** | 3.5 | 2.5 | 0   | 1.5 | 3.5 |
| **6**   | 5   | 4   | 1.5 | 0   | 2   |
| **8**   | 7   | 6   | 3.5 | 2   | 0   |

### 1️⃣ 最短距离法（Single Linkage）

也称为**最近邻法**，类间距离定义为：

D(A,B)=min⁡∈d(i,j)min​d(i,j)

#### 第一步：

最近的两个点是 `1` 和 `2`（距离 = 1），合并为一类：

C_1 = {1,2},\quad 4.5, 6, 8

#### 第二步：

计算新类与其他类的距离：

d(C1,4.5)=min⁡(3.5,2.5)=2.5

d(C1,6)=min⁡(5,4)=4

d(C1,8)=min⁡(7,6)=6

最近的是 C1​ 与 4.5（2.5），合并：

C_2 = {1,2,4.5},\quad 6, 8

#### 第三步：

计算：

d(C2,6)=min⁡(5,4,1.5)=1.5​,

d(C2,8)=min⁡(7,6,3.5)=3.5​

于是合并 C2C_2C2​ 和 6：

C_3 = {1,2,4.5,6},\quad 8

#### 第四步：

d(C3,8)=min⁡(7,6,3.5,2)=2

全部合并完毕。

**合并距离顺序：**\
1 → 2（1）\
(1,2) → 4.5（2.5）\
(1,2,4.5) → 6（1.5）\
(1,2,4.5,6) → 8（2）

### 2️⃣ 最长距离法（Complete Linkage）

也称为**最远邻法**：

D(A,B)=max⁡∈d(i,j) \#### 第一步：

`1` 和 `2` 最近（1），合并：

C_1 = {1,2}C1​={1,2}

#### 第二步：

计算：

d(C1,4.5)=max⁡(3.5,2.5)=3.5

d(C1,6)=max⁡(5,4)=5

d(C1,8)=max⁡(7,6)=7

d(4.5,6)=1.5,d(6,8)=2,d(4.5,8)=3.5d(4.5,6)=1.5, \quad d(6,8)=2, \quad d(4.5,8)=3.5d(4.5,6)=1.5,d(6,8)=2,d(4.5,8)=3.5

→ 最近的是 `4.5` 和 `6`（1.5），合并：

C2​={4.5,6}

#### 第三步：

计算：

d(C1,C2)=max⁡(∣1−4.5∣,∣1−6∣,∣2−4.5∣,∣2−6∣)=5 d(C1,8)=7 d(C2,8)=max⁡(3.5,2)=3.5

→ 合并 C2C_2C2​ 与 888（3.5）：

C3={4.5,6,8}

#### 第四步：

d(C1,C3)=max⁡(∣1−4.5∣,∣1−6∣,∣1−8∣,∣2−4.5∣,∣2−6∣,∣2−8∣)=7

最终合并。

**合并距离顺序：**\
1 → 2（1）\
4.5 → 6（1.5）\
(4.5,6) → 8（3.5）\
(1,2) → (4.5,6,8)（7）

```{python}
samples = [1, 2, 4.5, 6, 8]

import numpy as np
from scipy.cluster.hierarchy import linkage, dendrogram
import matplotlib.pyplot as plt

# 数据
X = np.array([[1], [2], [4.5], [6], [8]])

# 三种方法：最短距离法(single)、最长距离法(complete)、类平均法(average)
methods = ['single', 'complete', 'average']
titles = ['最短距离法（Single Linkage）', '最长距离法（Complete Linkage）', '类平均法（Average Linkage）']

plt.figure(figsize=(12, 8))

for i, method in enumerate(methods, 1):
    # 进行层次聚类
    Z = linkage(X, method=method, metric='euclidean')
    
    # 绘制树状图
    plt.subplot(1, 3, i)
    dendrogram(Z, labels=['1','2','4.5','6','8'], color_threshold=0)
    plt.title(titles[i-1], fontsize=12)
    plt.xlabel("样品编号")
    plt.ylabel("距离")

plt.tight_layout()
plt.show()

```