{
  "hash": "10c1eb293f0f8963b895e66ef79df90f",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: 1.æ•°æ®å¤„ç†ï¼š\n---\n\n\n\n-   é€Ÿè§ˆè¡¨1ï¼Œå±•ç°è¡Œæ•°åˆ—æ•°ï¼Œåˆ—åï¼Œæ•°æ®ç±»å‹ç­‰ã€‚\n\n-   ä½¿ç”¨ç­›é€‰ä¸€ä¸ªBRCA1_truncatingåˆ—ä¸ºâ€œYesâ€ï¼Œä¸”â€œBRCA2_truncatingåˆ—ä¸ºâ€œYesâ€ï¼Œä¸”relativeåˆ—ä¸º\"Full Sibling\"æˆ–\"Child\"çš„æ•°æ®äºšé›†ã€‚ä¹‹åé€‰æ‹©relative, B_year_Relatives, BRCA1_truncatingå’ŒBRCA2_truncatingå››åˆ—\n\n-   å°†äºšé›†æ ¹æ®B_year_Relativesåˆ—é™åºé‡æ’ã€‚\n\n-   åˆ›å»ºæ–°åˆ—cancerï¼šå½“First_Invasive_ICD7_1_Relativesåˆ—ä¸ºâ€œ170â€æ—¶ï¼Œå€¼ä¸ºâ€œBreast cancerâ€ï¼Œå…¶ä»–å€¼ä¸ºâ€œOther cancerâ€ï¼ŒNAæ—¶ä¸ºâ€œNo cancerâ€.\n\n-   æŒ‰äº²å±ç±»å‹relativeåˆ—åˆ†ç»„ï¼Œè®¡ç®—æ¯ç»„çš„å¹³å‡PRS_Cambridgeåˆ†æ•°å’Œæœ‰ä¹³è…ºç™Œè¯Šæ–­çš„æ•°é‡ã€‚\n\n### æ•°æ®å¤„ç†\n\n```r\n# åŠ è½½å¿…è¦åŒ…\nlibrary(readr)\nlibrary(dplyr)\nlibrary(stringr)\n\n# 1) è¯»å–æ•°æ®\npath <- \"E:/acode/homwwork/data3/è¡¨1.txt\"\n\n# å¦‚æœæ˜¯åˆ¶è¡¨ç¬¦åˆ†éš”ï¼šdelim=\"\\t\"; å¦‚æœæ˜¯é€—å·åˆ†éš”ï¼Œå¯æ”¹ä¸º read_csv(path)\ndf <- read_delim(path, delim = \"\\t\", locale = locale(encoding = \"UTF-8\"))\n\n# é€Ÿè§ˆï¼šè¡Œæ•°ã€åˆ—æ•°ã€åˆ—åã€ç±»å‹\ndim(df)         # è¡Œæ•°ã€åˆ—æ•°\nnames(df)       # åˆ—å\nstr(df)         # æ•°æ®ç±»å‹\nglimpse(df)     # æ›´ç´§å‡‘çš„ç±»å‹ä¸å‰å‡ è¡Œ\n```\n\nå¾—åˆ°\n\n``` r\n1] 1000   44\n [1] \"LopNr_relative\"                 \n [2] \"studieid_woman\"                 \n [3] \"Sex_Relatives\"                  \n [4] \"Birthdate_Relatives\"            \n [5] \"Birthcountry_Relatives\"         \n [6] \"last_migration_date_Relatives\"  \n [7] \"last_migrationstatus_Relatives\" \n [8] \"relative\"                       \n [9] \"B_year_Relatives\"               \n[10] \"x_agebase_woman\"                \n[11] \"x_BC\"                           \n[12] \"ATM_truncating\"                 \n[13] \"BARD1_truncating\"               \n[14] \"BRCA1_truncating\"               \n[15] \"BRCA2_truncating\"               \n[16] \"CHEK2_truncating\"               \n[17] \"PALB2_truncating\"               \n[18] \"RAD51C_truncating\"              \n[19] \"RAD51D_truncating\"              \n[20] \"TP53_truncating\"                \n[21] \"RareVariants_31genes\"           \n[22] \"RareVariants_pinkgenes\"         \n[23] \"RareVariants_BRCA\"              \n[24] \"RareVariants_nonBRCA\"           \n[25] \"RareVariants_nonBRCA_pinkgenes\" \n[26] \"RareVariants_5genes\"            \n[27] \"RareVariants_nonpink_genes\"     \n[28] \"age_case_control_women\"         \n[29] \"age_entry_Relatives\"            \n[30] \"DODSDAT_Relatives\"              \n[31] \"ICD_Death_Relatives\"            \n[32] \"ULORSAK_Death_Relatives\"        \n[33] \"DIADAT_Relatives\"               \n[34] \"First_Invasive_ICD7_1_Relatives\"\n[35] \"First_Invasive_ICD7_2_Relatives\"\n[36] \"First_Invasive_ICD7_3_Relatives\"\n[37] \"dataset\"                        \n[38] \"PRS_Cambridge\"                  \n[39] \"last_Cancerregister\"            \n[40] \"last_FU\"                        \n[41] \"age_exit_Relatives\"             \n[42] \"Population\"                     \n[43] \"Birthyear_cat_Relative\"         \n[44] \"PRS_batch\"                      \nspc_tbl_ [1,000 Ã— 44] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ LopNr_relative                 : num [1:1000] 208702 150158 350011 263109 144609 ...\n $ studieid_woman                 : num [1:1000] 1429737 1177898 1242478 1656370 2533917 ...\n $ Sex_Relatives                  : num [1:1000] 2 2 1 1 2 2 2 1 1 1 ...\n $ Birthdate_Relatives            : Date[1:1000], format: \"1954-07-15\" ...\n $ Birthcountry_Relatives         : chr [1:1000] \"Sverige\" \"Sverige\" \"Sverige\" \"Sverige\" ...\n $ last_migration_date_Relatives  : Date[1:1000], format: NA ...\n $ last_migrationstatus_Relatives : chr [1:1000] NA NA \"Inv\" NA ...\n $ relative                       : chr [1:1000] \"Full Sibling\" \"Child\" \"Child\" \"Full Sibling\" ...\n $ B_year_Relatives               : num [1:1000] 1954 1980 1990 1950 1958 ...\n $ x_agebase_woman                : num [1:1000] 54 59 45 54 50 65 53 52 45 46 ...\n $ x_BC                           : num [1:1000] 0 0 0 0 0 0 0 1 0 0 ...\n $ ATM_truncating                 : chr [1:1000] NA NA NA NA ...\n $ BARD1_truncating               : chr [1:1000] NA NA NA NA ...\n $ BRCA1_truncating               : chr [1:1000] NA NA NA NA ...\n $ BRCA2_truncating               : chr [1:1000] NA NA NA NA ...\n $ CHEK2_truncating               : chr [1:1000] NA NA NA NA ...\n $ PALB2_truncating               : chr [1:1000] NA NA NA NA ...\n $ RAD51C_truncating              : chr [1:1000] NA NA NA NA ...\n $ RAD51D_truncating              : chr [1:1000] NA NA NA NA ...\n $ TP53_truncating                : chr [1:1000] NA NA NA NA ...\n $ RareVariants_31genes           : chr [1:1000] NA NA NA NA ...\n $ RareVariants_pinkgenes         : chr [1:1000] NA NA NA NA ...\n $ RareVariants_BRCA              : chr [1:1000] NA NA NA NA ...\n $ RareVariants_nonBRCA           : chr [1:1000] NA NA NA NA ...\n $ RareVariants_nonBRCA_pinkgenes : chr [1:1000] NA NA NA NA ...\n $ RareVariants_5genes            : chr [1:1000] NA NA NA NA ...\n $ RareVariants_nonpink_genes     : chr [1:1000] NA NA NA NA ...\n $ age_case_control_women         : num [1:1000] 61 66 51 61 57 ...\n $ age_entry_Relatives            : num [1:1000] 3.5 0 0 7.5 0 ...\n $ DODSDAT_Relatives              : Date[1:1000], format: \"2015-01-21\" ...\n $ ICD_Death_Relatives            : num [1:1000] 10 NA NA NA NA NA NA NA NA NA ...\n $ ULORSAK_Death_Relatives        : chr [1:1000] \"C509\" NA NA NA ...\n $ DIADAT_Relatives               : Date[1:1000], format: \"2001-12-05\" ...\n $ First_Invasive_ICD7_1_Relatives: num [1:1000] 170 NA NA NA NA NA NA NA NA NA ...\n $ First_Invasive_ICD7_2_Relatives: num [1:1000] NA NA NA NA NA NA NA NA NA NA ...\n $ First_Invasive_ICD7_3_Relatives: logi [1:1000] NA NA NA NA NA NA ...\n $ dataset                        : chr [1:1000] \"KARMA\" \"KARMA\" \"KARMA\" \"KARMA\" ...\n $ PRS_Cambridge                  : num [1:1000] 1.041 NA -0.751 NA NA ...\n $ last_Cancerregister            : Date[1:1000], format: \"2017-12-29\" ...\n $ last_FU                        : Date[1:1000], format: \"2001-12-05\" ...\n $ age_exit_Relatives             : num [1:1000] 47.4 37.8 27.6 67.5 59.5 ...\n $ Population                     : chr [1:1000] \"Yes\" \"Yes\" \"Yes\" \"Yes\" ...\n $ Birthyear_cat_Relative         : num [1:1000] 9 12 13 9 9 11 9 9 7 10 ...\n $ PRS_batch                      : chr [1:1000] \"Oncoarray_new\" NA \"Oncoarray_new\" NA ...\n```\n\n### ç¬¬äºŒæ­¥\n\n```r\n# 2) ç­›é€‰ BRCA1_truncating == \"Yes\" ä¸” BRCA2_truncating == \"Yes\"\n#    åŒæ—¶ relative åœ¨ Full Sibling æˆ– Childï¼Œç„¶åé€‰æ‹©å››åˆ—\nsub_df <- df %>%\n  filter(\n    BRCA1_truncating == \"Yes\",\n    BRCA2_truncating == \"Yes\",\n    relative %in% c(\"Full Sibling\", \"Child\")\n  ) %>%\n  select(relative, B_year_Relatives, BRCA1_truncating, BRCA2_truncating)\n```\n\n### ç¬¬ä¸‰æ­¥\n\n```r\n\n# 3) æ ¹æ® B_year_Relatives é™åºé‡æ’\nsub_df <- sub_df %>%\n  arrange(desc(B_year_Relatives))\n```\n\n### ç¬¬å››æ­¥\n\n```r\n# 4) åˆ›å»ºæ–°åˆ— cancerï¼š\n# First_Invasive_ICD7_1_Relatives == \"170\" â†’ \"Breast cancer\"\n# å…¶å®ƒå€¼ â†’ \"Other cancer\"\n# NA â†’ \"No cancer\"\ndf <- df %>%\n  mutate(\n    cancer = case_when(\n      is.na(First_Invasive_ICD7_1_Relatives) ~ \"No cancer\",\n      First_Invasive_ICD7_1_Relatives == \"170\" ~ \"Breast cancer\",\n      TRUE ~ \"Other cancer\"\n    )\n  )\n\n```\n\næœ€å\n\n```r\n# 5) æŒ‰äº²å±ç±»å‹åˆ†ç»„ï¼Œè®¡ç®—å¹³å‡ PRS_Cambridge å’Œä¹³è…ºç™Œè¯Šæ–­æ•°é‡\n# ä¹³è…ºç™Œè¯Šæ–­æ•°é‡ï¼šcancer == \"Breast cancer\" çš„ä¸ªæ•°\nsummary_by_relative <- df %>%\n  group_by(relative) %>%\n  summarise(\n    mean_PRS_Cambridge = mean(PRS_Cambridge, na.rm = TRUE),\n    n_breast_cancer = sum(cancer == \"Breast cancer\", na.rm = TRUE),\n    n = n()\n  ) %>%\n  ungroup()\n\n# æŸ¥çœ‹ç»“æœ\nprint(sub_df)\nprint(summary_by_relative)\n```\n\nå¾—åˆ°Â·\n\n``` r\n+ # æŸ¥çœ‹ç»“æœ\n+ print(sub_df)\n+ print(summary_by_relative)\n# A tibble: 0 Ã— 4\n# â„¹ 4 variables: relative <chr>, B_year_Relatives <dbl>,\n#   BRCA1_truncating <chr>, BRCA2_truncating <chr>\n# A tibble: 4 Ã— 4\n  relative     mean_PRS_Cambridge n_breast_cancer     n\n  <chr>                     <dbl>           <int> <int>\n1 Child                    -0.296               3   317\n2 Father                   -0.414               0   202\n3 Full Sibling             -0.211               8   293\n4 Mother                   -0.277              24   188\n```\n\n## ğŸ” æ•°æ®å¤„ç†éƒ¨åˆ†ç»“æœè§£è¯»\n\n### `sub_df` ä¸ºç©º\n\n```         \n# A tibble: 0 Ã— 4 \n```\n\n-   è¯´æ˜ï¼šåœ¨åŸå§‹æ•°æ®ä¸­ï¼Œæ²¡æœ‰ä»»ä½•è¡ŒåŒæ—¶æ»¡è¶³ï¼š\n\n    -   `BRCA1_truncating == \"Yes\"`\n\n    -   `BRCA2_truncating == \"Yes\"`\n\n    -   `relative %in% c(\"Full Sibling\", \"Child\")`\n\n-   æ‰€ä»¥ç­›é€‰ç»“æœä¸ºç©ºè¡¨ã€‚è¿™å¹¶ä¸æ˜¯é”™è¯¯ï¼Œè€Œæ˜¯æ¡ä»¶è¿‡äºä¸¥æ ¼å¯¼è‡´æ²¡æœ‰åŒ¹é…ã€‚\n\n### `summary_by_relative`\n\n```         \n# A tibble: 4 Ã— 4\n  relative     mean_PRS_Cambridge n_breast_cancer     n\n1 Child                    -0.296               3   317\n2 Father                   -0.414               0   202\n3 Full Sibling             -0.211               8   293\n4 Mother                   -0.277              24   188\n```\n\n-   **å¹³å‡ PRS_Cambridge åˆ†æ•°**ï¼šä¸åŒäº²å±ç±»å‹çš„å¹³å‡å€¼éƒ½ä¸ºè´Ÿï¼Œè¯´æ˜æ•´ä½“é£é™©è¯„åˆ†åä½ã€‚\n\n-   **ä¹³è…ºç™Œè¯Šæ–­æ•°é‡**ï¼š\n\n    -   æ¯äº²ï¼ˆMotherï¼‰æœ‰ 24 ä¾‹ï¼Œæ˜¯æœ€å¤šçš„ã€‚\n\n    -   å­å¥³ï¼ˆChildï¼‰æœ‰ 3 ä¾‹ã€‚\n\n    -   å…¨åŒèƒï¼ˆFull Siblingï¼‰æœ‰ 8 ä¾‹ã€‚\n\n    -   çˆ¶äº²ï¼ˆFatherï¼‰ä¸º 0ã€‚\n\n-   **æ ·æœ¬é‡ n**ï¼šæ¯äº²å’Œçˆ¶äº²æ ·æœ¬é‡è¾ƒå°‘ï¼ˆ188ã€202ï¼‰ï¼Œå­å¥³å’ŒåŒèƒè¾ƒå¤šï¼ˆ317ã€293ï¼‰ã€‚\n\nğŸ‘‰ è§£è¯»ï¼šæ¯äº²ç¾¤ä½“åœ¨æ ·æœ¬ä¸­ä¹³è…ºç™Œè¯Šæ–­æ•°æœ€å¤šï¼Œå¹³å‡ PRS åˆ†æ•°ä¹Ÿç•¥ä½äºåŒèƒå’Œå­å¥³ã€‚çˆ¶äº²ç»„æ²¡æœ‰ä¹³è…ºç™Œç—…ä¾‹ã€‚\n\n------------------------------------------------------------------------\n\n## ç”Ÿå­˜åˆ†æï¼ˆbiostat3::melanomaï¼Œ10å¹´éšè®¿ä¸ Cox å›å½’ï¼‰\n\n#### æ•°æ®ä¸æˆªæ­¢æ—¶é—´è®¾å®šï¼ˆ10 å¹´ = 120 ä¸ªæœˆï¼‰\n\nçœ‹çœ‹æ•°æ®å•¥æ ·\n\n```r\n> head(melanoma)\n     sex age     stage mmdx yydx surv_mm surv_yy       status          subsite\n1 Female  81 Localised    2 1981    26.5     2.5  Dead: other    Head and Neck\n2 Female  75 Localised    9 1975    55.5     4.5  Dead: other    Head and Neck\n3 Female  78 Localised    2 1978   177.5    14.5  Dead: other            Limbs\n4 Female  75   Unknown    8 1975    29.5     2.5 Dead: cancer Multiple and NOS\n5 Female  81   Unknown    7 1981    57.5     4.5  Dead: other    Head and Neck\n6 Female  75 Localised    9 1975    19.5     1.5 Dead: cancer            Trunk\n         year8594         dx       exit agegrp id      ydx    yexit\n1 Diagnosed 75-84 1981-02-02 1983-04-20    75+  1 1981.088 1983.298\n2 Diagnosed 75-84 1975-09-21 1980-05-07    75+  2 1975.720 1980.348\n3 Diagnosed 75-84 1978-02-21 1992-12-07    75+  3 1978.140 1992.934\n4 Diagnosed 75-84 1975-08-25 1978-02-08    75+  4 1975.646 1978.104\n5 Diagnosed 75-84 1981-07-09 1986-04-25    75+  5 1981.517 1986.312\n6 Diagnosed 75-84 1975-09-03 1977-04-19    75+  6 1975.671 1977.296\n```\n\n```r\nlibrary(biostat3)\nlibrary(survival)\nlibrary(dplyr)\n\ndata(\"melanoma\")\n\nmelanoma10 <- melanoma %>%\n  mutate(\n    surv_mm_10y = pmin(surv_mm, 120),\n    status_10y = case_when(\n      surv_mm <= 120 & status %in% c(\"Dead: cancer\", \"Dead: other\",\"Lost to follow-up\") ~ 1,\n      TRUE ~ 0\n    )\n  )\n\n```\n\n#### ç ”ç©¶äººç¾¤ä¸è‡ªå˜é‡æ„é€ \n\n-   ç ”ç©¶äººç¾¤ï¼šå±€éƒ¨æœŸé»‘è‰²ç´ ç˜¤ï¼ˆstage = \"Localised\"ï¼‰ã€‚\n\n-   è‡ªå˜é‡ï¼š\n\n    -   æ€§åˆ«ï¼šsexï¼ˆå»ºè®®è½¬ä¸ºå› å­ï¼‰\n\n    -   è¯Šæ–­å¹´ä»½ï¼š1985â€“1994 vs å…¶ä»–ï¼ˆåŸºäº yearï¼‰\n\n    -   å¹´é¾„ç»„ï¼š\\<45ã€45â€“59ã€60â€“74ã€75+\n\n```r\nmel_local <- melanoma10 %>%\n  filter(stage == \"Localised\") %>%\n  mutate(\n    sex = factor(sex),\n    year_grp = factor(year8594),   # ç›´æ¥ç”¨å·²æœ‰åˆ†ç»„\n    age_grp = cut(\n      age,\n      breaks = c(-Inf, 45, 60, 75, Inf),\n      labels = c(\"<45\", \"45-59\", \"60-74\", \"75+\"),\n      right = FALSE\n    )\n  )\n\n\n```\n\n#### æ„å»º Cox æ¨¡å‹å¹¶è¾“å‡ºç»“æœ\n\n```r\n# æ„å»º 10 å¹´ä»»ä½•åŸå› æ­»äº¡çš„ Cox æ¨¡å‹\ncox_fit <- coxph(Surv(surv_mm_10y, status_10y) ~ sex + year_grp + age_grp, data = mel_local)\n\nsummary(cox_fit)\n```\n\n-   å…³æ³¨æ¯ä¸ªå˜é‡çš„é£é™©æ¯”ï¼ˆexp(coef)ï¼‰ã€95% CIã€p å€¼ã€‚é£é™©æ¯” \\> 1 è¡¨ç¤ºç›¸å¯¹è¾ƒé«˜çš„æ­»äº¡é£é™©ï¼Œ\\< 1 è¡¨ç¤ºè¾ƒä½é£é™©ã€‚è¯Šæ–­å¹´ä»½çš„â€œ1985â€“1994â€å¦‚æœ HR \\< 1ï¼Œå¯èƒ½æš—ç¤ºè¯¥æ—¶æœŸçš„æ‚£è€…åœ¨10å¹´éšè®¿å†…æ€»ä½“æ­»äº¡é£é™©æ›´ä½ï¼Œéœ€ç»“åˆCIä¸på€¼åˆ¤æ–­ç»Ÿè®¡æ˜¾è‘—æ€§ã€‚å¹´é¾„ç»„é€šå¸¸éšå¹´é¾„å‡é«˜é£é™©ä¸Šå‡ï¼Œæ€§åˆ«æ•ˆåº”åˆ™éœ€çœ‹å…·ä½“ä¼°è®¡ä¸æ˜¾è‘—æ€§ã€‚\n\n``` r\nsummary(cox_fit)\nCall:\ncoxph(formula = Surv(surv_mm_10y, status_10y) ~ sex + year_grp + \n    age_grp, data = mel_local)\n\n  n= 5318, number of events= 1586 \n\n                            coef exp(coef) se(coef)      z Pr(>|z|)    \nsexFemale               -0.49023   0.61248  0.05088 -9.635  < 2e-16 ***\nyear_grpDiagnosed 85-94 -0.29010   0.74819  0.05181 -5.599 2.15e-08 ***\nage_grp45-59             0.38610   1.47122  0.08641  4.468 7.89e-06 ***\nage_grp60-74             1.05923   2.88414  0.07925 13.365  < 2e-16 ***\nage_grp75+               2.11580   8.29624  0.08205 25.788  < 2e-16 ***\n---\nSignif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1\n\n                        exp(coef) exp(-coef) lower .95 upper .95\nsexFemale                  0.6125     1.6327    0.5543    0.6767\nyear_grpDiagnosed 85-94    0.7482     1.3366    0.6759    0.8282\nage_grp45-59               1.4712     0.6797    1.2420    1.7427\nage_grp60-74               2.8841     0.3467    2.4692    3.3688\nage_grp75+                 8.2962     0.1205    7.0639    9.7436\n\nConcordance= 0.707  (se = 0.006 )\nLikelihood ratio test= 887.4  on 5 df,   p=<2e-16\nWald test            = 937.8  on 5 df,   p=<2e-16\nScore (logrank) test = 1121  on 5 df,   p=<2e-16\n```\n\n### ğŸ“Š Cox å›å½’ç»“æœè§£è¯»\n\nå¾—åˆ°çš„ Cox æ¨¡å‹ç»“æœéå¸¸æ¸…æ™°ï¼š\n\n-   **æ ·æœ¬é‡**ï¼š5318ï¼Œäº‹ä»¶æ•°ï¼ˆ10å¹´å†…æ­»äº¡ï¼‰= 1586\n\n-   **æ€§åˆ«**ï¼šå¥³æ€§ HR = 0.61ï¼ˆ95% CI: 0.55â€“0.68ï¼‰ï¼Œæ˜¾è‘—ä½äºç”·æ€§ â†’ å¥³æ€§åœ¨å±€éƒ¨æœŸé»‘è‰²ç´ ç˜¤ä¸­ 10 å¹´æ­»äº¡é£é™©æ›´ä½ã€‚\n\n-   **è¯Šæ–­å¹´ä»½**ï¼š1985â€“1994 HR = 0.75ï¼ˆ95% CI: 0.68â€“0.83ï¼‰ï¼Œæ˜¾è‘—ä½äºå…¶ä»–å¹´ä»½ â†’ è¯´æ˜è¯¥æ—¶æœŸæ‚£è€…çš„æ­»äº¡é£é™©è¾ƒä½ï¼Œå¯èƒ½åæ˜ è¯Šæ–­æˆ–æ²»ç–—æ”¹å–„ã€‚\n\n-   **å¹´é¾„ç»„**ï¼š\n\n    -   45â€“59 å² HR = 1.47\n\n    -   60â€“74 å² HR = 2.88\n\n    -   75+ å² HR = 8.30 â†’ é£é™©éšå¹´é¾„æ˜¾è‘—é€’å¢ï¼Œè¶‹åŠ¿éå¸¸æ˜æ˜¾ã€‚\n\n**æ¨¡å‹æ•´ä½“æ‹Ÿåˆ**ï¼šConcordance = 0.707ï¼Œè¯´æ˜æ¨¡å‹åŒºåˆ†åº¦è‰¯å¥½ã€‚æ‰€æœ‰æ•´ä½“æ£€éªŒï¼ˆLRã€Waldã€Scoreï¼‰å‡é«˜åº¦æ˜¾è‘—ã€‚\n\nåŸºäºå·²ç»æ„é€ å¥½çš„ `mel_local` æ•°æ®ï¼ˆåŒ…å« `surv_mm_10y` å’Œ `status_10y`ï¼‰ï¼š\n\n```r\nlibrary(survival)\nlibrary(survminer)\n\n# Kaplan-Meier ç”Ÿå­˜å¯¹è±¡\nkm_fit <- survfit(Surv(surv_mm_10y, status_10y) ~ age_grp, data = mel_local)\n\n# ç»˜åˆ¶ç”Ÿå­˜æ›²çº¿\nggsurvplot(\n  km_fit,\n  data = mel_local,\n  risk.table = TRUE,        # åœ¨å›¾ä¸‹æ–¹æ˜¾ç¤ºé£é™©è¡¨\n  pval = TRUE,              # æ˜¾ç¤º log-rank æ£€éªŒ p å€¼\n  conf.int = TRUE,          # æ˜¾ç¤ºç½®ä¿¡åŒºé—´\n  legend.title = \"å¹´é¾„ç»„\",\n  legend.labs = c(\"<45\", \"45-59\", \"60-74\", \"75+\"),\n  xlab = \"éšè®¿æ—¶é—´ï¼ˆæœˆï¼‰\",\n  ylab = \"ç”Ÿå­˜æ¦‚ç‡\",\n  title = \"ä¸åŒå¹´é¾„ç»„çš„10å¹´ç”Ÿå­˜æ›²çº¿\",\n  palette = c(\"#1b9e77\", \"#d95f02\", \"#7570b3\", \"#e7298a\") # è‡ªå®šä¹‰é…è‰²\n)\n \n```\n\n### ğŸ“Œ è¯´æ˜\n\n-   `Surv(surv_mm_10y, status_10y)`ï¼šä½¿ç”¨æˆ‘ä»¬å®šä¹‰çš„ 10 å¹´éšè®¿æ—¶é—´å’Œäº‹ä»¶æŒ‡æ ‡ã€‚\n\n-   `~ age_grp`ï¼šè¿™é‡ŒæŒ‰å¹´é¾„ç»„åˆ†å±‚ç»˜åˆ¶æ›²çº¿ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ”¹æˆ `~ sex` æˆ– `~ year_grp`ã€‚\n\n-   `risk.table = TRUE`ï¼šåœ¨å›¾ä¸‹æ–¹æ˜¾ç¤ºæ¯ä¸ªæ—¶é—´ç‚¹çš„é£é™©äººæ•°ã€‚\n\n-   `pval = TRUE`ï¼šæ˜¾ç¤º log-rank æ£€éªŒçš„æ˜¾è‘—æ€§ã€‚\n\n-   `conf.int = TRUE`ï¼šæ˜¾ç¤ºç½®ä¿¡åŒºé—´é˜´å½±ã€‚\n\n![](plot-120.png)\n\n#### ç­‰æ¯”ä¾‹é£é™©å‡è®¾æ£€éªŒï¼ˆPH å‡è®¾ï¼‰\n\n```r\n# Schoenfeld æ®‹å·®æ£€éªŒ\nph_test <- cox.zph(cox_fit)\nprint(ph_test)\n\n# å¯è§†åŒ–ï¼ˆæŸ¥çœ‹æ¯ä¸ªåå˜é‡éšæ—¶é—´çš„æ®‹å·®è¶‹åŠ¿ï¼‰\npar(mfrow = c(2, 2))\nplot(ph_test)\npar(mfrow = c(1, 1))\n```\n\n``` r\n         chisq df    p\nsex      1.595  1 0.21\nyear_grp 0.756  1 0.38\nage_grp  0.856  3 0.84\nGLOBAL   3.140  5 0.68\n```\n\n-   å¦‚æœæ•´ä½“æ£€éªŒæˆ–æŸä¸ªåå˜é‡çš„ p å€¼å°äº 0.05ï¼Œæç¤ºæ¯”ä¾‹é£é™©å‡è®¾å¯èƒ½ä¸æˆç«‹ã€‚\n\n-   å›¾å½¢ä¸Šå¦‚æœæ®‹å·®æ‹Ÿåˆçº¿éšæ—¶é—´æ˜æ˜¾åç¦»æ°´å¹³çº¿ï¼ˆéé›¶æ–œç‡ï¼‰ï¼Œä¹Ÿæç¤º PH å‡è®¾è¿èƒŒã€‚\n\n![](plot-119.png)\n\n### âš–ï¸ ç­‰æ¯”ä¾‹é£é™©å‡è®¾æ£€éªŒ\n\nSchoenfeld æ®‹å·®æ£€éªŒç»“æœï¼š\n\n| å˜é‡       | Ï‡Â²    | df  | på€¼  |\n|------------|-------|-----|------|\n| sex        | 1.595 | 1   | 0.21 |\n| year_grp   | 0.756 | 1   | 0.38 |\n| age_grp    | 0.856 | 3   | 0.84 |\n| **GLOBAL** | 3.140 | 5   | 0.68 |\n\n-   æ‰€æœ‰ p å€¼ \\> 0.05ï¼Œ**æ²¡æœ‰è¯æ®è¡¨æ˜æ¯”ä¾‹é£é™©å‡è®¾è¢«è¿å**ã€‚\n\n-   è¯´æ˜ Cox æ¨¡å‹çš„å‡è®¾æˆç«‹ï¼Œå¯ä»¥ç›´æ¥è§£é‡Š HR ä¸ºæ’å®šçš„ç›¸å¯¹é£é™©ã€‚\n\n------------------------------------------------------------------------\n\n## åŸºå› å˜å¼‚çš„åŠŸèƒ½æ€§é¢„æµ‹\n\nåœ¨[[https://www.kdocs.cn/l/caALpwLoJmmi]{.underline}](https://www.kdocs.cn/l/caALpwLoJmmi)è®¤é¢†åŸºå› ï¼Œå¹¶åœ¨gnomADä¸Šä¸‹è½½è¯¥åŸºå› æ•°æ®ï¼Œå®šä¹‰è¯¥åŸºå› çš„è‡´ç—…æ€§å˜å¼‚ï¼ˆå¤±èƒ½å˜å¼‚+åŠŸèƒ½æ€§é”™ä¹‰å˜å¼‚+ClinVarè‡´ç—…æ€§å˜å¼‚ï¼‰ã€‚é”™ä¹‰å˜å¼‚åŠŸèƒ½æ€§é¢„æµ‹ä½¿ç”¨SIFTï¼ŒPolyPhen 2 HVarï¼ŒMutationAssessorï¼ŒMetaSVM 100%é¢„æµ‹ç›¸åŒç»“æœã€‚\n\n## CPN1 åŸºæœ¬æƒ…å†µ\n\n-   CPN1 ç¼–ç çš„æ˜¯ â€œcarboxypeptidase N catalytic chainâ€ï¼ˆè¡€æµ†ç¾§è‚½é…¶ N çš„å‚¬åŒ–äºšåŸºï¼‰â€”â€”ä¸€ä¸ªé‡‘å±ä¾èµ–çš„ carboxypeptidaseã€‚\n\n    åŠŸèƒ½ä¸Šï¼Œå®ƒè´Ÿè´£ä»è‚½ï¼è›‹ç™½è´¨çš„ C ç«¯åˆ‡é™¤ç¢±æ€§æ°¨åŸºé…¸ï¼ˆå¦‚ Lysï¼Argï¼‰ï¼Œå› æ­¤å¯¹è®¸å¤šè°ƒèŠ‚è‚½ï¼ˆæ¯”å¦‚æ¿€è‚½ã€anaphylatoxin ç­‰ï¼‰åœ¨è¡€æµ†ä¸­çš„ä»£è°¢ï¼å¤±æ´»å¾ˆé‡è¦ã€‚\n\n    åœ¨ç”Ÿç‰©ä½“é‡Œï¼Œè¿™ä¸ªé…¶æ˜¯ä¸€ä¸ªå››èšä½“ï¼šä¸¤ä¸ªè°ƒèŠ‚ï¼ˆregulatoryï¼‰äºšåŸº + ä¸¤ä¸ªå‚¬åŒ–ï¼ˆcatalyticï¼Œä¹Ÿå°±æ˜¯ CPN1 ç¼–ç çš„ï¼‰äºšåŸºã€‚\n\n    è¯¥åŸºå› åœ¨äººä½“åŸºå› ç»„ä¸­çš„ä½ç½®æ˜¯ **chr10q24.2**ï¼ˆGRCh38ï¼‰ ï¼Œå…±æœ‰ 9 ä¸ªå¤–æ˜¾å­ã€‚ [[å›½å®¶ç”Ÿç‰©æŠ€æœ¯ä¿¡æ¯ä¸­å¿ƒ]{.underline}](https://www.ncbi.nlm.nih.gov/gene?Cmd=DetailsSearch&Db=gene&Term=1369&utm_source=chatgpt.com){alt=\"https://www.ncbi.nlm.nih.gov/gene?Cmd=DetailsSearch&Db=gene&Term=1369&utm_source=chatgpt.com\"}\n\n    ä¸ä¹‹ç›¸å…³çš„ç–¾ç—…åŒ…æ‹¬ Carboxypeptidase N deficiencyï¼Œä¸€ç§å¸¸è§ä¸ºå¸¸æŸ“è‰²ä½“éšæ€§ (AR) çš„ç–¾ç—…ï¼›è¡¨ç°å¯èƒ½ä¸ºè¡€æµ† CPN æ°´å¹³ä½ã€ä»¥åŠä¸è¡€æµ†æ´»æ€§è‚½ä»£è°¢å¼‚å¸¸ç›¸å…³çš„ä¸´åºŠç—‡çŠ¶ï¼ˆå¦‚åå¤å‘ä½œçš„è¡€ç®¡æ€§æ°´è‚¿æˆ–æ…¢æ€§è¨éº»ç–¹ï¼è¿‡æ•æ€§ååº”ï¼‰ç­‰ã€‚\n\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\n\n# è¯»å– gnomAD CSV\ndf = pd.read_csv(r\"E:\\acode\\homwwork\\data\\gnomAD_v4.1.0_ENSG00000120054_2025_12_03_15_08_57.csv\")\n```\n:::\n\n\næŸ¥çœ‹æ•°æ®å¹¶ä¸”è½¬æ¢æˆ‘ä»¬éœ€è¦çš„æ ¼å¼\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nprint(df.head())\nprint(df.columns)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           gnomAD ID  Chromosome   Position         rsIDs Reference Alternate  \\\n0   10-100042357-G-C          10  100042357   rs533504673         G         C   \n1   10-100042358-A-G          10  100042358           NaN         A         G   \n2   10-100042360-A-C          10  100042360   rs937047849         A         C   \n3  10-100042361-GA-G          10  100042361  rs1362672166        GA         G   \n4   10-100042363-A-T          10  100042363   rs970328627         A         T   \n\n                         Source Filters - exomes Filters - genomes  \\\n0  gnomAD Exomes,gnomAD Genomes             PASS              PASS   \n1                 gnomAD Exomes             PASS               NaN   \n2                gnomAD Genomes              NaN              PASS   \n3                 gnomAD Exomes             PASS               NaN   \n4  gnomAD Exomes,gnomAD Genomes             PASS              PASS   \n\n          Transcript  ... Homozygote Count Amish Hemizygote Count Amish  \\\n0  ENST00000370418.8  ...                      0                      0   \n1  ENST00000370418.8  ...                      0                      0   \n2  ENST00000370418.8  ...                      0                      0   \n3  ENST00000370418.8  ...                      0                      0   \n4  ENST00000370418.8  ...                      0                      0   \n\n  Allele Count South Asian Allele Number South Asian  \\\n0                        0                     90246   \n1                        0                     90346   \n2                        0                     90442   \n3                        0                     90398   \n4                        0                     90586   \n\n  Homozygote Count South Asian  Hemizygote Count South Asian  \\\n0                            0                             0   \n1                            0                             0   \n2                            0                             0   \n3                            0                             0   \n4                            0                             0   \n\n  Allele Count Remaining  Allele Number Remaining  Homozygote Count Remaining  \\\n0                      0                    61304                           0   \n1                      0                    61468                           0   \n2                      0                    61560                           0   \n3                      0                    61590                           0   \n4                      7                    61722                           0   \n\n   Hemizygote Count Remaining  \n0                           0  \n1                           0  \n2                           0  \n3                           0  \n4                           0  \n\n[5 rows x 72 columns]\nIndex(['gnomAD ID', 'Chromosome', 'Position', 'rsIDs', 'Reference',\n       'Alternate', 'Source', 'Filters - exomes', 'Filters - genomes',\n       'Transcript', 'HGVS Consequence', 'Protein Consequence',\n       'Transcript Consequence', 'VEP Annotation',\n       'ClinVar Germline Classification', 'ClinVar Variation ID', 'Flags',\n       'Allele Count', 'Allele Number', 'Allele Frequency', 'Homozygote Count',\n       'Hemizygote Count', 'Filters - joint', 'GroupMax FAF group',\n       'GroupMax FAF frequency', 'cadd', 'revel_max', 'spliceai_ds_max',\n       'pangolin_largest_ds', 'phylop', 'sift_max', 'polyphen_max',\n       'Allele Count African/African American',\n       'Allele Number African/African American',\n       'Homozygote Count African/African American',\n       'Hemizygote Count African/African American',\n       'Allele Count Admixed American', 'Allele Number Admixed American',\n       'Homozygote Count Admixed American',\n       'Hemizygote Count Admixed American', 'Allele Count Ashkenazi Jewish',\n       'Allele Number Ashkenazi Jewish', 'Homozygote Count Ashkenazi Jewish',\n       'Hemizygote Count Ashkenazi Jewish', 'Allele Count East Asian',\n       'Allele Number East Asian', 'Homozygote Count East Asian',\n       'Hemizygote Count East Asian', 'Allele Count European (Finnish)',\n       'Allele Number European (Finnish)',\n       'Homozygote Count European (Finnish)',\n       'Hemizygote Count European (Finnish)', 'Allele Count Middle Eastern',\n       'Allele Number Middle Eastern', 'Homozygote Count Middle Eastern',\n       'Hemizygote Count Middle Eastern',\n       'Allele Count European (non-Finnish)',\n       'Allele Number European (non-Finnish)',\n       'Homozygote Count European (non-Finnish)',\n       'Hemizygote Count European (non-Finnish)', 'Allele Count Amish',\n       'Allele Number Amish', 'Homozygote Count Amish',\n       'Hemizygote Count Amish', 'Allele Count South Asian',\n       'Allele Number South Asian', 'Homozygote Count South Asian',\n       'Hemizygote Count South Asian', 'Allele Count Remaining',\n       'Allele Number Remaining', 'Homozygote Count Remaining',\n       'Hemizygote Count Remaining'],\n      dtype='object')\n```\n:::\n:::\n\n\n``` python\ndf = pd.read_csv(r\"E:\\acode\\homwwork\\data\\gnomAD_v4.1.0_ENSG00000120054_2025_12_03_15_08_57.csv\")\n>>> print(df.head())\n... print(df.columns)\n           gnomAD ID  ...  Hemizygote Count Remaining\n0   10-100042357-G-C  ...                           0\n1   10-100042358-A-G  ...                           0\n2   10-100042360-A-C  ...                           0\n3  10-100042361-GA-G  ...                           0\n4   10-100042363-A-T  ...                           0\n\n[5 rows x 72 columns]\nIndex(['gnomAD ID', 'Chromosome', 'Position', 'rsIDs', 'Reference', 'Alternate',\n       'Source', 'Filters - exomes', 'Filters - genomes', 'Transcript',\n       'HGVS Consequence', 'Protein Consequence', 'Transcript Consequence',\n       'VEP Annotation', 'ClinVar Germline Classification',\n       'ClinVar Variation ID', 'Flags', 'Allele Count', 'Allele Number',\n       'Allele Frequency', 'Homozygote Count', 'Hemizygote Count',\n       'Filters - joint', 'GroupMax FAF group', 'GroupMax FAF frequency',\n       'cadd', 'revel_max', 'spliceai_ds_max', 'pangolin_largest_ds', 'phylop',\n       'sift_max', 'polyphen_max', 'Allele Count African/African American',\n       'Allele Number African/African American',\n       'Homozygote Count African/African American',\n       'Hemizygote Count African/African American',\n       'Allele Count Admixed American', 'Allele Number Admixed American',\n       'Homozygote Count Admixed American', 'Hemizygote Count Admixed American',\n       'Allele Count Ashkenazi Jewish', 'Allele Number Ashkenazi Jewish',\n       'Homozygote Count Ashkenazi Jewish', 'Hemizygote Count Ashkenazi Jewish',\n       'Allele Count East Asian', 'Allele Number East Asian',\n       'Homozygote Count East Asian', 'Hemizygote Count East Asian',\n       'Allele Count European (Finnish)', 'Allele Number European (Finnish)',\n       'Homozygote Count European (Finnish)',\n       'Hemizygote Count European (Finnish)', 'Allele Count Middle Eastern',\n       'Allele Number Middle Eastern', 'Homozygote Count Middle Eastern',\n       'Hemizygote Count Middle Eastern', 'Allele Count European (non-Finnish)',\n       'Allele Number European (non-Finnish)',\n       'Homozygote Count European (non-Finnish)',\n       'Hemizygote Count European (non-Finnish)', 'Allele Count Amish',\n       'Allele Number Amish', 'Homozygote Count Amish',\n       'Hemizygote Count Amish', 'Allele Count South Asian',\n       'Allele Number South Asian', 'Homozygote Count South Asian',\n       'Hemizygote Count South Asian', 'Allele Count Remaining',\n       'Allele Number Remaining', 'Homozygote Count Remaining',\n       'Hemizygote Count Remaining'],\n      dtype='object')\n```\n\nå°† gnomAD çš„ CSV æ–‡ä»¶è½¬æ¢ä¸º ANNOVAR æ‰€éœ€çš„ `.avinput` æ ¼å¼ï¼Œéœ€è¦æå–ä»¥ä¸‹äº”åˆ—å¹¶è¿›è¡Œé€‚å½“å¤„ç†ï¼š\n\n-   `Chromosome` â†’ è½¬æ¢ä¸º `chr` æ ¼å¼ï¼ˆä¾‹å¦‚ `21` â†’ `chr5`ï¼‰\n\n-   `Position` â†’ ç”¨ä½œ `start` å’Œ `end`ï¼ˆå•æ ¸è‹·é…¸å˜å¼‚ï¼‰\n\n-   `Reference` â†’ åŸå§‹ç¢±åŸº\n\n-   `Alternate` â†’ æ›¿ä»£ç¢±åŸº\n\n### âœ… ç¤ºä¾‹ Python è„šæœ¬ï¼ˆé€‚ç”¨äº SNV å’Œç®€å• indelï¼‰\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nimport pandas as pd\n\n# è¯»å– CSV æ–‡ä»¶\ndf = pd.read_csv(r\"E:\\acode\\homwwork\\data\\gnomAD_v4.1.0_ENSG00000120054_2025_12_03_15_08_57.csv\")\n\n# æ„å»º ANNOVAR æ‰€éœ€åˆ—\ndef format_chr(chrom):\n    return f\"chr{chrom}\"\n\ndef get_end(pos, ref):\n    return pos + len(ref) - 1\n\nannovar_df = pd.DataFrame({\n    'chr': df['Chromosome'].apply(format_chr),\n    'start': df['Position'],\n    'end': df.apply(lambda row: get_end(row['Position'], str(row['Reference'])), axis=1),\n    'ref': df['Reference'],\n    'alt': df['Alternate']\n})\n\n# ä¿å­˜ä¸º .avinput æ–‡ä»¶\nannovar_df.to_csv(r\"E:\\acode\\homwwork\\data\\gnomAD_CPN1.avinput\", sep='\\t', index=False, header=False)\n```\n:::\n\n\nå¾—åˆ°\n\n``` python\n>>> print(annovar_df.head)\n<bound method NDFrame.head of         chr      start        end ref alt\n0     chr10  100042357  100042357   G   C\n1     chr10  100042358  100042358   A   G\n2     chr10  100042360  100042360   A   C\n3     chr10  100042361  100042362  GA   G\n4     chr10  100042363  100042363   A   T\n...     ...        ...        ...  ..  ..\n1832  chr10  100081694  100081694   C   T\n1833  chr10  100081696  100081696   C   G\n1834  chr10  100081696  100081696   C   T\n1835  chr10  100081697  100081697   G   T\n1836  chr10  100081697  100081697   G   A\n\n[1837 rows x 5 columns]>\n\n### âœ… ä¸‹è½½ä¸å‡†å¤‡æ•°æ®åº“ï¼šå¿«é€Ÿæ£€æŸ¥æ¸…å•\n\n| æ•°æ®åº“ | æ–‡ä»¶æ•°é‡ | æ˜¯å¦å¿…é¡» | ç”¨é€” |\n|------------------|------------------|------------------|------------------|\n| **dbNSFP v4.2a** | 2ï¼ˆä¸»æ–‡ä»¶ + ç´¢å¼•ï¼‰ | âœ… | æä¾›å¤šä¸ªåŠŸèƒ½é¢„æµ‹å·¥å…·ï¼ˆSIFTã€PolyPhen2ã€MetaSVMç­‰ï¼‰ |\n| **ClinVar 20240611** | 2ï¼ˆä¸»æ–‡ä»¶ + ç´¢å¼•ï¼‰ | âœ… | è‡´ç—…æ€§æ³¨é‡Šï¼Œç”¨äºç­›é€‰ä¸´åºŠç›¸å…³å˜å¼‚ |\n| **refGene** | 3ï¼ˆæ³¨é‡Š + mRNA + ç‰ˆæœ¬ï¼‰ | âœ… | åŸºå› ç»“æ„æ³¨é‡Šï¼Œç”¨äºå®šä½å˜å¼‚ä½ç½® |\n\n### ğŸ§  å®ç”¨å»ºè®®ä¸æ³¨æ„äº‹é¡¹\n\n#### 1. **æ–‡ä»¶è·¯å¾„ä¸æƒé™**\n\n-   ç¡®ä¿ `humandb/` ç›®å½•æœ‰å†™æƒé™ï¼Œé¿å… `annotate_variation.pl` ä¸‹è½½å¤±è´¥ã€‚\n\n-   ä¸‹è½½åä½¿ç”¨ `ls -lh` æ£€æŸ¥æ–‡ä»¶å¤§å°æ˜¯å¦å®Œæ•´ï¼ˆå¦‚ dbNSFP åº”çº¦ 40GBï¼‰ã€‚\n\n#### 2. **è§£å‹é¡ºåºä¸å‘½ä»¤**\n\n#### 3. **ç‰ˆæœ¬åŒ¹é…**\n\n-   ç¡®ä¿æˆ‘ä»¬çš„ ANNOVAR æ˜¯æœ€æ–°ç‰ˆï¼Œæ”¯æŒ `dbnsfp42a` å’Œ `clinvar_20240611`ã€‚\n\n-   å¯è¿è¡Œ `./annotate_variation.pl -version` æ£€æŸ¥ç‰ˆæœ¬ã€‚\n\n## æ³¨é‡Š\n\n### âœ… ANNOVAR æ³¨é‡Šå‘½ä»¤\n\n``` bash\nperl /mnt/e/acode/homwwork/data/annovar.latest/annovar/table_annovar.pl \\\n  /mnt/e/acode/homwwork/data/gnomAD_CPN1.avinput \\\n  /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb/ \\\n  -buildver hg38 \\\n  -out /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno \\\n  -remove \\\n  -protocol refGene,dbnsfp42a,clinvar_20240611 \\\n  -operation g,f,f \\\n  -nastring . \\\n  -polish \\\n  -xref /mnt/e/acode/homwwork/data/annovar.latest/annovar/example/gene_fullxref.txt\n```\n\n``` bash\njayz@localhost:/mnt/e/acode/homwwork$ perl /mnt/e/acode/homwwork/data/annovar.latest/annovar/table_annovar.pl \\\n  /mnt/e/acode/homwwork/data/gnomAD_CPN1.avinput \\\n  /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb/ \\    \n  -buildver hg38 \\\n  -out /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno \\\n  -remove \\\n  -protocol refGene,dbnsfp42a,clinvar_20240611 \\\n  -operation g,f,f \\\n  -nastring . \\\n  -polish \\\n  -xref /mnt/e/acode/homwwork/data/annovar.latest/annovar/example/gene_fullxref.txt\n-----------------------------------------------------------------\nNOTICE: Processing operation=g protocol=refGene\n\nNOTICE: Running with system command <annotate_variation.pl -geneanno -buildver hg38 -dbtype refGene -outfile /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.refGene -exonsort -nofirstcodondel /mnt/e/acode/homwwork/data/gnomAD_CPN1.avinput /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb/>\nNOTICE: Output files are written to /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.refGene.variant_function, /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.refGene.exonic_variant_function\nNOTICE: Reading gene annotation from /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb/hg38_refGene.txt ... Done with 88819 transcripts (including 21511 without coding sequence annotation) for 28307 unique genes\nNOTICE: Processing next batch with 1837 unique variants in 1837 input lines\nNOTICE: Reading FASTA sequences from /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb/hg38_refGeneMrna.fa ... Done with 1 sequences\nWARNING: A total of 606 sequences will be ignored due to lack of correct ORF annotation\n\nNOTICE: Running with system command <coding_change.pl  /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.refGene.exonic_variant_function.orig /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb//hg38_refGene.txt /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb//hg38_refGeneMrna.fa -alltranscript -out /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.refGene.fa -newevf /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.refGene.exonic_variant_function>\n-----------------------------------------------------------------\nNOTICE: Processing operation=f protocol=dbnsfp42a\nNOTICE: Finished reading 107 column headers for '-dbtype dbnsfp42a'\n\nNOTICE: Running system command <annotate_variation.pl -filter -dbtype dbnsfp42a -buildver hg38 -outfile /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno /mnt/e/acode/homwwork/data/gnomAD_CPN1.avinput /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb/ -otherinfo>\nNOTICE: Output file with variants matching filtering criteria is written to /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.hg38_dbnsfp42a_dropped, and output file with other variants is written to /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.hg38_dbnsfp42a_filtered   \nNOTICE: Processing next batch with 1837 unique variants in 1837 input lines\nNOTICE: Database index loaded. Total number of bins is 556674 and the number of bins to be scanned is 21\nNOTICE: Scanning filter database /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb/hg38_dbnsfp42a.txt...Done\n-----------------------------------------------------------------\nNOTICE: Processing operation=f protocol=clinvar_20240611\nNOTICE: Finished reading 5 column headers for '-dbtype clinvar_20240611'\n\nNOTICE: Running system command <annotate_variation.pl -filter -dbtype clinvar_20240611 -buildver hg38 -outfile /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno /mnt/e/acode/homwwork/data/gnomAD_CPN1.avinput /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb/ -otherinfo>\nNOTICE: the --dbtype clinvar_20240611 is assumed to be in generic ANNOVAR database format\nNOTICE: Output file with variants matching filtering criteria is written to /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.hg38_clinvar_20240611_dropped, and output file with other variants is written to /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.hg38_clinvar_20240611_filtered\nNOTICE: Processing next batch with 1837 unique variants in 1837 input lines\nNOTICE: Database index loaded. Total number of bins is 171655 and the number of bins to be scanned is 7\nNOTICE: Scanning filter database /mnt/e/acode/homwwork/data/annovar.latest/annovar/humandb/hg38_clinvar_20240611.txt...Done\n-----------------------------------------------------------------\nNOTICE: Multianno output file is written to /mnt/e/acode/homwwork/data/gnomAD_CPN1_anno.hg38_multianno.txt\n```\n\n## ç»“æœåˆ†æä¸ç­›é€‰\n\nåˆ—å\n\n``` bash\nhead -n 1 gnomAD_CPN1_anno.hg38_multianno.txt | tr '\\t' '\\n' | nl\n```\n\nå¾—åˆ°\n\n``` bash\njayz@localhost:/mnt/e/acode/homwwork/data$ head -n 1 gnomAD_CPN1_anno.hg38_multianno.txt | tr '\\t' '\\n' | nl\n     1  Chr\n     2  Start\n     3  End\n     4  Ref\n     5  Alt\n     6  Func.refGene\n     7  Gene.refGene\n     8  GeneDetail.refGene\n     9  ExonicFunc.refGene\n    10  AAChange.refGene\n    11  SIFT_score\n    12  SIFT_converted_rankscore\n    13  SIFT_pred\n    14  SIFT4G_score\n    15  SIFT4G_converted_rankscore\n    16  SIFT4G_pred\n    17  Polyphen2_HDIV_score\n    18  Polyphen2_HDIV_rankscore\n    19  Polyphen2_HDIV_pred\n    20  Polyphen2_HVAR_score\n    21  Polyphen2_HVAR_rankscore\n    22  Polyphen2_HVAR_pred\n    23  LRT_score\n    24  LRT_converted_rankscore\n    25  LRT_pred\n    26  MutationTaster_score\n    27  MutationTaster_converted_rankscore\n    28  MutationTaster_pred\n    29  MutationAssessor_score\n    30  MutationAssessor_rankscore\n    31  MutationAssessor_pred\n    32  FATHMM_score\n    33  FATHMM_converted_rankscore\n    34  FATHMM_pred\n    35  PROVEAN_score\n    36  PROVEAN_converted_rankscore\n    37  PROVEAN_pred\n    38  VEST4_score\n    39  VEST4_rankscore\n    40  MetaSVM_score\n    41  MetaSVM_rankscore\n    42  MetaSVM_pred\n    43  MetaLR_score\n    44  MetaLR_rankscore\n    45  MetaLR_pred\n    46  MetaRNN_score\n    47  MetaRNN_rankscore\n    48  MetaRNN_pred\n    49  M-CAP_score\n    50  M-CAP_rankscore\n    51  M-CAP_pred\n    52  REVEL_score\n    53  REVEL_rankscore\n    54  MutPred_score\n    55  MutPred_rankscore\n    56  MVP_score\n    57  MVP_rankscore\n    58  MPC_score\n    59  MPC_rankscore\n    60  PrimateAI_score\n    61  PrimateAI_rankscore\n    62  PrimateAI_pred\n    63  DEOGEN2_score\n    64  DEOGEN2_rankscore\n    65  DEOGEN2_pred\n    66  BayesDel_addAF_score\n    67  BayesDel_addAF_rankscore\n    68  BayesDel_addAF_pred\n    69  BayesDel_noAF_score\n    70  BayesDel_noAF_rankscore\n    71  BayesDel_noAF_pred\n    72  ClinPred_score\n    73  ClinPred_rankscore\n    74  ClinPred_pred\n    75  LIST-S2_score\n    76  LIST-S2_rankscore\n    77  LIST-S2_pred\n    78  Aloft_pred\n    79  Aloft_Confidence\n    80  CADD_raw\n    81  CADD_raw_rankscore\n    82  CADD_phred\n    83  DANN_score\n    84  DANN_rankscore\n    85  fathmm-MKL_coding_score\n    86  fathmm-MKL_coding_rankscore\n    87  fathmm-MKL_coding_pred\n    88  fathmm-XF_coding_score\n    89  fathmm-XF_coding_rankscore\n    90  fathmm-XF_coding_pred\n    91  Eigen-raw_coding\n    92  Eigen-raw_coding_rankscore\n    93  Eigen-PC-raw_coding\n    94  Eigen-PC-raw_coding_rankscore\n    95  GenoCanyon_score\n    96  GenoCanyon_rankscore\n    97  integrated_fitCons_score\n    98  integrated_fitCons_rankscore\n    99  integrated_confidence_value\n   100  LINSIGHT\n   101  LINSIGHT_rankscore\n   102  GERP++_NR\n   103  GERP++_RS\n   104  GERP++_RS_rankscore\n   105  phyloP100way_vertebrate\n   106  phyloP100way_vertebrate_rankscore\n   107  phyloP30way_mammalian\n   108  phyloP30way_mammalian_rankscore\n   109  phastCons100way_vertebrate\n   110  phastCons100way_vertebrate_rankscore\n   111  phastCons30way_mammalian\n   112  phastCons30way_mammalian_rankscore\n   113  SiPhy_29way_logOdds\n   114  SiPhy_29way_logOdds_rankscore\n   115  Interpro_domain\n   116  GTEx_V8_gene\n   117  GTEx_V8_tissue\n   118  CLNALLELEID\n   119  CLNDN\n   120  CLNDISDB\n   121  CLNREVSTAT\n   122  CLNSIG\n```\n\n### ğŸ§¬ LoF å˜å¼‚ç±»å‹è¯¦è§£ï¼ˆå­—æ®µï¼š`ExonicFunc.refGene`ï¼‰\n\n| ç±»å‹ | è¯¦ç»†è¯´æ˜ |\n|------------------------------------|------------------------------------|\n| `stopgain` | åœ¨ç¼–ç åŒºå¼•å…¥ä¸€ä¸ª**æå‰ç»ˆæ­¢å¯†ç å­**ï¼ˆå¦‚ UAGã€UAAã€UGAï¼‰ï¼Œä½¿ç¿»è¯‘åœ¨ä¸­é€”åœæ­¢ï¼Œå¯¼è‡´è›‹ç™½è´¨**æˆªçŸ­**ã€‚è¿™ç§æˆªçŸ­å¯èƒ½ä½¿è›‹ç™½å¤±å»å…³é”®ç»“æ„åŸŸæˆ–åŠŸèƒ½ä½ç‚¹ï¼Œå¸¸è§äºè‡´ç—…çªå˜ã€‚ |\n| `frameshift_deletion` | åˆ é™¤çš„ç¢±åŸºæ•°ä¸æ˜¯ 3 çš„å€æ•°ï¼Œå¯¼è‡´**é˜…è¯»æ¡†ç§»ä½**ã€‚ç§»ä½åçš„å¯†ç å­åºåˆ—å®Œå…¨æ”¹å˜ï¼Œé€šå¸¸ä¼šå¼•å…¥æå‰ç»ˆæ­¢å¯†ç å­ï¼Œç”Ÿæˆå¼‚å¸¸è›‹ç™½æˆ–è§¦å‘**NMDï¼ˆæ— ä¹‰ä»‹å¯¼çš„ mRNA é™è§£ï¼‰**ã€‚ |\n| `frameshift_insertion` | æ’å…¥çš„ç¢±åŸºæ•°ä¸æ˜¯ 3 çš„å€æ•°ï¼ŒåŒæ ·å¯¼è‡´**é˜…è¯»æ¡†æ”¹å˜**ã€‚åç»­æ°¨åŸºé…¸åºåˆ—è¢«é‡å†™ï¼ŒåŠŸèƒ½ä¸§å¤±é£é™©æé«˜ã€‚ |\n| `splicing` | å½±å“**å‰ªæ¥ä½ç‚¹**ï¼ˆå¦‚ GT-AG è¾¹ç•Œï¼‰ï¼Œå¯èƒ½å¯¼è‡´å¤–æ˜¾å­è·³è¿‡ã€é”™é…æˆ–å†…å«å­ä¿ç•™ã€‚ç»“æœå¯èƒ½æ˜¯**è›‹ç™½ç»“æ„å¼‚å¸¸**æˆ–åŠŸèƒ½åŸŸç¼ºå¤±ï¼Œå°¤å…¶å½“å‰ªæ¥é”™è¯¯å½±å“å…³é”®åŒºåŸŸæ—¶ã€‚ |\n| `stoploss` | åˆ é™¤åŸæœ¬çš„**ç»ˆæ­¢å¯†ç å­**ï¼Œä½¿ç¿»è¯‘ç»§ç»­è¿›è¡Œï¼Œå¯¼è‡´è›‹ç™½**å»¶é•¿**ã€‚å»¶é•¿éƒ¨åˆ†å¯èƒ½å¹²æ‰°è›‹ç™½æŠ˜å ã€å®šä½æˆ–åŠŸèƒ½ï¼Œç”šè‡³å¼•å…¥æ¯’æ€§åºåˆ—ã€‚ |\n| `startloss` | åˆ é™¤æˆ–çªå˜èµ·å§‹å¯†ç å­ï¼ˆé€šå¸¸æ˜¯ ATGï¼‰ï¼Œå¯èƒ½é˜»æ­¢ç¿»è¯‘å¯åŠ¨ã€‚è‹¥æ²¡æœ‰æ›¿ä»£èµ·å§‹ä½ç‚¹ï¼Œè›‹ç™½å°†**æ— æ³•è¡¨è¾¾**ï¼Œç›´æ¥å¯¼è‡´åŠŸèƒ½ç¼ºå¤±ã€‚ |\n\n``` bash\nawk -F'\\t' '$9 ~ /stopgain|frameshift_deletion|frameshift_insertion|splicing|stoploss|startloss/' gnomAD_CPN1_anno.hg38_multianno.txt > CPN1_LOF.txt \n```\n\n``` bash\njayz@localhost:/mnt/e/acode/homwwork/data$ head CPN1_LOF.txt\nchr10   100042441       100042441       T       A       exonic  CPN1      .       stopgain        CPN1:NM_001308:exon9:c.A1363T:p.R455X     .       .       .       .       .       .       .       ...       .       .       .       .       .       1.000   0.207   N..       .       .       .       .       .       .       .       0.641     0.653   .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       0.343     0.860   D       0.254   0.858   D       .       .       ...       .       Recessive;      High;   5.625   0.949   34      0.915     0.207   0.028   0.076   N       0.072   0.143   N       -0.267    0.304   -0.615  0.191   0.981   0.303   0.554   0.289   0..       4.79    -0.415  0.117   -0.085  0.112   0.177   0.213   0.000     0.064   0.030   0.153   7.216   0.251   .       .       ...       .       .       .\nchr10   100042465       100042465       C       A       exonic  CPN1      .       stopgain        CPN1:NM_001308:exon9:c.G1339T:p.E447X     .       .       .       .       .       .       .       ...       .       .       .       .       .       0.562   0.322   D..       .       .       .       .       .       .       .       0.492     0.526   .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       0.343     0.860   D       0.254   0.858   D       .       .       ...       .       Recessive;      High;   5.588   0.948   34      0.966     0.304   0.027   0.074   N       0.056   0.104   N       -0.173    0.343   -0.536  0.212   0.984   0.306   0.554   0.289   0..       4.02    1.14    0.198   0.063   0.143   0.129   0.186   0.000     0.064   0.003   0.082   3.341   0.067   .       .       ...       .       .       .\nchr10   100042480       100042480       G       A       exonic  CPN1      .       stopgain        CPN1:NM_001308:exon9:c.C1324T:p.Q442X     .       .       .       .       .       .       .       ...       .       .       0.000   0.002   N       1.000   0.588   D..       .       .       .       .       .       .       .       0.515     0.546   .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       0.501     0.943   D       0.482   0.942   D       .       .       ...       .       Recessive;      High;   6.553   0.965   36      0.981     0.382   0.474   0.280   N       0.142   0.264   N       0.198     0.511   -0.050  0.375   1.000   0.412   0.554   0.289   0..       5.11    4.2     0.488   1.464   0.349   0.213   0.241   0.293     0.253   0.050   0.170   11.335  0.487   .       .       ...       .       .       .\nchr10   100048833       100048833       G       T       exonic  CPN1      .       stopgain        CPN1:NM_001308:exon8:c.C1155A:p.Y385X     .       .       .       .       .       .       .       ...       .       .       0.000   0.843   D       1       0.810   A..       .       .       .       .       .       .       .       0.918     0.921   .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       0.380     0.887   D       0.308   0.886   D       .       .       ...       .       Recessive;.;    High;.; 7.559   0.980   38      0.985     0.422   0.893   0.496   D       0.080   0.163   N       0.084     0.457   -0.190  0.319   0.075   0.157   0.615   0.376   0..       5.5     0.427   0.157   3.602   0.538   0.216   0.242   1.000     0.716   0.912   0.384   9.160   0.362   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       ...       .       .       .\nchr10   100054405       100054405       G       T       exonic  CPN1      .       stopgain        CPN1:NM_001308:exon7:c.C1053A:p.Y351X     .       .       .       .       .       .       .       ...       .       .       0.599   0.110   N       1       0.810   A..       .       .       .       .       .       .       .       0.867     0.864   .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       0.283     0.816   D       0.169   0.814   D       .       .       ...       .       Recessive;.;    High;.; 5.061   0.934   33      0.963     0.293   0.055   0.113   N       0.103   0.207   N       -0.345    0.275   -0.797  0.146   0.993   0.331   0.554   0.289   0..       4.23    -8.02   0.010   0.136   0.158   -0.056  0.130   0.005     0.170   0.110   0.198   20.517  0.992   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       ...       .       .       .\nchr10   100054413       100054413       C       A       exonic  CPN1      .       stopgain        CPN1:NM_001308:exon7:c.G1045T:p.E349X     .       .       .       .       .       .       .       ...       .       .       0.000   0.629   D       1       0.810   A..       .       .       .       .       .       .       .       0.882     0.880   .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       0.575     0.968   D       0.588   0.968   D       .       .       ...       .       Recessive;.;    High;.; 7.980   0.987   40      0.996     0.747   0.864   0.457   D       0.402   0.476   N       0.660     0.770   0.482   0.668   0.753   0.234   0.487   0.140   0..       4.23    4.23    0.493   1.363   0.338   1.026   0.459   0.763     0.293   0.826   0.344   11.416  0.492   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       ...       .       .       .\nchr10   100057032       100057033       AG      A       exonic  CPN1      .       stopgain        CPN1:NM_001308:exon6:c.991_992delinsT:p.L331*     .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .\nchr10   100057053       100057053       C       T       exonic  CPN1      .       stopgain        CPN1:NM_001308:exon6:c.G971A:p.W324X      .       .       .       .       .       .       .       ...       .       .       0.002   0.383   N       1       0.810   A..       .       .       .       .       .       .       .       0.908     0.909   .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       0.607     0.979   D       0.635   0.978   D       .       .       ...       .       Recessive;.;    High;.; 7.751   0.983   39      0.997     0.782   0.980   0.786   D       0.121   0.236   N       0.805     0.864   0.661   0.794   0.998   0.369   0.554   0.289   0..       4.46    4.46    0.536   4.964   0.634   1.026   0.459   1.000     0.716   0.999   0.704   17.300  0.871   Peptidase M14, carboxypeptidase A|Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A|Peptidase M14, carboxypeptidase A     .       ...       .       .       .\nchr10   100057063       100057063       G       A       exonic  CPN1      .       stopgain        CPN1:NM_001308:exon6:c.C961T:p.Q321X      .       .       .       .       .       .       .       ...       .       .       0.339   0.140   N       1       0.810   A..       .       .       .       .       .       .       .       0.789     0.785   .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       0.240     0.777   D       0.288   0.876   D       .       .       ...       .       Recessive;.;    High;.; 7.004   0.971   37      0.994     0.634   0.676   0.335   D       0.181   0.308   N       0.550     0.701   0.288   0.548   0.172   0.178   0.487   0.140   0..       4.46    3.53    0.395   2.199   0.423   1.176   0.789   0.715     0.288   0.090   0.190   13.682  0.620   Peptidase M14, carboxypeptidase A|Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A|Peptidase M14, carboxypeptidase A     .       ...       .       .       .\nchr10   100057138       100057138       T       TA      exonic  CPN1      .       stopgain        CPN1:NM_001308:exon6:c.886delinsTA:p.N296*        .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .       .       .       .       .       ...       .       .       .\n```\n\n-   è¿™æ˜¯åœ¨ gnomAD æ³¨é‡Šæ–‡ä»¶ä¸­ç­›é€‰ **å¤±èƒ½å˜å¼‚ï¼ˆLoss-of-function, LOFï¼‰**ã€‚\n\n-   åŒ…æ‹¬ï¼š`stopgain`ï¼ˆæå‰ç»ˆæ­¢ï¼‰ã€`frameshift`ï¼ˆç§»ç ï¼‰ã€`splicing`ï¼ˆå‰ªæ¥ä½ç‚¹ï¼‰ã€`stoploss`ï¼ˆç»ˆæ­¢å¯†ç å­ä¸¢å¤±ï¼‰ã€`startloss`ï¼ˆèµ·å§‹å¯†ç å­ä¸¢å¤±ï¼‰ã€‚\n\n-   è¾“å‡ºæ–‡ä»¶å°±æ˜¯ **CPN1 åŸºå› çš„ LOF å˜å¼‚é›†åˆ**ã€‚\n\n## 1. æ–‡ä»¶å†…å®¹ç»“æ„\n\næ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªå˜å¼‚ï¼Œä¸»è¦å­—æ®µï¼š\n\n-   **chr10 / åæ ‡**ï¼šå˜å¼‚æ‰€åœ¨æŸ“è‰²ä½“å’Œä½ç½®ã€‚\n\n-   **REF/ALT**ï¼šå‚è€ƒå’Œæ›¿ä»£ç¢±åŸºã€‚\n\n-   **åŠŸèƒ½æ³¨é‡Š**ï¼š`exonic`ï¼ŒåŸºå› å `CPN1`ã€‚\n\n-   **å˜å¼‚ç±»å‹**ï¼šè¿™é‡Œéƒ½æ˜¯ `stopgain` â†’ äº§ç”Ÿæå‰ç»ˆæ­¢å¯†ç å­ã€‚\n\n-   **è½¬å½•æœ¬æ³¨é‡Š**ï¼šä¾‹å¦‚ `NM_001308:exon9:c.A1363T:p.R455X` è¡¨ç¤ºåœ¨è½¬å½•æœ¬ NM_001308 çš„ç¬¬9å¤–æ˜¾å­ï¼Œæ ¸è‹·é…¸ A1363Tï¼Œå¯¼è‡´æ°¨åŸºé…¸ R455Xï¼ˆç²¾æ°¨é…¸å˜ä¸ºç»ˆæ­¢ï¼‰ã€‚\n\n-   **åŠŸèƒ½é¢„æµ‹å­—æ®µ**ï¼šåé¢æœ‰ SIFTã€PolyPhen2ã€MutationAssessorã€MetaSVM ç­‰ç»“æœï¼ˆD=deleterious, N=neutral, A=ambiguousï¼‰ã€‚\n\n-   **ClinVar/å…¶ä»–æ³¨é‡Š**ï¼šæœ‰æ—¶ä¼šå‡ºç° â€œRecessive; Highâ€ ç­‰æç¤ºï¼Œè¡¨ç¤ºé—ä¼ æ¨¡å¼å’ŒåŠŸèƒ½å½±å“ã€‚\n\n## 2. ç¤ºä¾‹è§£è¯»\n\n### å˜å¼‚ 1\n\nä»£ç \n\n```         \nchr10 100042441 T>A exonic CPN1 stopgain NM_001308:exon9:c.A1363T:p.R455X \n```\n\n-   **ç±»å‹**ï¼šstopgain â†’ è›‹ç™½æˆªçŸ­ã€‚\n\n-   **å½±å“**ï¼šR455Xï¼Œä¸¢å¤± CPN1 è›‹ç™½ C ç«¯éƒ¨åˆ†ã€‚\n\n-   **é¢„æµ‹**ï¼šéƒ¨åˆ†å·¥å…·æ˜¾ç¤º Dï¼ˆæœ‰å®³ï¼‰ï¼Œéƒ¨åˆ† Nï¼ˆä¸­æ€§ï¼‰ï¼Œä½†ä½œä¸º LOF å˜å¼‚ï¼Œæœ¬èº«å°±å±äºè‡´ç—…æ€§å€™é€‰ã€‚\n\n### å˜å¼‚ 2\n\n```         \nchr10 100042441 T>A exonic CPN1 stopgain NM_001308:exon9:c.A1363T:p.R455X\n```\n\n-   **ç±»å‹**ï¼šstopgain â†’ è›‹ç™½æˆªçŸ­ã€‚\n\n-   **å½±å“**ï¼šE447Xã€‚\n\n-   **é¢„æµ‹**ï¼šPolyPhen2ã€MetaSVM æ˜¾ç¤º Dï¼ˆdeleteriousï¼‰ã€‚\n\n-   **æ„ä¹‰**ï¼šåŒæ ·æ˜¯ LOF å˜å¼‚ã€‚\n\n### å˜å¼‚ 3\n\n```         \nchr10 100042480 G>A exonic CPN1 stopgain NM_001308:exon9:c.C1324T:p.Q442X \n```\n\n-   **ç±»å‹**ï¼šstopgainã€‚\n\n-   **å½±å“**ï¼šQ442Xã€‚\n\n-   **é¢„æµ‹**ï¼šå¤šå·¥å…·ä¸€è‡´ Dã€‚\n\n-   **æ„ä¹‰**ï¼šå…¸å‹ LOFã€‚\n\n### å…¶ä»–è¡Œï¼ˆY385X, Y351X, E349X, L331\\*, W324X, Q321Xï¼‰\n\n-   éƒ½æ˜¯ **stopgain** æˆ– **æˆªçŸ­å˜å¼‚**ï¼Œå±äº LOFã€‚\n\n-   æ³¨é‡Šé‡Œå¸¸è§ â€œRecessive; Highâ€ â†’ æç¤ºå¯èƒ½çš„éšæ€§é—ä¼ æ¨¡å¼å’Œé«˜åŠŸèƒ½å½±å“ã€‚\n\n-   éƒ¨åˆ†è¡Œæœ‰ç»“æ„åŸŸæ³¨é‡Šï¼ˆPeptidase M14, carboxypeptidase Aï¼‰ï¼Œè¯´æ˜å˜å¼‚è½åœ¨åŠŸèƒ½åŸŸå†…ï¼Œæ›´å¯èƒ½å½±å“è›‹ç™½åŠŸèƒ½ã€‚\n\n## 3. è‡´ç—…æ€§å˜å¼‚å®šä¹‰åº”ç”¨\n\næ ¹æ®æˆ‘ä»¬çš„æ ‡å‡†ï¼š\n\n-   **å¤±èƒ½å˜å¼‚ï¼ˆLOFï¼‰**ï¼šè¿™äº› stopgain å…¨éƒ¨ç¬¦åˆï¼Œç›´æ¥çº³å…¥ã€‚\n\n-   **åŠŸèƒ½æ€§é”™ä¹‰å˜å¼‚**ï¼šéœ€è¦å¦å¤–ç­›é€‰ `exonic` + `nonsynonymous SNV`ï¼Œå¹¶æ£€æŸ¥ SIFTã€PolyPhen2ã€MutationAssessorã€MetaSVM å››ä¸ªå·¥å…·æ˜¯å¦ä¸€è‡´é¢„æµ‹ä¸ºæœ‰å®³ã€‚\n\n-   **ClinVar è‡´ç—…æ€§**ï¼šå¦‚æœæ³¨é‡Šå­—æ®µé‡Œæœ‰ â€œPathogenicâ€ æˆ– â€œLikely Pathogenicâ€ï¼Œä¹Ÿè¦çº³å…¥ã€‚\n\nç›®å‰æˆ‘ä»¬å±•ç¤ºçš„ `CPN1_LOF.txt` å·²ç»æ˜¯ LOF é›†åˆï¼Œå±äºè‡´ç—…æ€§å˜å¼‚å…¨é›†çš„ä¸€éƒ¨åˆ†ã€‚\n\n## 4. æ€»ç»“\n\n-   æˆ‘ä»¬ç­›é€‰å‡ºçš„ CPN1 å˜å¼‚éƒ½æ˜¯ **æˆªçŸ­å‹ stopgain**ï¼Œå±äº **LOF è‡´ç—…æ€§å€™é€‰**ã€‚\n\n-   è¿™äº›å˜å¼‚å¤§å¤šè½åœ¨è›‹ç™½åŠŸèƒ½åŸŸï¼ˆPeptidase M14ï¼‰ï¼Œæç¤ºå¯èƒ½ä¸¥é‡å½±å“ CPN1 åŠŸèƒ½ã€‚\n\n## ç­›é€‰ ClinVar è‡´ç—…å˜å¼‚\n\n``` bash\nawk -F'\\t' '$122 ~ /Pathogenic|Likely pathogenic/' gnomAD_CPN1_anno.hg38_multianno.txt > CPN1_ClinVar_pathogenic.txt\n```\n\nå¾—åˆ°çš„***CPN1_ClinVar_pathogenic.txt***ä¸ºç©ºawk -F'\\t' '\\$9 \\~ /nonsynonymous SNV/ && \\$20==\"D\" && \\$21==\"D\" && \\$22==\"D\" && \\$23==\"D\"' gnomAD_CPN1_anno.hg38_multianno.txt \\> CPN1_missense_functional.txt\n\nè¯´æ˜åœ¨ç¬¬ 122 åˆ—ï¼ˆé€šå¸¸æ˜¯ ANNOVAR æ³¨é‡Šé‡Œ ClinVar çš„è‡´ç—…æ€§å­—æ®µï¼‰é‡Œç­›é€‰ **Pathogenic æˆ– Likely pathogenic**ã€‚è¾“å‡ºä¸ºç©ºï¼Œè¡¨ç¤ºåœ¨ gnomAD çš„æ³¨é‡Šæ–‡ä»¶é‡Œ **CPN1 åŸºå› æ²¡æœ‰ ClinVar æ ‡æ³¨ä¸ºè‡´ç—…æˆ–å¯èƒ½è‡´ç—…çš„å˜å¼‚**ã€‚\n\nå› æ­¤ï¼Œ**CPN1 çš„è‡´ç—…æ€§å˜å¼‚å…¨é›†ç›®å‰åªåŒ…å« LOF å’ŒåŠŸèƒ½æ€§é”™ä¹‰é¢„æµ‹ä¸€è‡´çš„å˜å¼‚**ã€‚\n\nè®¾å®šçš„å››ä¸ªå·¥å…·æ˜¯ï¼š\n\n-   **SIFT_pred** â†’ ç¬¬ 13 åˆ—\n\n-   **PolyPhen2_HVAR_pred** â†’ ç¬¬ 22 åˆ—\n\n-   **MutationAssessor_pred** â†’ ç¬¬ 31 åˆ—\n\n-   **MetaSVM_pred** â†’ ç¬¬ 42 åˆ—\n\n``` bash\nawk -F'\\t' '$9 == \"nonsynonymous SNV\" && $13 == \"D\" && $22 == \"D\" && $31 == \"D\" && $42 == \"D\"' gnomAD_CPN1_anno.hg38_multianno.txt > CPN1_missense_functional.txt \n```\n\n### ğŸ“Œ è¯´æ˜\n\nç­›é€‰å‡ºæ¥ä¸ºç©ºï¼Œå…¶å®è¯´æ˜äº†ä¸€ä¸ªäº‹å®ï¼šåœ¨ gnomAD çš„æ³¨é‡Šæ–‡ä»¶é‡Œï¼Œ**CPN1 åŸºå› ç›®å‰æ²¡æœ‰ç¬¦åˆæˆ‘ä»¬è®¾å®šæ¡ä»¶çš„é”™ä¹‰è‡´ç—…æ€§å€™é€‰**ã€‚\n\næ›´å®½æ¾ä¸€äº›ï¼Œå¯ä»¥è€ƒè™‘ï¼š\n\n1.  **æ”¾å®½ä¸€è‡´æ€§è¦æ±‚**ï¼šæ¯”å¦‚è¦æ±‚è‡³å°‘ 3 ä¸ªå·¥å…·é¢„æµ‹ä¸ºæœ‰å®³ï¼Œè€Œä¸æ˜¯ 4 ä¸ªå…¨ä¸€è‡´ã€‚\n\n    ``` bash\n    awk -F'\\t' '$9 == \"nonsynonymous SNV\" && (($13==\"D\")+($22==\"D\")+($31==\"D\")+($42==\"D\") >= 3)' gnomAD_CPN1_anno.hg38_multianno.txt > CPN1_missense_relaxed.txt \n    ```\n\n    è¿™æ ·å¯ä»¥æ•æ‰æ›´å¤šæ½œåœ¨åŠŸèƒ½æ€§é”™ä¹‰å˜å¼‚ã€‚\n\n``` bash\njayz@localhost:/mnt/e/acode/homwwork/data$ awk -F'\\t' '$9 == \"nonsynonymous SNV\" && (($13==\"D\")+($22==\"D\")+($31==\"D\")+($42==\"D\") >= 3)' gnomAD_CPN1_anno.hg38_multianno.txt > CPN1_missense_relaxed.txt\n\njayz@localhost:/mnt/e/acode/homwwork/data$ head CPN1_missense_relaxed.txt\nchr10   100042560       100042560       A       G       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon9:c.T1244C:p.L415P   0.0     0.913   D       0.019   0.592   D1.0      0.906   D       0.999   0.924   D       0.000   0.843   D       1       0.810   D4.54     0.991   H       -0.35   0.686   T       -3.48   0.679   D       0.9     0.900   0.476     0.902   D       0.620   0.866   D       0.988   0.992   D       0.827   0.987   D0.671    0.880   0.77    0.897   0.894   0.893   1.584   0.884   0.642   0.589   T       0.696     0.912   D       0.360   0.872   D       0.279   0.871   D       0.999   0.964   D0.663    0.272   T       .;      .;      4.107   0.823   27.8    0.999   0.935   0.929   0.569     D       0.804   0.729   D       0.707   0.801   0.539   0.706   1.000   0.518   0.615     0.376   0       .       .       4.97    4.97    0.654   4.525   0.603   1.312   0.947     1.000   0.716   0.540   0.279   11.330  0.487   Peptidase M14, carboxypeptidase A..       .       .       .       .       .\nchr10   100048781       100048781       C       T       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon8:c.G1207A:p.V403M   0.01    0.785   D       0.005   0.722   D1.0      0.906   D       0.935   0.670   D       0.000   0.629   N       1       0.810   D4.08     0.972   H       0.52    0.553   T       -1.72   0.408   N       0.76    0.758   0.182     0.856   D       0.467   0.794   T       0.776   0.775   D       0.141   0.823   D0.348    0.673   0.623   0.758   0.576   0.572   1.151   0.792   0.486   0.369   T       0.491     0.816   T       0.067   0.605   T       0.028   0.721   D       0.992   0.819   D0.929    0.740   D       .;.;    .;.;    3.556   0.655   24.9    0.999   0.967   0.981   0.798     D       0.866   0.785   D       0.825   0.877   0.716   0.836   1.000   0.748   0.615     0.376   0       .       .       5.5     5.5     0.814   5.233   0.652   1.012   0.383     1.000   0.716   0.949   0.417   18.215  0.898   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       .       .       .       .       .       . \nchr10   100048840       100048840       C       A       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon8:c.G1148T:p.G383V   0.0     0.913   D       0.0     0.928   D0.968    0.566   D       0.914   0.650   D       0.000   0.629   D       1       0.810   D4.565    0.992   H       1.58    0.612   T       -8.16   0.969   D       0.944   0.951   0.508     0.907   D       0.570   0.844   D       0.893   0.886   D       0.483   0.949   D0.495    0.783   0.653   0.791   0.904   0.903   0.621   0.564   0.609   0.542   T       0.735     0.926   D       0.342   0.860   D       0.254   0.858   D       0.999   0.974   D0.990    0.968   D       .;.;    .;.;    3.642   0.678   25.2    0.997   0.792   0.979   0.781     D       0.845   0.761   D       0.889   0.912   0.767   0.874   1.000   0.748   0.615     0.376   0       .       .       5.5     5.5     0.814   5.379   0.659   1.012   0.383     1.000   0.716   0.927   0.396   18.215  0.898   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       .       .       .       .       .       . \nchr10   100048844       100048844       G       A       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon8:c.C1144T:p.P382S   0.002   0.722   D       0.006   0.706   D1.0      0.906   D       1.0     0.974   D       0.000   0.843   D       1       0.810   D3.59     0.936   H       2.14    0.510   T       -7.23   0.947   D       0.894   0.894   0.022     0.827   D       0.418   0.764   T       0.886   0.879   D       0.101   0.774   D0.736    0.909   0.696   0.833   0.828   0.827   1.216   0.810   0.631   0.573   T       0.700     0.914   D       0.300   0.830   D       0.193   0.827   D       0.999   0.944   D0.955    0.828   D       .;.;    .;.;    4.326   0.888   29.8    0.999   0.986   0.989   0.881     D       0.936   0.932   D       0.980   0.951   0.905   0.958   1.000   0.748   0.615     0.376   0       .       .       5.5     5.5     0.814   9.016   0.932   1.160   0.714     1.000   0.716   0.990   0.524   18.215  0.898   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       .       .       .       .       .       . \nchr10   100048855       100048855       C       T       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon8:c.G1133A:p.R378Q   0.0     0.913   D       0.003   0.765   D1.0      0.906   D       0.998   0.886   D       0.000   0.843   D       1       0.810   D4.31     0.983   H       0.98    0.421   T       -3.67   0.710   D       0.94    0.947   0.157     0.852   D       0.424   0.768   T       0.772   0.772   D       0.169   0.847   D0.544    0.812   .       .       0.695   0.692   1.311   0.832   0.455   0.326   T       0.693     0.911   D       0.164   0.706   D       0.179   0.820   D       1.000   0.988   D0.996    0.986   D       .;.;    .;.;    4.201   0.855   28.7    1.000   1.000   0.984   0.820     D       0.886   0.818   D       1.027   0.965   0.934   0.969   1.000   0.748   0.615     0.376   0       .       .       5.5     5.5     0.814   7.113   0.767   1.012   0.383     1.000   0.716   1.000   0.863   18.215  0.898   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       .       2351171 not_specified   MedGen:CN169374   criteria_provided,_single_submitter     Uncertain_significance\nchr10   100048856       100048856       G       A       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon8:c.C1132T:p.R378W   0.0     0.913   D       0.0     0.928   D1.0      0.906   D       1.0     0.974   D       0.000   0.843   D       1       0.810   D4.31     0.983   H       0.98    0.421   T       -7.25   0.947   D       0.952   0.961   0.157     0.852   D       0.424   0.768   T       0.898   0.892   D       0.241   0.887   D0.683    0.885   0.745   0.876   0.776   0.774   1.254   0.819   0.613   0.548   T       0.735     0.926   D       0.206   0.744   D       0.154   0.805   D       1.000   0.993   D0.997    0.989   D       .;.;    .;.;    4.363   0.895   31      0.999   0.983   0.960   0.672     D       0.848   0.765   D       0.962   0.945   0.867   0.940   1.000   0.440   0.615     0.376   0       .       .       5.5     5.5     0.814   3.416   0.525   1.160   0.714     1.000   0.716   1.000   0.863   18.215  0.898   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       .       .       .       .       .       . \nchr10   100048867       100048867       C       T       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon8:c.G1121A:p.G374D   0.001   0.913   D       0.0     0.928   D1.0      0.906   D       1.0     0.974   D       0.000   0.843   D       1       0.810   D4.61     0.993   H       -4.32   0.972   D       -6.43   0.913   D       0.989   0.997   1.073     0.987   D       0.973   0.992   D       0.988   0.992   D       0.815   0.986   D0.941    0.988   0.869   0.963   0.997   0.997   1.403   0.853   0.622   0.561   T       0.731     0.925   D       0.560   0.961   D       0.566   0.960   D       0.999   0.953   D0.946    0.973   D       .;.;    .;.;    3.677   0.687   25.3    0.998   0.915   0.983   0.819     D       0.888   0.820   D       0.900   0.917   0.738   0.853   1.000   0.748   0.615     0.376   0       .       .       5.5     5.5     0.814   7.113   0.767   1.012   0.383     1.000   0.716   0.296   0.240   18.215  0.898   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       .       .       .       .       .       . \nchr10   100054362       100054362       G       C       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon7:c.C1096G:p.H366D   0.001   0.913   D       0.003   0.765   D1.0      0.906   D       1.0     0.974   D       0.000   0.629   D       1       0.810   D3.815    0.955   H       2.53    0.411   T       -8.61   0.977   D       0.843   0.839   0.085     0.839   D       0.384   0.740   T       0.825   0.816   D       0.100   0.773   D0.544    0.812   0.615   0.749   0.639   0.636   1.452   0.862   0.648   0.597   T       0.671     0.902   D       0.303   0.832   D       0.197   0.830   D       0.999   0.951   D0.986    0.951   D       .;.;    .;.;    4.265   0.874   29.3    0.994   0.615   0.980   0.790     D       0.930   0.916   D       0.883   0.909   0.759   0.868   1.000   0.748   0.578     0.328   0       .       .       4.23    4.23    0.493   8.026   0.892   1.176   0.789     1.000   0.716   1.000   0.863   16.387  0.833   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       .       .       .       .       .       . \nchr10   100054371       100054371       C       T       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon7:c.G1087A:p.G363R   0.001   0.785   D       0.004   0.742   D1.0      0.906   D       0.98    0.748   D       0.000   0.629   D       1.000   0.588   D3.975    0.966   H       2.37    0.535   T       -6.62   0.921   D       0.729   0.730   0.260     0.869   D       0.443   0.781   T       0.921   0.914   D       0.181   0.855   D0.500    0.786   0.792   0.914   0.821   0.819   1.337   0.838   0.727   0.711   T       0.663     0.899   D       0.077   0.617   D       -0.030  0.684   D       0.998   0.935   D0.937    0.762   D       .;.;    .;.;    4.204   0.856   28.7    0.999   0.994   0.976   0.759     D       0.943   0.948   D       0.901   0.918   0.773   0.879   1.000   0.748   0.578     0.328   0       .       .       4.23    4.23    0.493   7.903   0.861   1.026   0.459     1.000   0.716   0.992   0.541   16.387  0.833   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A       .       .       .       .       .       .       . \nchr10   100054382       100054382       A       G       exonic  CPN1    .       nonsynonymous SNV CPN1:NM_001308:exon7:c.T1076C:p.I359T   0.0     0.913   D       0.001   0.834   D0.999    0.779   D       0.989   0.784   D       0.000   0.629   D       1       0.810   D4.32     0.983   H       0.58    0.541   T       -4.65   0.794   D       0.82    0.816   0.239     0.866   D       0.474   0.798   T       0.881   0.874   D       0.155   0.836   D0.706    0.896   0.768   0.895   0.696   0.694   1.381   0.848   0.754   0.751   T       0.671     0.902   D       0.337   0.856   D       0.246   0.854   D       0.998   0.940   D0.982    0.940   D       .;.;    .;.;    4.099   0.820   27.7    0.999   0.936   0.985   0.832     D       0.930   0.917   D       0.881   0.908   0.748   0.860   1.000   0.518   0.554     0.289   0       .       .       4.23    4.23    0.493   9.322   0.956   1.312   0.947     1.000   0.716   1.000   0.863   13.143  0.589   Peptidase M14, carboxypeptidase A;Peptidase M14, carboxypeptidase A     \n```\n\n## ç¤ºä¾‹å˜å¼‚è§£è¯»\n\n### **L415P (chr10:100042560)**\n\n-   **å˜å¼‚**ï¼šc.T1244C:p.L415P\n\n-   **ä½ç½®**ï¼šç¬¬ 9 å¤–æ˜¾å­\n\n-   **é¢„æµ‹**ï¼šSIFTã€PolyPhen2 HVARã€MutationAssessorã€MetaSVM å…¨éƒ¨ä¸º Dã€‚\n\n-   **æ„ä¹‰**ï¼šæ°¨åŸºé…¸ç”±ç–æ°´æ€§äº®æ°¨é…¸å˜ä¸ºè„¯æ°¨é…¸ï¼Œå¯èƒ½ä¸¥é‡å½±å“è›‹ç™½æŠ˜å ã€‚\n\n-   **ç»“è®º**ï¼šå¼ºçƒˆçš„åŠŸèƒ½æ€§å€™é€‰ã€‚\n\n### **V403M (chr10:100048781)**\n\n-   **å˜å¼‚**ï¼šc.G1207A:p.V403M\n\n-   **é¢„æµ‹**ï¼šå¤§éƒ¨åˆ†å·¥å…·ä¸º Dï¼Œä½† MutationAssessor ç»™å‡º N/Tã€‚\n\n-   **æ„ä¹‰**ï¼šé¢„æµ‹ç»“æœä¸å®Œå…¨ä¸€è‡´ï¼Œä½†ä»æ»¡è¶³ â‰¥3 å·¥å…·æœ‰å®³ã€‚\n\n-   **ç»“è®º**ï¼šä¸­ç­‰å¯ä¿¡åº¦å€™é€‰ã€‚\n\n### **G383V (chr10:100048840)**\n\n-   **å˜å¼‚**ï¼šc.G1148T:p.G383V\n\n-   **é¢„æµ‹**ï¼šå‡ ä¹æ‰€æœ‰å·¥å…·ä¸º Dã€‚\n\n-   **æ„ä¹‰**ï¼šè½åœ¨ **Peptidase M14, carboxypeptidase A** åŠŸèƒ½åŸŸï¼Œæç¤ºå¯èƒ½å½±å“é…¶æ´»æ€§ã€‚\n\n-   **ç»“è®º**ï¼šé«˜å¯ä¿¡åº¦å€™é€‰ã€‚\n\n### **P382S (chr10:100048844)**\n\n-   **å˜å¼‚**ï¼šc.C1144T:p.P382S\n\n-   **é¢„æµ‹**ï¼šå¤§éƒ¨åˆ†å·¥å…·ä¸º Dã€‚\n\n-   **æ„ä¹‰**ï¼šè„¯æ°¨é…¸ â†’ ä¸æ°¨é…¸ï¼Œå¯èƒ½æ”¹å˜ç»“æ„ç¨³å®šæ€§ã€‚\n\n-   **ç»“è®º**ï¼šå€™é€‰ã€‚\n\n### **R378Q / R378W (chr10:100048855â€“856)**\n\n-   **å˜å¼‚**ï¼šc.G1133A:p.R378Q å’Œ c.C1132T:p.R378W\n\n-   **é¢„æµ‹**ï¼šå¤§éƒ¨åˆ†å·¥å…·ä¸º Dã€‚\n\n-   **ClinVar æ³¨é‡Š**ï¼šR378Q æœ‰ ClinVar æ¡ç›®ï¼ˆUncertain significanceï¼‰ã€‚\n\n-   **æ„ä¹‰**ï¼šæç¤ºè¯¥ä½ç‚¹åœ¨ä¸´åºŠä¸Šå·²æœ‰å…³æ³¨ï¼Œä½†ç›®å‰è¯æ®ä¸è¶³ã€‚\n\n-   **ç»“è®º**ï¼šå€™é€‰ï¼Œä½†éœ€ç»“åˆä¸´åºŠè¯æ®ã€‚\n\n### **G374D (chr10:100048867)**\n\n-   **å˜å¼‚**ï¼šc.G1121A:p.G374D\n\n-   **é¢„æµ‹**ï¼šå‡ ä¹æ‰€æœ‰å·¥å…·ä¸º Dã€‚\n\n-   **æ„ä¹‰**ï¼šè½åœ¨åŠŸèƒ½åŸŸå†…ï¼Œå¯èƒ½å½±å“é…¶æ´»æ€§ã€‚\n\n-   **ç»“è®º**ï¼šé«˜å¯ä¿¡åº¦å€™é€‰ã€‚\n\n### **H366D, G363R, I359T (chr10:100054362â€“382)**\n\n-   **å˜å¼‚**ï¼šä½äºç¬¬ 7 å¤–æ˜¾å­ã€‚\n\n-   **é¢„æµ‹**ï¼šå¤§éƒ¨åˆ†å·¥å…·ä¸º Dã€‚\n\n-   **æ„ä¹‰**ï¼šå‡è½åœ¨åŠŸèƒ½åŸŸå†…ï¼Œæç¤ºå¯èƒ½å½±å“è›‹ç™½åŠŸèƒ½ã€‚\n\n-   **ç»“è®º**ï¼šå€™é€‰ã€‚\n\n## æ€»ä½“è§£è¯»\n\n-   **å€™é€‰æ•°é‡**ï¼šå·²ç»æ•æ‰åˆ°å¤šä¸ªé”™ä¹‰å˜å¼‚ï¼Œä¸»è¦é›†ä¸­åœ¨ **ç¬¬ 7â€“9 å¤–æ˜¾å­**ï¼Œä¸”å¤§å¤šè½åœ¨ **Peptidase M14, carboxypeptidase A** åŠŸèƒ½åŸŸã€‚\n\n-   **é¢„æµ‹ä¸€è‡´æ€§**ï¼šå¤šæ•°å˜å¼‚åœ¨ â‰¥3 å·¥å…·ä¸­é¢„æµ‹ä¸ºæœ‰å®³ï¼Œéƒ¨åˆ†ç”šè‡³ 4/4 ä¸€è‡´ã€‚\n\n-   **ä¸´åºŠæ³¨é‡Š**ï¼šR378Q æœ‰ ClinVar æ¡ç›®ï¼Œä½†ç›®å‰ä¸º â€œUncertain significanceâ€ã€‚\n\n-   **åŠŸèƒ½æ„ä¹‰**ï¼šè¿™äº›å˜å¼‚å¯èƒ½å½±å“ CPN1 çš„é…¶æ´»æ€§æˆ–ç»“æ„ç¨³å®šæ€§ï¼Œæ˜¯æ½œåœ¨çš„è‡´ç—…æ€§å€™é€‰ã€‚\n\n------------------------------------------------------------------------\n\n``` r\n\n# 1. è®¾ç½® tokenï¼ˆåªéœ€ä¸€æ¬¡ï¼‰\nSys.setenv(OPENGWAS_JWT = \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImFwaS1qd3QiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJhcGkub3Blbmd3YXMuaW8iLCJhdWQiOiJhcGkub3Blbmd3YXMuaW8iLCJzdWIiOiIzMTQzNTM0ODkxQHFxLmNvbSIsImlhdCI6MTc2Mzk3NTg0NywiZXhwIjoxNzY1MTg1NDQ3fQ.ZFHeL8QswhmATx4S2DTLNNXmt-b7kBdlJQWB6rY-i6E7pO0J4QkgQp1zyvyq2ktXwcijfj1VdfM4pitUY0-jlcBMpHa8hH_9_BTgaCmGqHiw2SBsJr7n69jdywpTPKNJTKDndoiWDzNLDdXKNMbgqTKO2OltnEoMTTb5pPacM2KruzIj3i6XLEKf3AyEEt4WGcZ--1g5bq1icE75eVCFzR7W234bK4aZrWs8Hw5RQSo9ixo8vYh034dQ55byaanH3ahDGgvjySv0b_V-uuw1_I7AuMz2OpGdFRqbxf3BG8Gl0GiwPJHX9evZpPqpdGZZjmY_HZO_xMc-2CPNCHghhg\")\n\nlibrary(TwoSampleMR)\nlibrary(ieugwasr)\n\n\n\n# 2. é€‰æ‹©æš´éœ²å’Œç»“å±€ GWAS ID\nex_id <- \"ukb-b-3016\"   # æš´éœ²ï¼šYears since last breast cancer screening / mammogram\nout_id <- \"ieu-b-102\"   # ç»“å±€ï¼šMajor depression (2019, Nâ‰ˆ500k)\n\n# 3. æå–æš´éœ²å·¥å…·å˜é‡ (æ”¾å®½é˜ˆå€¼ä»¥è·å–æ›´å¤š SNP)\nexposure_dat <- extract_instruments(outcomes = ex_id, p1 = 1e-5, clump = TRUE)\n\n# 4. æå–ç»“å±€æ•°æ®\noutcome_dat <- extract_outcome_data(snps = exposure_dat$SNP, outcomes = out_id)\n\n# 5. åè°ƒæ•°æ®\ndat <- harmonise_data(exposure_dat, outcome_dat)\n\n# 6. ä¸» MR åˆ†æ\nmr_res <- mr(dat)\nprint(mr_res)\n\n# 7. æ•æ„Ÿæ€§åˆ†æ\nhet     <- mr_heterogeneity(dat)      # å¼‚è´¨æ€§\npleio   <- mr_pleiotropy_test(dat)    # æ°´å¹³å¤šæ•ˆæ€§ (Egger æˆªè·)\nsingle  <- mr_singlesnp(dat)          # å• SNP åˆ†æ\nloo     <- mr_leaveoneout(dat)        # ç•™ä¸€æ³•åˆ†æ\n\n# 8. Steiger æ£€éªŒ (æ–¹å‘æ€§)\ndat_steiger <- steiger_filtering(dat)\nmr_res_steiger <- mr(dat_steiger)\n\n# 9. å¯è§†åŒ–\nmr_scatter_plot(mr_res, dat)\nmr_leaveoneout_plot(loo)\n```\n\n------------------------------------------------------------------------\n\n## 4.å…¨åŸºå› ç»„å…³è”æ€§åˆ†æGWAS\n\nåœ¨[[https://www.kdocs.cn/l/caALpwLoJmmi]{.underline}](https://www.kdocs.cn/l/caALpwLoJmmi)è®¤é¢†å¤§è„‘ä½“ç§¯GWASï¼Œé™„ä»¶ä¸­é€‰æ‹©ç›¸åº”æ•°æ®ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾ã€‚è§£é‡Šè¯¥å›¾ä»¥åŠç»“æœã€‚\n\n## 1. è®¾ç½®ç¯å¢ƒä¸è¿æ¥ OpenGWAS\n\nè®¾ç½®äº† tokenï¼Œè¿™æ˜¯è®¿é—® IEU OpenGWAS çš„å¿…è¦æ­¥éª¤ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ `TwoSampleMR` åŒ…æ¥è·å–æ•°æ®ã€‚\n\nè¿™ä¸ªæ˜¯æˆ‘ä»¬çš„ç›®æ ‡gwasæ•°æ®\n\n![](images/å±å¹•æˆªå›¾%202025-12-03%20161813.png)\n\n```r\n# å®‰è£…å¹¶åŠ è½½å¿…è¦åŒ…\nlibrary(TwoSampleMR)\nlibrary(ieugwasr)\nlibrary(ggplot2)\n\nSys.setenv(OPENGWAS_JWT = \"eyJhbGciOiJSUzI1NiIsImtpZCI6ImFwaS1qd3QiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJhcGkub3Blbmd3YXMuaW8iLCJhdWQiOiJhcGkub3Blbmd3YXMuaW8iLCJzdWIiOiIzMTQzNTM0ODkxQHFxLmNvbSIsImlhdCI6MTc2Mzk3NTg0NywiZXhwIjoxNzY1MTg1NDQ3fQ.ZFHeL8QswhmATx4S2DTLNNXmt-b7kBdlJQWB6rY-i6E7pO0J4QkgQp1zyvyq2ktXwcijfj1VdfM4pitUY0-jlcBMpHa8hH_9_BTgaCmGqHiw2SBsJr7n69jdywpTPKNJTKDndoiWDzNLDdXKNMbgqTKO2OltnEoMTTb5pPacM2KruzIj3i6XLEKf3AyEEt4WGcZ--1g5bq1icE75eVCFzR7W234bK4aZrWs8Hw5RQSo9ixo8vYh034dQ55byaanH3ahDGgvjySv0b_V-uuw1_I7AuMz2OpGdFRqbxf3BG8Gl0GiwPJHX9evZpPqpdGZZjmY_HZO_xMc-2CPNCHghhg\")\n\n# æŸ¥è¯¢ GWAS ä¿¡æ¯\ngwas_info <- gwasinfo(\"ubm-b-343\")\nprint(gwas_info)\n```\n\n``` bash\nRows: 1\nColumns: 16\n$ id          <chr> \"ubm-b-343\"\n$ trait       <chr> \"Brainstem_global_volume_Whole-brainstem\"\n$ build       <chr> \"HG19/GRCh37\"\n$ group_name  <chr> \"public\"\n$ category    <lgl> NA\n$ subcategory <lgl> NA\n$ population  <chr> \"European\"\n$ sex         <chr> \"Males and Females\"\n$ author      <chr> \"Elliott LT\"\n$ nsnp        <int> 17103079\n$ sample_size <int> 31968\n$ year        <int> 2021\n$ consortium  <lgl> NA\n$ pmid        <int> 33875891\n$ mr          <int> 1\n$ note        <chr> \"UKB 26720 Volume of Whole-brainstem in the whole brain geâ€¦\n```\n\n## 2. ä¸‹è½½ GWAS summary æ•°æ®\n\n```r\n\n# ä¸‹è½½ GWAS summary æ•°æ®ï¼ˆæŒ‰ p å€¼é˜ˆå€¼ç­›é€‰ï¼‰\ngwas_dat <- associations(id = \"ubm-b-343\", pval = 1e-5)\n\nhead(gwas_dat)\n\n```\n\né€šå¸¸åŒ…å«å­—æ®µï¼š`rsid`, `chr`, `pos`, `pval`, `beta`, `se` ç­‰ã€‚\n\n### ***ä¸‹è½½ä¸ä¸‹æ¥ï¼Œéšä¾¿ç”¨ä¸€ä¸ªè€å¸ˆçš„***\n\n## 3. ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾\n\næ›¼å“ˆé¡¿å›¾å±•ç¤ºæ¯ä¸ª SNP çš„ -log10(p å€¼)ï¼ŒæŒ‰æŸ“è‰²ä½“ä½ç½®æ’åˆ—ã€‚\n\n```r\n# è½½å…¥æ•°æ®\n\ngwas_data <- read.csv(\"E:/acode/homwwork/data3/GCST90085833_buildGRCh38.csv\", \n                      header = TRUE, \n                      stringsAsFactors = FALSE)\n\n# æŸ¥çœ‹æ•°æ®çš„å‰å‡ è¡Œå’Œåˆ—å\n# è¿™æ ·å¯ä»¥çœ‹åˆ°æ•°æ®ç»“æ„å’Œåˆ—åï¼Œè¿™æ˜¯ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾çš„å…³é”®ï¼\nprint(\"--- æ•°æ®é›†çš„å‰å…­è¡Œ ---\")\nhead(gwas_data)\n\nprint(\"--- æ•°æ®é›†çš„åˆ—å ---\")\ncolnames(gwas_data)\n\n```\n\n``` r\n[1] \"--- æ•°æ®é›†çš„å‰å…­è¡Œ ---\"\n         SNP         pval chr      pos effect_allele\n1  rs6671868 5.394361e-06   1  9729599             G\n2 rs79583983 1.689546e-06   1  9743826             A\n3 rs74338407 9.904214e-06   1  9747743             C\n4  rs3795686 2.024417e-06   1 26582091             G\n5 rs12750420 1.332202e-06   1 26608649             G\n6 rs34209692 1.257622e-06   1 26608782             C\n  other_allele      eaf      beta      se samplesize\n1            A 0.919834  -90.1097 19.8094      36778\n2            T 0.955883 -125.9860 26.3162      36778\n3            T 0.959993 -121.8760 27.5784      36778\n4            A 0.686416   54.9259 11.5610      36778\n5            A 0.686392   55.9015 11.5621      36778\n6            T 0.686446   56.0350 11.5623      36778\n                 Phenotype\n1 GCST90085833_buildGRCh38\n2 GCST90085833_buildGRCh38\n3 GCST90085833_buildGRCh38\n4 GCST90085833_buildGRCh38\n5 GCST90085833_buildGRCh38\n6 GCST90085833_buildGRCh38\n[1] \"--- æ•°æ®é›†çš„åˆ—å ---\"\n [1] \"SNP\"           \"pval\"          \"chr\"          \n [4] \"pos\"           \"effect_allele\" \"other_allele\" \n [7] \"eaf\"           \"beta\"          \"se\"           \n[10] \"samplesize\"    \"Phenotype\"\n```\n\n```r\nlibrary(qqman)\n\n\nman_dat <- data.frame(\n  SNP = gwas_dat$rsid,\n  CHR = as.numeric(gwas_dat$chr),\n  BP  = as.numeric(gwas_dat$pos),\n  P   = gwas_dat$p\n)\n\nmanhattan(man_dat,\n          genomewideline = -log10(5e-8),\n          suggestiveline = -log10(1e-5),\n          main = \"Manhattan plot for Brain Volume GWAS (ubm-b-343)\")\n\n```\n\n### ğŸ‰ æ›¼å“ˆé¡¿å›¾ç»˜å›¾å‡†å¤‡\n\nä»åˆ—åå¯ä»¥çœ‹å‡ºï¼Œç»˜åˆ¶æ›¼å“ˆé¡¿å›¾æ‰€éœ€çš„ä¸‰ä¸ªæ ¸å¿ƒä¿¡æ¯å·²ç»é½æ´»ï¼Œè€Œä¸”åˆ—åéå¸¸æ¸…æ™°ï¼š\n\n-   **å…³è”å¼ºåº¦ï¼š** `\"pval\"` (P-value)\n\n-   **æŸ“è‰²ä½“ï¼š** `\"chr\"` (Chromosome)\n\n-   **ç‰©ç†ä½ç½®ï¼š** `\"pos\"` (Position)\n\n### ğŸ¨ ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾ï¼ˆManhattan Plotï¼‰\n\n#### 1. å®‰è£…å’ŒåŠ è½½ `qqman` åŒ…\n\n```r\n library(qqman) \n```\n\n#### 2. ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾\n\nåœ¨ç»˜åˆ¶ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¤„ç†ä¸€ä¸‹æ•°æ®ç±»å‹ï¼Œç¡®ä¿ `chr` å’Œ `pos` æ˜¯æ•°å€¼å‹ï¼Œ`pval` æ˜¯æ•°å€¼å‹ï¼ˆè™½ç„¶å®ƒçœ‹èµ·æ¥å·²ç»æ˜¯ï¼‰ã€‚\n\n```r\n# ç¡®ä¿æ•°æ®ç±»å‹æ­£ç¡®\n# æ³¨æ„ï¼šæˆ‘ä»¬å‡è®¾ chr åˆ—å·²ç»æ˜¯æ•°å­— 1-22 æˆ– X/Y/MTã€‚\n# å¦‚æœ chr åŒ…å« X, Yï¼Œqqman ä¼šè‡ªåŠ¨å¤„ç†ã€‚\ngwas_data$chr <- as.numeric(gwas_data$chr)\ngwas_data$pos <- as.numeric(gwas_data$pos)\ngwas_data$pval <- as.numeric(gwas_data$pval)\n\n# ä½¿ç”¨ manhattan å‡½æ•°ç»˜å›¾\nmanhattan(\n    x = gwas_data,\n    # å‘Šè¯‰å‡½æ•°På€¼ã€æŸ“è‰²ä½“ã€ä½ç½®å’ŒSNPåç§°åˆ†åˆ«å¯¹åº”å“ªä¸ªåˆ—\n    chr = \"chr\",\n    bp = \"pos\",\n    p = \"pval\",\n    snp = \"SNP\",\n    \n    # å›¾å½¢æ ‡é¢˜å’ŒYè½´æ ‡ç­¾\n    main = \"Manhattan Plot for GCST90085833\", # ä¸»æ ‡é¢˜\n    ylab = expression(-log[10](italic(P))), # Yè½´æ ‡ç­¾ï¼š-log10(P)\n    \n    # è®¾ç½®æ˜¾è‘—æ€§é˜ˆå€¼ï¼ˆé€šå¸¸ä¸º 5e-8ï¼Œå³ 5 x 10^-8ï¼‰\n    # genome-wide significance line (çº¢çº¿)\n    suggestiveline = FALSE, # ä¸ç»˜åˆ¶æç¤ºçº¿\n    genomewideline = 5e-8,  # ç»˜åˆ¶å…¨åŸºå› ç»„æ˜¾è‘—æ€§çº¢çº¿\n    \n    # è®¾ç½®é¢œè‰²ï¼ˆè®©å›¾çœ‹èµ·æ¥æ›´ç¾è§‚ï¼‰\n    col = c(\"blue4\", \"orange3\") \n)\n```\n\n### ğŸ“ˆ æ›¼å“ˆé¡¿å›¾ç»“æœè§£é‡Š\n\n#### 1. æ›¼å“ˆé¡¿å›¾æ˜¯ä»€ä¹ˆï¼Ÿ\n\næ›¼å“ˆé¡¿å›¾æ˜¯ **GWAS ç»“æœå¯è§†åŒ–**çš„æ ‡å‡†æ–¹å¼ã€‚å®ƒå¾—åäºçº½çº¦æ›¼å“ˆé¡¿çš„å¤©é™…çº¿ï¼Œå›¾ä¸Šé«˜è€¸çš„â€œæ‘©å¤©å¤§æ¥¼â€ä»£è¡¨ç€ä¸è¡¨å‹**é«˜åº¦æ˜¾è‘—å…³è”**çš„åŸºå› ç»„åŒºåŸŸã€‚\n\n-   **X è½´ï¼š** è¡¨ç¤ºåŸºå› ç»„ä¸Šçš„ä½ç½®ï¼Œä»å·¦åˆ°å³ä¾æ¬¡æ’åˆ—äº†æ‰€æœ‰æŸ“è‰²ä½“ (Chromosome)ï¼Œé€šå¸¸ç”¨äº¤æ›¿çš„é¢œè‰²æ¥åŒºåˆ†ä¸åŒçš„æŸ“è‰²ä½“ã€‚\n\n-   **Y è½´ï¼š** è¡¨ç¤ºå…³è”çš„å¼ºåº¦ï¼Œæ˜¯ä»¥ $-\\log_{10}(P)$ å€¼è¡¨ç¤ºçš„ã€‚\n\n    -   **P å€¼è¶Šå°**ï¼ˆå…³è”è¶Šæ˜¾è‘—ï¼‰ï¼Œåˆ™ $-\\log_{10}(P)$ **è¶Šå¤§**ï¼Œç‚¹å°±è¶Šé«˜ã€‚\n\n-   **çº¢çº¿ï¼ˆå…¨åŸºå› ç»„æ˜¾è‘—æ€§é˜ˆå€¼ï¼‰ï¼š** è¿™æ¡çº¿é€šå¸¸ä½äº $P = 5 \\times 10^{-8}$ï¼ˆå³ $-\\log_{10}(5 \\times 10^{-8}) \\approx 7.3$ï¼‰çš„ä½ç½®ã€‚\n\n#### 2. å¦‚ä½•è§£é‡Šç»“æœï¼Ÿ\n\n-   **å¦‚æœå›¾ä¸­æœ‰â€œæ‘©å¤©å¤§æ¥¼â€ (å³ç‚¹çªç ´çº¢çº¿)ï¼š**\n\n    -   è¿™è¡¨ç¤ºåœ¨è¿™äº›æŸ“è‰²ä½“åŒºåŸŸå­˜åœ¨**ä¸ç ”ç©¶è¡¨å‹ï¼ˆGCST90085833ï¼‰æœ‰é«˜åº¦ç»Ÿè®¡å­¦æ„ä¹‰å…³è”**çš„ SNP ä½ç‚¹ã€‚\n\n    -   è¿™äº›ä½ç‚¹å¯èƒ½æ˜¯**å› æœå˜å¼‚**ï¼Œæˆ–ä¸å› æœå˜å¼‚**é«˜åº¦è¿é”ä¸å¹³è¡¡**ï¼ˆLDï¼‰ã€‚\n\n    -   æœ€é«˜çš„â€œæ‘©å¤©å¤§æ¥¼â€æ‰€åœ¨çš„åŒºåŸŸï¼ˆé€šå¸¸ç§°ä¸º **GWAS hits**ï¼‰æ˜¯éœ€è¦é‡ç‚¹å…³æ³¨å’Œè¿›ä¸€æ­¥ç ”ç©¶çš„**å…³é”®åŸºå› ç»„ä½ç‚¹**ã€‚\n\n-   **å¦‚æœæ‰€æœ‰ç‚¹éƒ½åœ¨çº¢çº¿ä¸‹æ–¹ï¼š**\n\n    -   è¿™è¡¨ç¤ºåœ¨è¯¥ç ”ç©¶ä¸­ï¼Œæ²¡æœ‰ SNP è¾¾åˆ°**å…¨åŸºå› ç»„æ˜¾è‘—æ€§æ°´å¹³**ï¼Œå³æ²¡æœ‰æ‰¾åˆ°å¯ä»¥ç¡®å‡¿å®£å¸ƒçš„å…³è”ä½ç‚¹ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºæ ·æœ¬é‡ä¸è¶³ã€æ•ˆåº”å€¼å¤ªå°ã€æˆ–è¯¥è¡¨å‹å—é—ä¼ å› ç´ å½±å“è¾ƒå°ç­‰åŸå› ã€‚\n\n-   **å›¾ä¸­çš„â€œåœ°æ¯¯â€ï¼š**\n\n    -   X è½´ä¸Šé è¿‘åœ°é¢çš„ç‚¹æ˜¯é‚£äº› P å€¼è¾ƒå¤§çš„ SNPï¼Œå®ƒä»¬çš„å…³è”æ€§ä¸æ˜¾è‘—ã€‚\n\n![](plot-125.png)\n\n-   **å…³è”å¼ºåº¦åˆ†å¸ƒï¼š** å¤§å¤šæ•° SNP ä½äºè¾ƒä½çš„ P å€¼åŒºåŸŸï¼ˆå›¾ä¸­ Y è½´åº•éƒ¨ï¼‰ï¼Œç¬¦åˆé¢„æœŸã€‚åªæœ‰å°‘æ•°å…³é”®åŒºåŸŸå±•ç°å‡ºæé«˜çš„æ˜¾è‘—æ€§ã€‚\n\n-   **é¢œè‰²äº¤æ›¿ï¼š** è“ç‚¹å’Œæ©™ç‚¹äº¤æ›¿å‡ºç°ï¼Œæ¸…æ™°åœ°åŒºåˆ†äº†ä¸åŒçš„æŸ“è‰²ä½“ï¼Œæ–¹ä¾¿æˆ‘ä»¬å®šä½å…³è”ä¿¡å·ã€‚\n\n-   **ç°‡ç¾¤ç°è±¡ï¼š** ä¿¡å·å¾€å¾€ä»¥**ç°‡ç¾¤**çš„å½¢å¼å‡ºç°ï¼ˆæ¯”å¦‚ 3 å·å’Œ 6 å·æŸ“è‰²ä½“ï¼‰ï¼Œè€Œä¸æ˜¯å•ä¸ªå­¤ç«‹çš„ç‚¹ï¼Œè¿™ç¬¦åˆ GWAS çš„é¢„æœŸã€‚å› ä¸ºä¸€ä¸ªå¼ºå…³è”çš„ SNP å‘¨å›´ï¼Œä¸å…¶ LD çš„å…¶ä»– SNP ä¹Ÿä¼šåŒæ—¶æ˜¾ç¤ºå‡ºå¼ºå…³è”ä¿¡å·ã€‚\n\n------------------------------------------------------------------------\n\n## å‡†å¤‡æ•°æ®\n\n```r\nlibrary(TwoSampleMR)\nlibrary(dplyr)\nlibrary(ggplot2)\n\n\n# 1) æŒ‡å®šæš´éœ²ä¸ç»“å±€\nex_id  <- \"ubm-b-343\"   # Brain volume\nout_id <- \"ieu-b-102\"   # Major depression (2019, N~500k)\n\n# 2) æå–æš´éœ²å·¥å…·å˜é‡ï¼ˆæ”¾å®½é˜ˆå€¼ + clump å»é™¤è¿é”ï¼‰\n# p1: æš´éœ²é€‰æ‹©é˜ˆå€¼ï¼›é»˜è®¤ clump=TRUE ä½¿ç”¨ 10000kb, r2=0.001\nexposure_dat <- extract_instruments(\n  outcomes = ex_id,\n  p1 = 1e-5,\n  clump = TRUE\n)\n\n# å¦‚å·¥å…·æ•°ç›®è¿‡å¤š/è¿‡å°‘ï¼Œå¯è§†åŒ– F å€¼æˆ– p åˆ†å¸ƒåšæ£€æŸ¥\n# table(exposure_dat$exposure), summary(exposure_dat$pval.exposure)\n\n# 3) æå–ç»“å±€æ•ˆåº”\noutcome_dat <- extract_outcome_data(\n  snps = exposure_dat$SNP,\n  outcomes = out_id\n)\n\n# 4) åè°ƒæ•°æ®ï¼ˆç­‰ä½åŸºå› æ–¹å‘ä¸€è‡´ï¼Œå‰”é™¤ä¸ä¸€è‡´æˆ–å›æ–‡ä½ç‚¹ï¼‰\ndat <- harmonise_data(exposure_dat, outcome_dat)\n```\n\n## MR\n\n```r\n# 5) ä¸» MR åˆ†æï¼šIVWã€MR-Eggerã€Weighted medianã€Weighted mode\nmr_res <- mr(dat)\nprint(mr_res)\n\n# 6) ç»“æœçš„ç®€è¡¨ï¼ˆbetaã€seã€pã€æ–¹æ³•ï¼‰\nmr_res %>%\n  select(method, b, se, pval, nsnp) %>%\n  arrange(pval) %>% print(n=100)\n```\n\nè§£é‡Šå»ºè®®ï¼š\n\n-   **IVW** æ˜¯ä¸»åˆ†æï¼ˆåœ¨å·¥å…·æœ‰æ•ˆä¸”æ— æ–¹å‘æ€§å¤šæ•ˆæ€§æ—¶æœ€æœ‰åŠ›ï¼‰ã€‚\n\n-   **MR-Egger** å¯æ£€æµ‹æ–¹å‘æ€§æ°´å¹³å¤šæ•ˆæ€§ï¼ˆæ‹¦æˆªé¡¹ï¼‰ï¼Œä½†æ•ˆç‡è¾ƒä½ã€‚\n\n-   **Weighted median** å¯¹ä¸€åŠå·¥å…·æ— æ•ˆä»ç¨³å¥ã€‚\n\n-   **Weighted mode** åœ¨ç›¸åŒæ•ˆåº”çš„â€œå¯†é›†ç°‡â€å­˜åœ¨æ—¶ç¨³å¥ã€‚\n\n``` r\nAnalysing 'ubm-b-343' on 'ieu-b-102'\n  id.exposure id.outcome                          outcome\n1   ubm-b-343  ieu-b-102 Major depression || id:ieu-b-102\n2   ubm-b-343  ieu-b-102 Major depression || id:ieu-b-102\n3   ubm-b-343  ieu-b-102 Major depression || id:ieu-b-102\n4   ubm-b-343  ieu-b-102 Major depression || id:ieu-b-102\n5   ubm-b-343  ieu-b-102 Major depression || id:ieu-b-102\n                                                 exposure\n1 Brainstem_global_volume_Whole-brainstem || id:ubm-b-343\n2 Brainstem_global_volume_Whole-brainstem || id:ubm-b-343\n3 Brainstem_global_volume_Whole-brainstem || id:ubm-b-343\n4 Brainstem_global_volume_Whole-brainstem || id:ubm-b-343\n5 Brainstem_global_volume_Whole-brainstem || id:ubm-b-343\n                     method nsnp            b         se\n1                  MR Egger  123 -0.035530504 0.04885154\n2           Weighted median  123 -0.040355943 0.01522739\n3 Inverse variance weighted  123 -0.031026974 0.01495876\n4               Simple mode  123 -0.005203456 0.04478171\n5             Weighted mode  123 -0.053875456 0.03564262\n         pval\n1 0.468437389\n2 0.008043911\n3 0.038063779\n4 0.907688261\n5 0.133235351\n```\n\n## Sensitivity analyses and diagnostics\n\n```r\n# 7) å¼‚è´¨æ€§ï¼ˆCochranâ€™s Qï¼‰\nhet <- mr_heterogeneity(dat)\nprint(het)\n\n# 8) æ°´å¹³å¤šæ•ˆæ€§ï¼ˆEgger æˆªè·ï¼‰\npleio <- mr_pleiotropy_test(dat)\nprint(pleio)\n\n# 9) å• SNP ä¸ç•™ä¸€æ³•\nsingle <- mr_singlesnp(dat)\nloo    <- mr_leaveoneout(dat)\n\n# 10) Steiger æ–¹å‘æ€§æ£€éªŒï¼ˆæš´éœ²â†’ç»“å±€ï¼‰\n# Steiger æ£€éªŒéœ€è¦çŸ¥é“æ¯ä¸ª GWAS çš„ æ ·æœ¬é‡ (sample size) å’Œ æ•ˆåº”å€¼ (beta, se, maf) æ¥è®¡ç®—æ–¹å·®è§£é‡Šåº¦\ndat_steiger <- steiger_filtering(dat)\nmr_res_steiger <- mr(dat_steiger)\nprint(mr_res_steiger)\n```\n\nè§£è¯»è¦ç‚¹ï¼š\n\n-   **å¼‚è´¨æ€§æ˜¾è‘—**ï¼ˆQ p\\<0.05ï¼‰æç¤ºå·¥å…·ä¹‹é—´æ•ˆåº”å·®å¼‚è¾ƒå¤§ï¼Œå¯èƒ½å­˜åœ¨å¤šæ•ˆæ€§æˆ–æµ‹é‡è¯¯å·®ã€‚\n\n-   **Egger æˆªè·æ˜¾è‘—**ï¼ˆp\\<0.05ï¼‰æç¤ºæ–¹å‘æ€§æ°´å¹³å¤šæ•ˆæ€§ï¼ŒIVW å¯èƒ½åå€šã€‚æ­¤æ—¶æ›´ä¿¡ä»» Weighted median/Mode æˆ–è¿›è¡Œ MR-PRESSOï¼ˆè‹¥éœ€ï¼‰ã€‚\n\n-   **Steiger æ£€éªŒ**è‹¥æ˜¾ç¤ºå¤šæ•° SNP çš„æš´éœ²æ–¹å·®è§£é‡Šåº¦å¤§äºç»“å±€ï¼Œæ”¯æŒå› æœæ–¹å‘ä¸º â€œè„‘ä½“ç§¯ â†’ æŠ‘éƒâ€ï¼›åä¹‹éœ€è°¨æ…ã€‚\n\n``` r\nprint(mr_res_steiger)\n  id.exposure id.outcome                          outcome\n1   ubm-b-343  ieu-b-102 Major depression || id:ieu-b-102\n2   ubm-b-343  ieu-b-102 Major depression || id:ieu-b-102\n                                                 exposure\n1 Brainstem_global_volume_Whole-brainstem || id:ubm-b-343\n2 Brainstem_global_volume_Whole-brainstem || id:ubm-b-343\n                     method        Q Q_df       Q_pval\n1                  MR Egger 342.6088  121 4.632164e-23\n2 Inverse variance weighted 342.6353  122 7.777362e-23\n  id.exposure id.outcome                          outcome\n1   ubm-b-343  ieu-b-102 Major depression || id:ieu-b-102\n                                                 exposure\n1 Brainstem_global_volume_Whole-brainstem || id:ubm-b-343\n  egger_intercept          se      pval\n1    0.0002488173 0.002568281 0.9229813\nTry adding metadata with add_metadata()\nTry adding metadata with add_metadata()\n```\n\n## å¯è§†åŒ–\n\n```r\n# 11) æ•£ç‚¹å›¾ï¼ˆå„æ–¹æ³•çš„å›å½’çº¿ï¼‰\nplots_scatter <- mr_scatter_plot(mr_res, dat)\nprint(plots_scatter[[1]])\n\n# 12) ç•™ä¸€æ³•æ£®æ—å›¾\nplots_loo <- mr_leaveoneout_plot(loo)\nprint(plots_loo[[1]])\n\n# 13) å• SNP æ£®æ—å›¾\nTwoSampleMR::mr_forest_plot(single)\n\n# 14) Funnel å›¾ï¼ˆè¯„ä¼°å°æ ·æœ¬åå€š/å¯¹ç§°æ€§ï¼‰\nTwoSampleMR::mr_funnel_plot(single)\n```\n\nè¿™äº›å›¾å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå®šä½é©±åŠ¨ç»“æœçš„ SNPã€è¯„ä¼°å¤šæ•ˆæ€§ä¸å¯¹ç§°æ€§ï¼Œå¹¶å¯ç”„åˆ«å¼‚å¸¸çš„å•ç‚¹å·¥å…·ã€‚\n\n## ç»“æœä»‹ç»\n\nå½“æˆ‘ä»¬è·‘å®Œä¸Šè¿°ä»£ç åï¼Œè¯·æŒ‰ä»¥ä¸‹é€»è¾‘è§£è¯»ï¼š\n\n-   **æ–¹å‘ä¸å¤§å°ï¼š**\n\n    -   IVW ç»™å‡ºå› æœæ•ˆåº”ä¼°è®¡ï¼šbï¼ˆæ¯å•ä½è„‘ä½“ç§¯å˜åŒ–å¯¼è‡´æŠ‘éƒé£é™©çš„å˜åŒ–ï¼Œé€šå¸¸ log-oddsï¼‰ã€‚è‹¥ b\\<0 ä¸”æ˜¾è‘—ï¼Œè¡¨ç¤ºæ›´å¤§çš„è„‘ä½“ç§¯ä¸æ›´ä½çš„æŠ‘éƒé£é™©ç›¸å…³ï¼›b\\>0 ç›¸åã€‚\n\n-   **æ˜¾è‘—æ€§ä¸ç¨³å¥æ€§ï¼š**\n\n    -   è‹¥ IVW æ˜¾è‘—ï¼ˆp\\<0.05ï¼‰ï¼Œä¸”å¼‚è´¨æ€§ä¸é«˜ã€Egger æˆªè·ä¸æ˜¾è‘—ï¼Œåˆ™ç»“æœè¾ƒä¸ºç¨³å¥ã€‚\n\n    -   è‹¥ IVW æ˜¾è‘—ä½†å­˜åœ¨å¤šæ•ˆæ€§æˆ–é«˜å¼‚è´¨æ€§ï¼Œå‚è€ƒ Weighted median/Mode çš„ä¸€è‡´æ€§ï¼›å¦‚ä¸€è‡´ï¼Œä»æ”¯æŒå› æœï¼›å¦‚ä¸ä¸€è‡´ï¼Œéœ€è°¨æ…ã€‚\n\n-   **æ–¹å‘æ€§ï¼ˆSteigerï¼‰ï¼š**\n\n    -   è‹¥ Steiger è¿‡æ»¤åç»“æœä¸åŸç»“è®ºä¸€è‡´ï¼Œæ–¹å‘æ€§æ›´å¯é ã€‚\n\n-   **æ•æ„Ÿæ€§ï¼š**\n\n    -   ç•™ä¸€æ³•è‹¥ç§»é™¤ä»»ä¸€ SNP åæ•ˆåº”ç¨³å®šï¼Œè¯´æ˜ä¸»ç»“è®ºä¸ä¾èµ–å•ä¸ªå·¥å…·ã€‚\n\n    -   å• SNP æ£®æ—å›¾å¯è¯†åˆ«å¼ºå½±å“çš„å·¥å…·ï¼ˆå†è¯„ä¼°å…¶ç”Ÿç‰©å­¦åˆç†æ€§æˆ–æ½œåœ¨å¤šæ•ˆæ€§ï¼‰ã€‚\n\n![](plot-121.png)\n\n![](plot-122.png)\n\n![](plot-123.png)\n\n![](plot-124.png)\n\n## ä¸»åˆ†æç»“æœ\n\n-   **IVWï¼ˆé€†æ–¹å·®åŠ æƒï¼‰** b = -0.0310ï¼ŒSE = 0.0150ï¼Œp = 0.038 â†’ è„‘å¹²ä½“ç§¯å¢åŠ ä¸æŠ‘éƒé£é™©é™ä½æ˜¾è‘—ç›¸å…³ã€‚\n\n-   **åŠ æƒä¸­ä½æ•°ï¼ˆWeighted medianï¼‰** b = -0.0404ï¼ŒSE = 0.0152ï¼Œp = 0.008 â†’ ç»“æœæ–¹å‘ä¸€è‡´ï¼Œæ˜¾è‘—æ€§æ›´å¼ºï¼Œè¯´æ˜å³ä½¿éƒ¨åˆ†å·¥å…·æ— æ•ˆï¼Œç»“è®ºä»ç¨³å¥ã€‚\n\n-   **MR-Eggerï¼ˆæ–œç‡ï¼‰** b = -0.0355ï¼ŒSE = 0.0489ï¼Œp = 0.468 â†’ æ–¹å‘ä¸€è‡´ï¼Œä½†ä¸æ˜¾è‘—ã€‚\n\n-   **ç®€å•æ¨¡å¼ / åŠ æƒæ¨¡å¼** ç»“æœæ–¹å‘å¤§ä½“ä¸€è‡´ï¼Œä½†ä¸æ˜¾è‘—ã€‚\n\n**ç»“è®º**ï¼šIVW ä¸åŠ æƒä¸­ä½æ•°å‡æç¤º **è„‘å¹²ä½“ç§¯è¶Šå¤§ï¼ŒæŠ‘éƒé£é™©è¶Šä½**ï¼Œä¸”ç»“æœæœ‰ç»Ÿè®¡å­¦æ„ä¹‰ã€‚\n\n## äºŒã€æ•æ„Ÿæ€§åˆ†æ\n\n-   **å¼‚è´¨æ€§ï¼ˆCochranâ€™s Qï¼‰** Q â‰ˆ 342ï¼Œdf â‰ˆ 122ï¼Œp \\< 1e-22 â†’ å¼‚è´¨æ€§éå¸¸æ˜¾è‘—ï¼Œè¯´æ˜ä¸åŒ SNP çš„æ•ˆåº”å·®å¼‚è¾ƒå¤§ï¼Œå¯èƒ½å­˜åœ¨å¤šæ•ˆæ€§æˆ–æµ‹é‡è¯¯å·®ã€‚\n\n-   **Egger æˆªè·** æˆªè· â‰ˆ 0.00025ï¼Œp = 0.923 â†’ æ²¡æœ‰æ–¹å‘æ€§æ°´å¹³å¤šæ•ˆæ€§çš„è¯æ®ï¼ˆå³å¹³å‡æ•ˆåº”ä¸åç§»ï¼‰ã€‚\n\n**è§£è¯»**ï¼šè™½ç„¶å­˜åœ¨è¾ƒå¼ºå¼‚è´¨æ€§ï¼Œä½†æ²¡æœ‰å‘ç°æ–¹å‘æ€§å¤šæ•ˆæ€§ã€‚è¯´æ˜å¯èƒ½å­˜åœ¨â€œå¹³è¡¡å‹å¤šæ•ˆæ€§â€ï¼ŒIVW ç»“æœä»å¯è§£é‡Šï¼›åŠ æƒä¸­ä½æ•°çš„ç¨³å¥æ€§è¿›ä¸€æ­¥æ”¯æŒç»“è®ºã€‚\n\n## ä¸‰ã€æ–¹å‘æ€§æ£€éªŒï¼ˆSteigerï¼‰\n\n-   Steiger æ£€éªŒç”¨äºåˆ¤æ–­å› æœæ–¹å‘æ˜¯å¦ä¸º **è„‘å¹²ä½“ç§¯ â†’ æŠ‘éƒç—‡**ã€‚\n\n-   è¿è¡Œä¸­å‡ºç°äº†æ•°æ®è¡Œæ•°ä¸åŒ¹é…çš„æç¤ºï¼Œéœ€è¦åœ¨æ•°æ®ä¸­æ·»åŠ å…ƒä¿¡æ¯ï¼ˆ`add_metadata()`ï¼‰åå†è¿è¡Œã€‚\n\n-   å¦‚æœ Steiger è¿‡æ»¤åç»“æœä»ç„¶æ˜¾ç¤ºè´Ÿæ•ˆåº”å¹¶æ˜¾è‘—ï¼Œå°±æ›´èƒ½æ”¯æŒå› æœæ–¹å‘æ­£ç¡®ã€‚\n\n## å››ã€å¯è§†åŒ–ç»“æœ\n\n-   **æ•£ç‚¹å›¾**ï¼šæ˜¾ç¤ºå„æ–¹æ³•çš„å›å½’çº¿ï¼ŒIVW ä¸åŠ æƒä¸­ä½æ•°çº¿å‡ä¸ºè´Ÿæ–œç‡ã€‚\n\n-   **ç•™ä¸€æ³•åˆ†æ**ï¼šç§»é™¤ä»»ä¸€ SNP åç»“æœç¨³å®šï¼Œè¯´æ˜ç»“è®ºä¸ä¾èµ–å•ä¸ªå·¥å…·ã€‚\n\n-   **æ£®æ—å›¾**ï¼šå• SNP æ•ˆåº”æ–¹å‘å¤§ä½“ä¸€è‡´ï¼Œä½†æœ‰å°‘æ•° SNP æ•ˆåº”å·®å¼‚è¾ƒå¤§ã€‚\n\n-   **æ¼æ–—å›¾**ï¼šæ•´ä½“å¯¹ç§°æ€§è¾ƒå¥½ï¼Œæœªè§æ˜æ˜¾å°æ ·æœ¬åå€šã€‚\n\n## äº”ã€MR ä¸‰å¤§å‡è®¾æ˜¯å¦æ»¡è¶³\n\n1.  **ç›¸å…³æ€§ï¼ˆRelevanceï¼‰**\n\n    -   å·¥å…· SNP ä¸è„‘å¹²ä½“ç§¯æ˜¾è‘—ç›¸å…³ï¼ˆp \\< 1e-5ï¼Œå·² clump å»é™¤ LDï¼‰ã€‚\n\n    -   è¯´æ˜ç›¸å…³æ€§å‡è®¾æˆç«‹ã€‚\n\n2.  **ç‹¬ç«‹æ€§ï¼ˆIndependenceï¼‰**\n\n    -   å·¥å…· SNP ä¸æ··æ‚å› ç´ ç‹¬ç«‹ã€‚GWAS å·²æ ¡æ­£ç¾¤ä½“ç»“æ„ï¼Œclumping å‡å°‘ LDã€‚\n\n    -   æ— æ³•å®Œå…¨è¯æ˜ï¼Œä½†ä¸€èˆ¬è®¤ä¸ºåˆç†ã€‚\n\n3.  **æ’ä»–æ€§ï¼ˆExclusion restrictionï¼‰**\n\n    -   å·¥å…· SNP ä»…é€šè¿‡è„‘å¹²ä½“ç§¯å½±å“æŠ‘éƒã€‚\n\n    -   Egger æˆªè·ä¸æ˜¾è‘—ï¼Œè¯´æ˜æ²¡æœ‰æ–¹å‘æ€§æ°´å¹³å¤šæ•ˆæ€§ã€‚\n\n    -   å¼‚è´¨æ€§æ˜¾è‘—ï¼Œæç¤ºå¯èƒ½å­˜åœ¨å¹³è¡¡å‹å¤šæ•ˆæ€§ï¼Œä½†åŠ æƒä¸­ä½æ•°ç»“æœä»ç¨³å¥ã€‚\n\n    -   æ•´ä½“ä¸Šè¯¥å‡è®¾åŸºæœ¬æˆç«‹ã€‚\n\n## å…­ã€æ€»ä½“ç»“è®º\n\n-   **ä¸»è¦å‘ç°**ï¼šè„‘å¹²æ€»ä½“ä½“ç§¯å¢åŠ ä¸æŠ‘éƒç—‡é£é™©é™ä½å­˜åœ¨å› æœå…³è”ã€‚\n\n-   **ç¨³å¥æ€§**ï¼šIVW ä¸åŠ æƒä¸­ä½æ•°ç»“æœä¸€è‡´ï¼ŒEgger æˆªè·ä¸æ˜¾è‘—ï¼Œç•™ä¸€æ³•åˆ†æç¨³å®šã€‚\n\n-   **æ³¨æ„äº‹é¡¹**ï¼šå¼‚è´¨æ€§è¾ƒé«˜ï¼Œæç¤ºå¯èƒ½å­˜åœ¨å¤šæ•ˆæ€§æˆ–å·¥å…·æ•ˆåº”å·®å¼‚ï¼Œéœ€è¦è¿›ä¸€æ­¥æ•æ„Ÿæ€§åˆ†æï¼ˆå¦‚æ›´ä¸¥æ ¼çš„ p é˜ˆå€¼ã€MR-PRESSOï¼‰ã€‚\n\n-   **æ–¹å‘æ€§**ï¼šéœ€è¡¥å…… Steiger æ£€éªŒç¡®è®¤å› æœæ–¹å‘ã€‚Steiger æ£€éªŒéœ€è¦çŸ¥é“æ¯ä¸ª GWAS çš„ **æ ·æœ¬é‡ (sample size)** å’Œ **æ•ˆåº”å€¼ (beta, se, maf)** æ¥è®¡ç®—æ–¹å·®è§£é‡Šåº¦.\n\n------------------------------------------------------------------------\n\nä¸¤ä¸ªæ–‡ä»¶éƒ½æ˜¯ **åˆ¶è¡¨ç¬¦åˆ†éš”çš„æ–‡æœ¬æ–‡ä»¶** (`.txt`)ï¼Œ\n\n### R ä»£ç ç¤ºä¾‹\n\n```r\n# è®¾ç½®å·¥ä½œç›®å½•\nsetwd(\"E:/acode/homwwork/data3\")\n\n# è¯»å– eQTL æ–‡ä»¶\neqtl <- read.table(\"eQTL.txt\", header = TRUE, sep = \"\\t\", stringsAsFactors = FALSE)\n\n# è¯»å– GWAS æ–‡ä»¶\ngwas <- read.table(\"GWAS_EUR_atrial fibrillation_chr6.txt\", header = TRUE, sep = \"\\t\", stringsAsFactors = FALSE)\n\n# æŸ¥çœ‹å‰å‡ è¡Œå’Œåˆ—å\nhead(eqtl)\ncolnames(eqtl)\n\nhead(gwas)\ncolnames(gwas)\n```\n\n``` r\n+ head(eqtl)\n+ colnames(eqtl)\n+ \n+ head(gwas)\n+ colnames(gwas)\n            gene_id     gene_name gene_chr gene_start gene_end\n1 ENSG00000227232.5        WASH7P     chr1      14410    29553\n2 ENSG00000240361.1       OR4G11P     chr1      62948    63887\n3 ENSG00000186092.4         OR4F5     chr1      69091    70008\n4 ENSG00000268903.1 RP11-34P13.15     chr1     135141   135895\n5 ENSG00000269981.1 RP11-34P13.16     chr1     137682   137965\n6 ENSG00000279457.4 RP11-34P13.18     chr1     185217   195411\n  strand num_var beta_shape1 beta_shape2 true_df pval_true_df\n1      -    1364     1.01157     280.800 282.379  8.38906e-07\n2      +    1520     1.01235     326.604 289.739  3.59265e-03\n3      +    1541     1.01869     326.003 287.455  9.05523e-05\n4      -    1863     1.03811     353.346 282.101  6.61052e-04\n5      -    1868     1.05087     334.272 277.796  2.78135e-04\n6      -    2234     1.04471     378.207 275.991  3.42677e-04\n            variant_id tss_distance  chr variant_pos ref alt\n1  chr1_665098_G_A_b38       635545 chr1      665098   G   A\n2  chr1_665098_G_A_b38       602150 chr1      665098   G   A\n3  chr1_807641_T_C_b38       738550 chr1      807641   T   C\n4  chr1_986007_G_A_b38       850112 chr1      986007   G   A\n5 chr1_1028281_C_T_b38       890316 chr1     1028281   C   T\n6  chr1_665098_G_A_b38       469687 chr1      665098   G   A\n  num_alt_per_site rs_id_dbSNP151_GRCh38p7 minor_allele_samples\n1                1             rs114979547                   91\n2                1             rs114979547                   91\n3                1               rs3964475                  171\n4                1             rs115014500                    8\n5                1              rs13303147                   28\n6                1             rs114979547                   91\n  minor_allele_count       maf ref_factor pval_nominal\n1                 94 0.1217620          1  1.87224e-07\n2                 94 0.1217620          1  2.35641e-03\n3                195 0.2525910          1  4.04856e-05\n4                  8 0.0103627          1  3.12900e-04\n5                 29 0.0375648          1  1.05679e-04\n6                 94 0.1217620          1  1.27160e-04\n      slope  slope_se  pval_perm   pval_beta        qval\n1  0.403338 0.0756735 0.00029997 0.000212786 0.000311193\n2 -0.259344 0.0845860 0.69273400 0.686484000 0.286310000\n3  0.291123 0.0699246 0.02639740 0.027016300 0.025012700\n4 -0.900366 0.2470360 0.19635200 0.193477000 0.120630000\n5 -0.587608 0.1496360 0.07449260 0.076866200 0.059863200\n6  0.340850 0.0878486 0.10648900 0.108665000 0.078511000\n  pval_nominal_threshold  log2_aFC log2_aFC_lower\n1            0.000235891  0.697958       0.513705\n2            0.000203324 -0.775033      -1.281557\n3            0.000207882  0.932644       0.649848\n4            0.000203850 -6.643856      -6.643856\n5            0.000224046 -1.615290      -6.094829\n6            0.000194351  0.401163       0.248050\n  log2_aFC_upper\n1       0.873141\n2      -0.473808\n3       1.331262\n4      -6.643856\n5      -1.119854\n6       0.612973\n [1] \"gene_id\"                 \"gene_name\"              \n [3] \"gene_chr\"                \"gene_start\"             \n [5] \"gene_end\"                \"strand\"                 \n [7] \"num_var\"                 \"beta_shape1\"            \n [9] \"beta_shape2\"             \"true_df\"                \n[11] \"pval_true_df\"            \"variant_id\"             \n[13] \"tss_distance\"            \"chr\"                    \n[15] \"variant_pos\"             \"ref\"                    \n[17] \"alt\"                     \"num_alt_per_site\"       \n[19] \"rs_id_dbSNP151_GRCh38p7\" \"minor_allele_samples\"   \n[21] \"minor_allele_count\"      \"maf\"                    \n[23] \"ref_factor\"              \"pval_nominal\"           \n[25] \"slope\"                   \"slope_se\"               \n[27] \"pval_perm\"               \"pval_beta\"              \n[29] \"qval\"                    \"pval_nominal_threshold\" \n[31] \"log2_aFC\"                \"log2_aFC_lower\"         \n[33] \"log2_aFC_upper\"         \n  chromosome base_pair_location effect_allele other_allele\n1          6          139325608             t            c\n2          6          132527427             t            g\n3          6           12945597             t            c\n4          6          154485321             t            c\n5          6           32636331             t            c\n6          6          168094046             t            c\n     beta standard_error effect_allele_frequency p_value\n1  0.2324         0.3667                  0.0003  0.5262\n2 -0.2293         0.2968                  0.0002  0.4399\n3  0.1782         0.4510                  0.0002  0.6928\n4 -0.0131         0.0202                  0.9867  0.5173\n5 -0.0068         0.0046                  0.6868  0.1398\n6 -0.0820         0.0973                  0.9994  0.3992\n        rs_id       n\n1 rs540184302  444676\n2              316342\n3 rs115357758  444676\n4  rs78948046 1840340\n5   rs9272319 1840340\n6 rs115699353 1079770\n [1] \"chromosome\"              \"base_pair_location\"     \n [3] \"effect_allele\"           \"other_allele\"           \n [5] \"beta\"                    \"standard_error\"         \n [7] \"effect_allele_frequency\" \"p_value\"                \n [9] \"rs_id\"  \n```\n\n## ğŸ§¾ æ•°æ®æ ¼å¼æ€»ç»“\n\n-   **GWAS æ–‡ä»¶ (**`GWAS_EUR_atrial fibrillation_chr6.txt`**)**\n\n    -   å…³é”®åˆ—ï¼š`chromosome`, `base_pair_location`, `rs_id`, `beta`, `standard_error`, `effect_allele_frequency`, `p_value`\n\n    -   ç”¨äºå®šä½æ˜¾è‘— SNP åŠå…¶æ•ˆåº”å€¼ã€‚\n\n-   **eQTL æ–‡ä»¶ (**`eQTL.txt`**)**\n\n    -   å…³é”®åˆ—ï¼š`gene_id`, `gene_name`, `chr`, `variant_pos`, `rs_id_dbSNP151_GRCh38p7`, `maf`, `pval_nominal`, `slope`, `slope_se`\n\n    -   ç”¨äºåŸºå› è¡¨è¾¾è°ƒæ§ä¿¡å·ã€‚\n\n## ğŸ§¬ åˆ†ææ­¥éª¤\n\n### 1. ç¡®è®¤ GWAS æ˜¾è‘—ä½ç‚¹\n\n```r\n# è¯»å– GWAS æ–‡ä»¶\ngwas <- read.table(\"E:/acode/homwwork/data3/GWAS_EUR_atrial fibrillation_chr6.txt\", \n                   header = TRUE, sep = \"\\t\", stringsAsFactors = FALSE)\n\n# æŸ¥çœ‹ rs7742789 çš„ä¿¡æ¯\ngwas[gwas$rs_id == \"rs7742789\", ]\n```\n\n### \n\n### 1. ç¡®è®¤ GWAS ä½ç‚¹åæ ‡\n\n```r\ngwas[gwas$rs_id == \"rs7742789\", c(\"chromosome\",\"base_pair_location\")]\n```\n\nğŸ‘‰ æ‰“å°å‡º rs7742789 çš„åæ ‡ã€‚\n\n``` r\n       nsnps    PP.H0.abf    PP.H1.abf    PP.H2.abf \n1.000000e+00 1.606210e-05 1.986290e-02 7.925723e-07 \n   PP.H3.abf    PP.H4.abf \n0.000000e+00 9.801202e-01 \n> gwas[gwas$rs_id == \"rs7742789\", c(\"chromosome\",\"base_pair_location\")]\n        chromosome base_pair_location\n1220693          6           43378065\n```\n\n### 2. æŸ¥çœ‹ eQTL æ–‡ä»¶æ˜¯å¦è¦†ç›–è¯¥æŸ“è‰²ä½“èŒƒå›´\n\n```r\neqtl_chr6 <- eqtl %>% filter(chr == \"chr6\")\nrange(eqtl_chr6$variant_pos)\n \n```\n\n``` r\n\n[1]    348124 170578141\n```\n\nğŸ‘‰ çœ‹çœ‹ eQTL æ–‡ä»¶çš„ chr6 SNP èŒƒå›´ï¼Œæ˜¯å¦åŒ…å« rs7742789 çš„ä½ç½®ã€‚\n\n### 3. ç›´æ¥æœç´¢ rs7742789 æ˜¯å¦å­˜åœ¨äº eQTL\n\n```r\neqtl[eqtl$rs_id_dbSNP151_GRCh38p7 == \"rs7742789\", ] \n```\n\n``` r\n[1]    348124 170578141\n> eqtl[eqtl$rs_id_dbSNP151_GRCh38p7 == \"rs7742789\", ] \n                gene_id gene_name gene_chr gene_start gene_end\n7011 ENSG00000124574.14    ABCC10     chr6   43427366 43450351\n     strand num_var beta_shape1 beta_shape2 true_df\n7011      +    6441     1.04838     1006.43 283.659\n     pval_true_df            variant_id tss_distance  chr\n7011  2.96772e-05 chr6_43378065_C_T_b38       -49301 chr6\n     variant_pos ref alt num_alt_per_site\n7011    43378065   C   T                1\n     rs_id_dbSNP151_GRCh38p7 minor_allele_samples\n7011               rs7742789                  207\n     minor_allele_count      maf ref_factor pval_nominal\n7011                256 0.331606          1  1.04352e-05\n         slope  slope_se pval_perm pval_beta      qval\n7011 -0.139377 0.0311093 0.0233977 0.0243006 0.0228507\n     pval_nominal_threshold  log2_aFC log2_aFC_lower\n7011            7.38637e-05 -0.089235      -0.114012\n     log2_aFC_upper\n7011      -0.051075\n```\n\nå·²ç»ç¡®è®¤äº† **rs7742789** åœ¨ GWAS å’Œ eQTL æ–‡ä»¶é‡Œéƒ½å­˜åœ¨ï¼Œè€Œä¸”åæ ‡å®Œå…¨ä¸€è‡´ (`chr6:43378065`)ã€‚\n\n## âœ… ä¸‹ä¸€æ­¥æ“ä½œ\n\næˆ‘ä»¬å¯ä»¥åˆ†æˆå‡ ä¸ªå°æ­¥éª¤æ¥æ„å»ºè¾“å…¥å¹¶è¿è¡Œ colocï¼š\n\n### 1. æå– GWAS SNP ä¿¡æ¯\n\n```r\ngwas_snp <- gwas %>%\n  filter(rs_id == \"rs7742789\") %>%\n  mutate(effect_allele_frequency = as.numeric(effect_allele_frequency)) %>%\n  filter(!is.na(effect_allele_frequency),\n         effect_allele_frequency > 0,\n         effect_allele_frequency < 1)\n\ngwas_snp\n\n```\n\n``` r\n  chromosome base_pair_location effect_allele other_allele\n1          6           43378065             t            c\n    beta standard_error effect_allele_frequency   p_value\n1 0.0241         0.0037                  0.2993 1.124e-10\n      rs_id       n\n1 rs7742789 1840340\n```\n\n### 2. æå– eQTL SNP ä¿¡æ¯\n\n```r\neqtl_snp <- eqtl %>%\n  filter(rs_id_dbSNP151_GRCh38p7 == \"rs7742789\") %>%\n  mutate(maf = as.numeric(maf)) %>%\n  filter(!is.na(maf), maf > 0, maf < 1)\n\neqtl_snp\n\n```\n\n```r\n            gene_id gene_name gene_chr gene_start gene_end\n1 ENSG00000124574.14    ABCC10     chr6   43427366 43450351\n  strand num_var beta_shape1 beta_shape2 true_df pval_true_df\n1      +    6441     1.04838     1006.43 283.659  2.96772e-05\n             variant_id tss_distance  chr variant_pos ref alt\n1 chr6_43378065_C_T_b38       -49301 chr6    43378065   C   T\n  num_alt_per_site rs_id_dbSNP151_GRCh38p7 minor_allele_samples\n1                1               rs7742789                  207\n  minor_allele_count      maf ref_factor pval_nominal     slope\n1                256 0.331606          1  1.04352e-05 -0.139377\n   slope_se pval_perm pval_beta      qval\n1 0.0311093 0.0233977 0.0243006 0.0228507\n  pval_nominal_threshold  log2_aFC log2_aFC_lower\n1            7.38637e-05 -0.089235      -0.114012\n  log2_aFC_upper\n1      -0.051075\n```\n\n### 3. æ„å»º coloc è¾“å…¥\n\n```r\nlibrary(coloc)\n\n# GWAS è¾“å…¥\ngwas_input <- list(\n  beta = gwas_snp$beta,\n  varbeta = gwas_snp$standard_error^2,\n  snp = gwas_snp$rs_id,\n  MAF = gwas_snp$effect_allele_frequency,\n  N = gwas_snp$n,\n  type = \"quant\"\n)\n\n# eQTL è¾“å…¥\neqtl_input <- list(\n  beta = eqtl_snp$slope,\n  varbeta = eqtl_snp$slope_se^2,\n  snp = eqtl_snp$rs_id_dbSNP151_GRCh38p7,\n  MAF = eqtl_snp$maf,\n  N = 207,   # è¿™é‡Œç”¨ eQTL æ–‡ä»¶é‡Œçš„ minor_allele_samples è¿‘ä¼¼ä»£æ›¿æ€»æ ·æœ¬é‡\n  type = \"quant\"\n)\n\n```\n\n### 4. è¿è¡Œ coloc\n\n```r\nres <- coloc.abf(dataset1 = gwas_input, dataset2 = eqtl_input) \nprint(res$summary) \n```\n\n``` r\n       nsnps    PP.H0.abf    PP.H1.abf    PP.H2.abf \n1.000000e+00 1.606210e-05 1.986290e-02 7.925723e-07 \n   PP.H3.abf    PP.H4.abf \n0.000000e+00 9.801202e-01 \n```\n\n## ğŸ“Š coloc è¾“å‡ºç»“æœ\n\n-   **nsnps = 1** â†’ è¯´æ˜åœ¨è¾“å…¥çš„æ•°æ®é‡Œï¼ŒGWAS å’Œ eQTL åªæœ‰ä¸€ä¸ªäº¤é›† SNPï¼ˆå°±æ˜¯ rs7742789ï¼‰ã€‚\n\n-   **PP.H0.abf = 1.6e-05** â†’ æ— å…³è”çš„æ¦‚ç‡ï¼Œéå¸¸ä½ã€‚\n\n-   **PP.H1.abf = 0.0199 (\\~2%)** â†’ ä»… GWAS å…³è”çš„æ¦‚ç‡ã€‚\n\n-   **PP.H2.abf = 7.9e-07 (\\~0%)** â†’ ä»… eQTL å…³è”çš„æ¦‚ç‡ã€‚\n\n-   **PP.H3.abf = 0** â†’ ä¸¤è€…å…³è”ä½†ä¸åŒå› æœå˜å¼‚çš„æ¦‚ç‡ã€‚\n\n-   **PP.H4.abf = 0.980 (\\~98%)** â†’ ä¸¤è€…å…±å®šä½çš„æ¦‚ç‡ï¼Œéå¸¸é«˜ã€‚\n\n## âœ… ç»“æœè§£è¯»\n\n-   æˆ‘ä»¬çš„åˆ†æè¡¨æ˜ï¼š**rs7742789 çš„ GWAS ä¿¡å·ä¸ ABCC10 åŸºå› çš„ eQTL ä¿¡å·é«˜åº¦å…±å®šä½**ã€‚\n\n-   PP4 æ¥è¿‘ 1ï¼Œè¯´æ˜å‡ ä¹å¯ä»¥ç¡®å®šè¿™ä¸ª GWAS ä½ç‚¹çš„åŠŸèƒ½è§£é‡Šå°±æ˜¯é€šè¿‡å½±å“ **ABCC10 åŸºå› çš„è¡¨è¾¾**ã€‚\n\n-   è¿™æ˜¯ä¸€ç§å¼ºæœ‰åŠ›çš„è¯æ®ï¼Œæç¤º ABCC10 å¯èƒ½å‚ä¸æˆ¿é¢¤çš„é—ä¼ æœºåˆ¶ã€‚\n\n",
    "supporting": [
      "alast_files"
    ],
    "filters": []
  }
}