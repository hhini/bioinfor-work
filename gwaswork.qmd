---
title: åŒ»ç–—å¤§æ•°æ®ä½œä¸š
authors:
  - name: å‘¨æ° 113120230073
    affiliation: The GanNan medical University 
    roles: writing
    corresponding: true
bibliography: references.bib
---

**æˆ‘ä»¬ç»™å‡ºçš„å››ä¸ªæ•°æ®ï¼ˆ`GWAS_EUR_atrial fibrillation_chr1.txt`, `GWAS_EUR_atrial fibrillation_chr2.txt`, `eQTL_chr1.txt`, `eQTL_chr2.txt`ï¼‰å®Œå…¨å¯ä»¥å¾—åˆ°è¦çš„å…±å®šä½ï¼ˆcolocalizationï¼‰åˆ†æç»“æœâ€”â€”ä¹Ÿå°±æ˜¯ H4 çš„åéªŒæ¦‚ç‡ï¼ˆPP.H4ï¼‰ä¸æ˜¯å¦å…±å®šä½çš„ç»“è®ºã€‚**

------------------------------------------------------------------------

## ğŸ”¬ ä¸€ã€å¾—åˆ°ç»“æœ

æä¾›çš„å››ä¸ªæ–‡ä»¶å…¶å®æ­£å¥½å¯¹åº” `coloc.abf()` æ‰€éœ€çš„ä¸¤ç±»æ€§çŠ¶ï¼š

-   **GWASï¼š** æŸ“è‰²ä½“ 1ã€2 çš„ç–¾ç—…å…³è”æ±‡æ€»ç»Ÿè®¡ï¼ˆatrial fibrillationï¼‰ã€‚
-   **eQTLï¼š** åŒæŸ“è‰²ä½“ä¸ŠåŸºå› è¡¨è¾¾å…³è”ç»“æœã€‚

> è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªæŸ“è‰²ä½“ä¸Šè¿›è¡Œæˆå¯¹æ¯”è¾ƒï¼š
>
> -   `GWAS_chr1.txt` å¯¹ `eQTL_chr1.txt`
> -   `GWAS_chr2.txt` å¯¹ `eQTL_chr2.txt`

ç„¶åé’ˆå¯¹æ¯ä¸ªè®¤é¢†çš„ lead SNPï¼ˆä» kdocs ä¸Šé€‰å‡ºæˆ–ä» GWAS æ–‡ä»¶ä¸­è¿‡æ»¤ p \< 5eâˆ’8 çš„æ˜¾è‘— SNPï¼‰ï¼Œ åœ¨è¯¥ SNP ä¸Šä¸‹æ¸¸ 500 kb å†…æå–åŒºåŸŸï¼ŒåŒ¹é…ä¸¤ç§æ•°æ®çš„ç›¸åŒ SNPï¼ˆrsid æˆ– chr:posï¼‰ï¼Œ å†è¾“å…¥ `coloc.abf()`ï¼Œè®¡ç®— PP.H0â€“PP.H4ï¼Œç‰¹åˆ«å…³æ³¨ `PP.H4`ï¼ˆå…±å®šä½æ¦‚ç‡ï¼‰ã€‚

------------------------------------------------------------------------

## ğŸ§  äºŒã€ç†è®ºä¸Šèƒ½å¦å¾—åˆ°â€œå¯é çš„â€ç»“æœå–å†³äºæ–‡ä»¶ä¸­æ˜¯å¦å«å¿…è¦å‚æ•°

è¦å¾—åˆ°**å¯è§£é‡Šçš„ã€å¯å‘è¡¨çš„ç»“æœ**ï¼Œéœ€è¦è¿™å‡ ä¸ªå­—æ®µï¼ˆ`coloc` çš„æœ€å°è¦æ±‚ï¼‰ï¼š

| å­—æ®µ | è¯´æ˜ | æ–‡ä»¶ä¸­è‹¥å­˜åœ¨ï¼Œåˆ™ âœ… |
|------------------------|------------------------------|------------------|
| `SNP` æˆ– `rsid` | å˜å¼‚åç§°ï¼Œç”¨äºåŒ¹é… GWAS ä¸ eQTL | âœ… å¿…è¦ |
| `chr`, `pos` | æŸ“è‰²ä½“ä¸ä½ç½®ï¼ˆä¾¿äº Â±500 kb æˆªå–ï¼‰ | âœ… å¿…è¦ |
| `beta` æˆ– `logOR` | æ•ˆåº”å€¼ | âœ… æ¨è |
| `se` æˆ– `varbeta` | æ•ˆåº”å€¼æ ‡å‡†è¯¯æˆ–æ–¹å·® | âœ… æ¨è |
| `p` | p å€¼ï¼ˆè‹¥æ—  betaï¼Œå¯ç”¨äºåæ¨ï¼‰ | å¯æ›¿ä»£é¡¹ |
| `MAF` | æ¬¡è¦ç­‰ä½åŸºå› é¢‘ç‡ï¼ˆminor allele frequencyï¼‰ | æ¨è |
| `N` | æ ·æœ¬é‡ | æ¨è |
| `Ncases`, `Ncontrols`ï¼ˆä»… GWASï¼‰ | ç—…ä¾‹ä¸å¯¹ç…§æ•°ï¼Œç”¨äºè®¡ç®— sï¼ˆç—…ä¾‹æ¯”ä¾‹ï¼‰ | æ¨è |
| `type` | æ€§çŠ¶ç±»å‹ï¼šGWAS æ˜¯ `"cc"`ï¼ŒeQTL æ˜¯ `"quant"` | åœ¨ä»£ç ä¸­è®¾å®š |

ğŸ‘‰ å¦‚æœè¿™äº›å­—æ®µå­˜åœ¨ï¼ˆæˆ–è€…æˆ‘ä»¬èƒ½ä»å·²æœ‰ä¿¡æ¯æ¨å¯¼ï¼‰ï¼Œå°±**èƒ½å¾—åˆ° H4 æ¦‚ç‡ä¸ç»“è®º**ã€‚

------------------------------------------------------------------------


------------------------------------------------------------------------

## ğŸ§© ç¬¬ä¸€éƒ¨åˆ†ï¼šè¦å¹²ä»€ä¹ˆï¼ˆç›®æ ‡ã€åŸç†ã€ä¸ºä»€ä¹ˆè¿™æ ·åšï¼‰

### ğŸ¯ ç›®æ ‡ï¼š

æˆ‘ä»¬è¦åšçš„æ˜¯ä¸€ç§å« **å…±å®šä½åˆ†æï¼ˆcolocalization analysisï¼‰** çš„ç»Ÿè®¡æ–¹æ³•ã€‚ ç›®çš„æ˜¯ï¼šåˆ¤æ–­æŸä¸ª **ç–¾ç—… GWAS ä¿¡å·**ï¼ˆä¾‹å¦‚æˆ¿é¢¤çš„æ˜¾è‘— SNPï¼‰ å’ŒæŸä¸ª **eQTL ä¿¡å·**ï¼ˆæŸä¸ªåŸºå› çš„è¡¨è¾¾è°ƒæ§ SNPï¼‰ æ˜¯ä¸æ˜¯ **åŒä¸€ä¸ªå› æœå˜å¼‚ï¼ˆcausal variantï¼‰** å¼•èµ·çš„ã€‚

æ¢å¥è¯è¯´ï¼Œè¦å›ç­”çš„é—®é¢˜æ˜¯ï¼š

> â€œè¿™ä¸ªæ˜¾è‘— GWAS ä¿¡å·ï¼ˆå¯¼è‡´ç–¾ç—…çš„å˜å¼‚ï¼‰ï¼Œ æ˜¯å¦ä¹Ÿæ˜¯è°ƒæ§è¯¥åŸºå› è¡¨è¾¾çš„å˜å¼‚ï¼Ÿâ€

------------------------------------------------------------------------

### ğŸ§¬ ä¸ºä»€ä¹ˆè¿™æ ·åšï¼š

-   GWAS åªèƒ½å‘Šè¯‰æˆ‘ä»¬â€œæŸä¸ªä½ç½®â€ä¸ç–¾ç—…æœ‰å…³ï¼Œ ä½†ä¸èƒ½å‘Šè¯‰æˆ‘ä»¬å®ƒå½±å“äº†å“ªä¸ªåŸºå› ã€‚
-   eQTL åˆ†æå‘Šè¯‰æˆ‘ä»¬â€œå“ªä¸ªå˜å¼‚å½±å“äº†å“ªä¸ªåŸºå› çš„è¡¨è¾¾â€ã€‚ æ‰€ä»¥æˆ‘ä»¬æŠŠ GWAS å’Œ eQTL çš„ä¿¡å·æ”¾åœ¨ä¸€èµ·æ¯”è¾ƒï¼Œ å¦‚æœå®ƒä»¬çš„**ç»Ÿè®¡ä¿¡å·å³°å€¼é‡åˆ**ï¼Œå¹¶ä¸”è´å¶æ–¯å…±å®šä½åˆ†æè®¤ä¸º **å®ƒä»¬å¯èƒ½ç”±åŒä¸€ä¸ªå› æœå˜å¼‚å¼•èµ·ï¼ˆPP.H4 é«˜ï¼‰**ï¼Œ å°±å¯ä»¥æ¨æµ‹ï¼šè¿™ä¸ªåŸºå› å¯èƒ½æ˜¯ç–¾ç—…çš„åŠŸèƒ½é¶ç‚¹ã€‚

------------------------------------------------------------------------

### ğŸ“ˆ åˆ†æé€»è¾‘ï¼ˆ

è®ºæ–‡çš„æ–¹æ³•æ˜¯ï¼š

1.  åœ¨å…¨åŸºå› ç»„ä¸­æ‰¾å‡º **GWAS æ˜¾è‘— SNP**ï¼ˆP \< 5Ã—10â»â¸ï¼‰ã€‚
2.  ä»¥è¿™ä¸ª lead SNP ä¸ºä¸­å¿ƒï¼Œå– Â±500 kb çš„çª—å£ã€‚
3.  åœ¨ GWAS å’Œ eQTL æ•°æ®ä¸­éƒ½å–å‡ºè¿™ä¸ªçª—å£å†…çš„æ‰€æœ‰ SNPã€‚
4.  ç”¨ R åŒ… **`coloc`** è®¡ç®—å…±å®šä½çš„åéªŒæ¦‚ç‡ï¼ˆposterior probabilityï¼‰ã€‚
5.  æŠŠ `PP.H4 â‰¥ 0.8` å®šä¹‰ä¸º **å¼ºå…±å®šä½è¯æ®ï¼ˆshared causal variantï¼‰**ã€‚

------------------------------------------------------------------------

### ğŸ”¢ å…±å®šä½åˆ†æçš„äº”ä¸ªå‡è®¾æ¨¡å‹ï¼ˆcoloc è¾“å‡ºçš„ç»“æœï¼‰ï¼š

| å‡è®¾ | å«ä¹‰ | ç¬¦å· | è¯´æ˜ |
|----------------|------------------------|----------------|----------------|
| H0 | æ— ä¿¡å· | PP.H0 | è¿™ä¸¤ä¸ª trait éƒ½æ²¡æœ‰å…³è”ä¿¡å· |
| H1 | åªæœ‰ GWAS æœ‰ä¿¡å· | PP.H1 | eQTL æ²¡ä¿¡å· |
| H2 | åªæœ‰ eQTL æœ‰ä¿¡å· | PP.H2 | GWAS æ²¡ä¿¡å· |
| H3 | ä¸¤è€…éƒ½æœ‰ä¿¡å·ï¼Œä½†ä¸æ˜¯åŒä¸€ä¸ª causal SNP | PP.H3 | ä¸¤ä¸ªç‹¬ç«‹ä¿¡å· |
| **H4** | **ä¸¤è€…å…±äº«åŒä¸€ causal SNP** | **PP.H4** | æˆ‘ä»¬æœ€å…³æ³¨çš„æƒ…å†µ |

------------------------------------------------------------------------

### âœ… ç»“è®ºæ ‡å‡†ï¼š

-   `PP.H4 â‰¥ 0.8` â†’ **å¼ºå…±å®šä½è¯æ®**ï¼ˆé«˜åº¦å¯èƒ½æ˜¯åŒä¸€ causal variantï¼‰ï¼›
-   `0.5 â‰¤ PP.H4 < 0.8` â†’ **ä¸­ç­‰è¯æ®**ï¼›
-   `PP.H4 < 0.5` â†’ **æ— æ˜¾è‘—å…±å®šä½**ï¼ˆä¿¡å·ç‹¬ç«‹ï¼‰ã€‚

------------------------------------------------------------------------


------------------------------------------------------------------------

# 1. å…ˆç”¨ `coloc` å†…ç½®ç¤ºä¾‹ `coloc_test_data`ï¼ˆå¿«é€Ÿä¸Šæ‰‹å¹¶ç†è§£è¾“å‡ºæ ¼å¼ï¼‰

ç›®çš„ï¼šç†è§£ `coloc.abf()` æ‰€éœ€çš„æ•°æ®ç»“æ„ã€è¿”å›å€¼ä¸å¦‚ä½•è§£è¯» `PP.H4`ã€‚ 
```r
# demo_coloc_test_data.R
if (!requireNamespace("coloc", quietly=TRUE)) install.packages("coloc")
library(coloc)

# åŠ è½½å†…ç½®ç¤ºä¾‹
data(coloc_test_data)    # è¿”å› list åŒ…å« D1, D2

# æŸ¥çœ‹ç¤ºä¾‹æ•°æ®ç»“æ„ï¼ˆå¿…é¡»å­—æ®µç¤ºä¾‹ï¼‰
str(coloc_test_data$D1)
str(coloc_test_data$D2)

# è¿è¡Œ coloc.abf ç¤ºèŒƒï¼ˆä½¿ç”¨é»˜è®¤å…ˆéªŒ p1=1e-4,p2=1e-4,p12=1e-5ï¼‰
res_demo <- coloc.abf(dataset1 = coloc_test_data$D1, dataset2 = coloc_test_data$D2)

# æŸ¥çœ‹æ±‡æ€»ï¼ˆPP.H0..PP.H4ï¼‰
print(res_demo$summary)

# æ¯ä¸ª SNP çš„ç»“æœï¼ˆå¯ç”¨äºç»˜å›¾ / fine-mappingï¼‰
head(res_demo$results)

# æ‰“å°æˆ‘ä»¬æœ€å…³å¿ƒçš„ PP.H4
cat("ç¤ºä¾‹ PP.H4 =", res_demo$summary["PP.H4"], "\n")
```

è§£é‡Šè¦ç‚¹ï¼š

-   `dataset` å¿…éœ€å­—æ®µç¤ºä¾‹ï¼š`snp`ã€`beta`ã€`varbeta`ï¼ˆæˆ– `se`ï¼‰ ã€`MAF`ã€`N`ã€`type`ï¼ˆ"cc" æˆ– "quant"ï¼‰ï¼›è‹¥ `cc`ï¼Œæœ€å¥½æä¾› `s = proportion of cases`ã€‚
-   `res_demo$summary` è¿”å› `PP.H0`..`PP.H4`ã€‚æˆ‘ä»¬å…³æ³¨ `PP.H4`ï¼ˆè¶Šé«˜è¶Šæ”¯æŒâ€œå…±äº« causalâ€ï¼‰ã€‚
-   è‹¥ `PP.H4 â‰¥ 0.8`ï¼Œé€šå¸¸åˆ¤ä¸ºå¼ºå…±å®šä½è¯æ®ã€‚

``` r
List of 9
 $ beta    : num [1:500] 0.337 0.211 0.257 0.267 0.247 ...
 $ varbeta : num [1:500] 0.01634 0.00532 0.00748 0.01339 0.00664 ...
 $ N       : int 1000
 $ sdY     : num 1.1
 $ type    : chr "quant"
 $ MAF     : num [1:500] 0.031 0.166 0.0925 0.0405 0.118 ...
 $ LD      : num [1:500, 1:500] 1 0.365 0.54 0.851 0.463 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:500] "s1" "s2" "s3" "s4" ...
  .. ..$ : chr [1:500] "s1" "s2" "s3" "s4" ...
 $ snp     : chr [1:500] "s1" "s2" "s3" "s4" ...
 $ position: int [1:500] 1 2 3 4 5 6 7 8 9 10 ...
List of 9
 $ beta    : num [1:500] 0.0926 0.1661 0.1519 0.0342 0.214 ...
 $ varbeta : num [1:500] 0.01403 0.00467 0.00649 0.01151 0.00593 ...
 $ N       : int 1000
 $ sdY     : num 1.02
 $ type    : chr "quant"
 $ MAF     : num [1:500] 0.031 0.166 0.0925 0.0405 0.118 ...
 $ LD      : num [1:500, 1:500] 1 0.365 0.54 0.851 0.463 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:500] "s1" "s2" "s3" "s4" ...
  .. ..$ : chr [1:500] "s1" "s2" "s3" "s4" ...
 $ snp     : chr [1:500] "s1" "s2" "s3" "s4" ...
 $ position: int [1:500] 1 2 3 4 5 6 7 8 9 10 ...
PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf 
 1.38e-18  2.94e-10  8.59e-12  8.34e-04  9.99e-01 
[1] "PP abf for shared variant: 99.9%"
       nsnps    PP.H0.abf    PP.H1.abf    PP.H2.abf    PP.H3.abf    PP.H4.abf 
5.000000e+02 1.377000e-18 2.937336e-10 8.593226e-12 8.338917e-04 9.991661e-01 
   snp position       V.df1    z.df1     r.df1   lABF.df1       V.df2     z.df2
1   s1        1 0.016341447 2.639447 0.6248908  1.6864378 0.014032601 0.7816702
2  s10       10 0.005807310 2.598043 0.8241827  1.9123910 0.005199297 3.5868551
3 s100      100 0.005723488 4.848830 0.8262796  8.8382399 0.005153734 4.4136124
4 s101      101 0.017438359 1.051446 0.6095431 -0.1332818 0.014878202 0.6223266
5 s102      102 0.009349033 3.237779 0.7443671  3.2196718 0.008582962 2.3295057
6 s103      103 0.004846592 7.780900 0.8488730 24.7515880 0.004102488 7.5600021
      r.df2   lABF.df2 internal.sum.lABF    SNP.PP.H4
1 0.6260599 -0.3005660         1.3858719 5.510267e-23
2 0.8187958  4.4130556         6.3254466 7.698439e-21
3 0.8200981  7.1300733        15.9683132 1.186442e-16
4 0.6122635 -0.3551527        -0.4884345 8.456130e-24
5 0.7324238  1.3281089         4.5477807 1.301284e-21
6 0.8513388 23.3755086        48.1270966 1.098066e-02
ç¤ºä¾‹ PP.H4 = NA 
```

------------------------------------------------------------------------

# 2. å‡†å¤‡æˆ‘ä»¬è‡ªå·±çš„æ•°æ®ï¼šè¯»å–ä¸åˆ—åæ ‡å‡†åŒ–ï¼ˆç¤ºä¾‹ä»£ç  + è§£é‡Šï¼‰

ç›®æ ‡ï¼šæŠŠæˆ‘ä»¬æ”¾åœ¨ `E:/acode/homwwork/data2` çš„å››ä¸ªæ–‡ä»¶è¯»å…¥å¹¶æŠŠå¸¸è§åˆ—åæ ‡å‡†åŒ–æˆ `snp, chr, pos, effect_allele, other_allele, beta, se, p, maf, n, ncases(optional)`ã€‚å¦‚æœåˆ—åä¸åŒï¼Œè„šæœ¬ä¼šå°è¯•æ˜ å°„å¸¸è§æ›¿ä»£åã€‚

```r
# step0_read_and_standardize.R
# ä¾èµ–åŒ…
required <- c("data.table","dplyr")
for (pkg in required) if (!requireNamespace(pkg, quietly=TRUE)) install.packages(pkg)
library(data.table); library(dplyr)

# æ–‡ä»¶è·¯å¾„ï¼ˆåœ¨æœ¬åœ°è¿è¡Œæ—¶æŒ‰éœ€ä¿®æ”¹ï¼›å¦‚æœæˆ‘ä»¬æƒ³è®©æˆ‘è¿œç«¯è¿è¡Œï¼Œè¯·ä¸Šä¼ æ–‡ä»¶ï¼‰
base_dir <- "E:/acode/homwwork/data2"
gwas1_file <- file.path(base_dir, "GWAS_EUR_atrial fibrillation_chr1.txt")
gwas2_file <- file.path(base_dir, "GWAS_EUR_atrial fibrillation_chr2.txt")
eqtl1_file <- file.path(base_dir, "eQTL_chr1.txt")
eqtl2_file <- file.path(base_dir, "eQTL_chr2.txt")
```

```r
# è¯»å–å‡½æ•°ï¼ˆç»Ÿä¸€å°å†™åˆ—åï¼‰
read_and_lower <- function(path){
  if(!file.exists(path)) stop(paste("File not found:", path))
  df <- fread(path, data.table = FALSE)
  names(df) <- tolower(names(df))
  return(df)
}

gwas1 <- read_and_lower(gwas1_file)
gwas2 <- read_and_lower(gwas2_file)
eqtl1 <- read_and_lower(eqtl1_file)
eqtl2 <- read_and_lower(eqtl2_file)
```

```r
# ç®€å•åˆ—åæ˜ å°„å‡½æ•°ï¼ˆæ ¹æ®å¸¸è§åˆ«åé‡å‘½åï¼‰
standardize_cols <- function(df){
  cn <- names(df)
  # æ˜ å°„å­—å…¸ï¼šæŠŠå¸¸è§å˜ä½“æ˜ å°„åˆ°æœŸæœ›å
  map_list <- list(
    snp = c("snp","rsid","rs_id","variant", "rs_id_dbsnp151_grch38p7"), # <- æ·»åŠ äº† eqtl1 çš„ rs_id
    chr = c("chr","chromosome"),
    pos = c("pos","position","bp", "base_pair_location", "variant_pos"), # <- æ·»åŠ äº† gwas1 å’Œ eqtl1 çš„ pos
    effect_allele = c("effect_allele","a1","allele1","alt"),
    other_allele = c("other_allele","a2","allele2","ref"),
    beta = c("beta","effect","log_or","est","slope"),
    or = c("or","odds_ratio"),
    se = c("se","stderr","std_err", "standard_error"), # <- æ·»åŠ äº† gwas1 çš„ se
    p = c("p","pvalue","p_value","pval_nominal"),
    maf = c("maf","a1_freq","freq", "effect_allele_frequency"), # <- æ·»åŠ äº† gwas1 çš„ maf
    n = c("n","sample_size","samplesize"),
    ncases = c("ncases","cases")
  )
  
  for (std in names(map_list)) {
    for (alt in map_list[[std]]) {
      if (alt %in% cn) {
        # ç¡®ä¿åªé‡å‘½ååŒ¹é…åˆ°çš„é‚£ä¸€ä¸ªåˆ—
        names(df)[names(df) == alt] <- std
        # ä¸€æ—¦æ‰¾åˆ°åŒ¹é…ï¼Œå°±è·³å‡ºå†…å±‚å¾ªç¯ï¼Œé¿å…åŒä¸€ç›®æ ‡åˆ—è¢«å¤šä¸ªåˆ«åè¦†ç›–
        break 
      }
    }
  }
  
  # å¦‚æœåªæœ‰ ORï¼Œåˆ™è½¬æ¢ä¸º beta = log(OR)
  if (!("beta" %in% names(df)) && ("or" %in% names(df))) {
    df$beta <- log(df$or)
  }
  return(df)
}

gwas1 <- standardize_cols(gwas1)
gwas2 <- standardize_cols(gwas2)
eqtl1 <- standardize_cols(eqtl1)
eqtl2 <- standardize_cols(eqtl2)
# åœ¨è¯»å– gwas1 åæ·»åŠ 
gwas1$ncases <- 60000
# åœ¨è¯»å– gwas1 åæ·»åŠ 
gwas1$ncases <- 60000

gwas2$ncases <- 60000

gwas2$ncases <- 60000
eqtl1$n <- 450
eqtl2$n <- 450



# é’ˆå¯¹ eqtl1 å’Œ eqtl2 (åŸºäºä¸Šä¸€æ­¥çš„ eqtl1 åˆ†æ)
rename_eqtl <- function(df) {
  # ç¡®ä¿åªæœ‰å­˜åœ¨çš„åˆ—æ‰è¢«é‡å‘½å
  if ("gene_chr" %in% names(df)) names(df)[names(df) == "gene_chr"] <- "chr" # å‡è®¾æ˜¯ gene_chr æˆ– chr
  if ("variant_pos" %in% names(df)) names(df)[names(df) == "variant_pos"] <- "pos"
  if ("rs_id_dbsnp151_grch38p7" %in% names(df)) names(df)[names(df) == "rs_id_dbsnp151_grch38p7"] <- "snp"
  if ("slope_se" %in% names(df)) names(df)[names(df) == "slope_se"] <- "se"
  # eqtl çš„ chr/pos/snp åˆ—åå¯èƒ½ä¸ gwas ä¸åŒï¼Œè¯·æ ¹æ®æ‚¨çš„å®é™…åˆ—åè°ƒæ•´æ­¤å‡½æ•°
  return(df)
}

eqtl1 <- rename_eqtl(eqtl1)
eqtl2 <- rename_eqtl(eqtl2)
```

è§£é‡Šè¦ç‚¹ï¼š

-   å¿…é¡»è‡³å°‘æœ‰ `snp`ã€`chr`ã€`pos`ï¼›è‹¥æ²¡æœ‰ `beta` & `se`ï¼Œå¯ä»¥ç”¨ `p` å’Œ `N` ä¼°ç®—ä½†ç²¾åº¦å·®ï¼Œä¸æ¨èã€‚
-   è‹¥æˆ‘ä»¬çš„æ–‡ä»¶æ˜¯åœ¨ä¸åŒåŸºå› ç»„åæ ‡ï¼ˆhg19 vs hg38ï¼‰ï¼Œè¯·å…ˆç»Ÿä¸€ï¼ˆæœ¬è„šæœ¬ä¸ä½œåæ ‡è½¬æ¢ï¼‰ã€‚
-   å¦‚æœè„šæœ¬æŠ¥ç¼ºåˆ—ï¼Œè¯·åœ¨æ–‡ä»¶ä¸­ç»™å‡ºæˆ–å‘Šè¯‰æˆ‘ç¡®åˆ‡åˆ—åï¼ˆæˆ–ç›´æ¥ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚

------------------------------------------------------------------------

# 3. åœ¨ GWAS ä¸­è¯†åˆ« lead SNPï¼ˆP \< 5e-8ï¼‰

```r
# step1_identify_leads.R
# å‡è®¾ gwas1/gwas2 å·²ç»æ ‡å‡†åŒ–
get_gws_leads <- function(gwas_df, chrnum){
  if (!("p" %in% names(gwas_df))) stop("GWAS file lacks p column named 'p'.")
  df <- gwas_df %>% filter(chr == chrnum & !is.na(p) & p < 5e-8)
  return(unique(df$snp))
}

leads_chr1_auto <- get_gws_leads(gwas1, 1)
leads_chr2_auto <- get_gws_leads(gwas2, 2)
cat("è‡ªåŠ¨è¯†åˆ«åˆ° chr1 leads:", paste(leads_chr1_auto, collapse=", "), "\n")
cat("è‡ªåŠ¨è¯†åˆ«åˆ° chr2 leads:", paste(leads_chr2_auto, collapse=", "), "\n")


```

``` r
è‡ªåŠ¨è¯†åˆ«åˆ° chr1 leads: rs6683533, rs7544590, rs12135355, rs2404715, , rs3119838, rs4582858, rs72692285, rs72702041, rs115223117, rs11805990, rs4656672, rs1226712, rs12069356, rs35600151, rs76036595, rs7526429, rs61477144, rs556797383, rs708109, rs11487551, rs75450729, rs12031887, rs376798493, rs10797376, rs150595340, rs12125807, rs76783613, rs17544956, rs4472809, rs834991, rs2421498, rs4845402, rs562837, rs942816, rs4523570, rs1892417, rs78571404, rs112236096, rs79008867, rs10801990, rs10919202, rs2474708, rs76735567, rs4639748, rs512406, rs10442651, rs10753826, rs10923446, rs12402006, rs3737883, rs113261881, rs56219455, rs12038117, rs114144492, rs10919196, rs75579693, rs12138564, rs447902, rs76368841, rs377497990, rs10494257,...
... rs10931896, rs3935560, rs10209606, rs6433770, rs4954558, rs7603456, rs75188497, rs9678998, rs11690002, rs10803659, rs4671399, rs534823840, rs12611683, rs4665772, rs62175452, rs2341778, rs34807901, rs72811412, rs4664346, rs6729997, rs62169534, rs34948552, rs72930362, rs145871442 
```

è§£é‡Šï¼š

-   è¿™é‡Œé»˜è®¤ threshold = 5e-8ï¼ˆå¸¸è§„ genome-wide significanceï¼‰ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹å·¥æä¾› lead åˆ—è¡¨ï¼ˆæ¥è‡ª kdocsï¼‰ã€‚

------------------------------------------------------------------------

# 4. å¯¹æ¯ä¸ª lead åš Â±500 kb æˆªå–ã€ç­‰ä½åŸºå› å¯¹é½ä¸æ„é€  `coloc` datasetï¼ˆå…³é”®å‡½æ•°ä¸è¯´æ˜ï¼‰

ä¸‹é¢ç»™å‡ºä¸€ä¸ªç¨³å¥çš„å‡½æ•° `run_coloc_for_lead()`ï¼Œå®ƒæ‰§è¡Œï¼šæˆªå–åŒºåŸŸã€å–äº¤é›† SNPã€ç­‰ä½åŸºå› å¯¹é½ï¼ˆå¤„ç†ç¿»è½¬ & äº’è¡¥ï¼‰ã€æ„å»º `dataset1` ä¸ `dataset2`ï¼Œå¹¶è¿è¡Œ `coloc.abf()`ã€‚æŠŠå‡½æ•°å¤åˆ¶åˆ° R ä¸­å¹¶è¿è¡Œã€‚

```r
# step2_run_coloc_for_lead.R

# step2_run_coloc_for_lead.R
if (!requireNamespace("coloc", quietly=TRUE)) install.packages("coloc")
library(coloc)

# è¾…åŠ©ï¼šç­‰ä½åŸºå› å¯¹é½ï¼ˆè¿”å› TRUE/FLIP/NAï¼‰
allele_flip_status <- function(a1, b1, a2, b2){
  # a1,b1: dataset1 alleles (expect uppercase)
  # a2,b2: dataset2 alleles
  if (any(is.na(c(a1,b1,a2,b2)))) return(NA)
  a1 <- toupper(a1); b1 <- toupper(b1); a2 <- toupper(a2); b2 <- toupper(b2)
  # identical
  if (a1 == a2 && b1 == b2) return("same")
  if (a1 == b2 && b1 == a2) return("flip")
  comp <- function(x){
    sapply(strsplit(x,""), function(ch) { map <- c(A="T",T="A",C="G",G="C"); paste0(map[ch], collapse="") })
  }
  if (comp(a2) == a1 && comp(b2) == b1) return("same_comp")
  if (comp(a2) == b1 && comp(b2) == a1) return("flip_comp")
  return(NA)
}


#å®šä¹‰çª—å£
run_coloc_for_lead <- function(lead_snp, chrnum, gwas_df, eqtl_df, flank=500000,
                               prior_p1=1e-4, prior_p2=1e-4, prior_p12=1e-5){
    
    # 1. æ‰¾ lead pos
    lead_row <- gwas_df %>% filter(snp == lead_snp) %>% slice(1)
    if (nrow(lead_row)==0) { warning("Lead not found in GWAS:", lead_snp); return(NULL) }
    lead_pos <- lead_row$pos
    lo <- lead_pos - flank; hi <- lead_pos + flank

    # 2. æˆªå–åŒºåŸŸ
    gsub <- gwas_df %>% filter(chr == chrnum & pos >= lo & pos <= hi)
    eqsub <- eqtl_df %>% filter(chr == chrnum & pos >= lo & pos <= hi)
    if (nrow(gsub)==0 || nrow(eqsub)==0) { warning("No SNPs in region for one dataset"); return(NULL) }
    # åœ¨ run_coloc_for_lead å‡½æ•°çš„å¼€å§‹ï¼Œæˆ–åœ¨å…¨å±€æ ‡å‡†åŒ–æ—¶æ‰§è¡Œï¼š
    if ("maf" %in% names(gsub)) {
        gsub$maf <- as.numeric(gsub$maf)
    }
    

    # 2c. MAF å€¼èŒƒå›´æ£€æŸ¥å’Œè¿‡æ»¤ (æ–°çš„ä¿®å¤ç‚¹)
    if ("maf" %in% names(gsub)) {
        initial_gsub_count_maf <- nrow(gsub)
        
        # å¼ºåˆ¶è½¬æ¢ä¸ºæ•°å€¼å‹ï¼ˆå¦‚æœä¸æ˜¯ï¼‰å¹¶ç§»é™¤ NA/æ— æ•ˆå€¼
        gsub$maf <- as.numeric(gsub$maf)
        
        # MAF å¿…é¡»åœ¨ (0, 1) èŒƒå›´å†…
        gsub <- gsub %>% filter(!is.na(maf) & maf > 0 & maf < 1)
        
        if (nrow(gsub) < initial_gsub_count_maf) warning(paste("GWAS MAFè¿‡æ»¤åç§»é™¤", initial_gsub_count_maf - nrow(gsub), "è¡Œæ— æ•ˆMAFsæ•°æ®"))
    }
    
    if (nrow(gsub)==0 || nrow(eqsub)==0) { warning("MAFè¿‡æ»¤åæ•°æ®é›†ä¸ºç©º"); return(NULL) }

    # 2a. ä¸¥æ ¼è¿‡æ»¤å…³é”®åˆ—çš„ NA (æ–°åŠ å…¥æˆ–å†æ¬¡ç¡®è®¤)
    # ç§»é™¤ä»»ä½• snp, beta, se ç¼ºå¤±çš„è¡Œ
    initial_gsub_count <- nrow(gsub)
    initial_eqsub_count <- nrow(eqsub)
    
    gsub <- gsub %>% filter(!is.na(snp) & !is.na(beta) & !is.na(se))
    eqsub <- eqsub %>% filter(!is.na(snp) & !is.na(beta) & !is.na(se))
    
    if (nrow(gsub) < initial_gsub_count) warning(paste("GWASè¿‡æ»¤åç§»é™¤", initial_gsub_count - nrow(gsub), "è¡ŒNAæ•°æ®"))
    if (nrow(eqsub) < initial_eqsub_count) warning(paste("eQTLè¿‡æ»¤åç§»é™¤", initial_eqsub_count - nrow(eqsub), "è¡ŒNAæ•°æ®"))
    
    if (nrow(gsub)==0 || nrow(eqsub)==0) { warning("NAè¿‡æ»¤åæ•°æ®é›†ä¸ºç©º"); return(NULL) }


    # 2b. eQTL æ•°æ®å»é‡ (å¦‚æœå­˜åœ¨ p åˆ—)
    if ("p" %in% names(eqsub) && any(duplicated(eqsub$snp))) {
        warning(paste("DEBUG: eQTL åŒºåŸŸå†…å‘ç°", sum(duplicated(eqsub$snp)), "ä¸ªé‡å¤ SNPã€‚æŒ‰æœ€å° P å€¼å»é‡ã€‚"))
        eqsub <- eqsub %>%
            group_by(snp) %>%
            slice_min(order_by = p, n = 1, with_ties = FALSE) %>%
            ungroup()
    }

    # 3. äº¤é›†å¹¶æŒ‰ä½ç½®æ’åº
    common <- intersect(gsub$snp, eqsub$snp)
    if (length(common) < 1) { warning("äº¤é›† SNP ä¸ºé›¶"); return(NULL) }
    if (length(common) < 10) warning("äº¤é›† SNP å¾ˆå°‘:", length(common))
    
    gsub2 <- gsub %>% filter(snp %in% common) %>% arrange(pos)
    eqsub2 <- eqsub %>% filter(snp %in% common) %>% arrange(match(snp, gsub2$snp))

    # 4. ç­‰ä½åŸºå› å¯¹é½ (ä¿æŒä¸å˜)
    flips <- mapply(allele_flip_status, a1=gsub2$effect_allele, b1=gsub2$other_allele,
                    a2=eqsub2$effect_allele, b2=eqsub2$other_allele, SIMPLIFY = TRUE)
    keep_idx <- which(!is.na(flips))
    if (length(keep_idx)==0) { warning("Allele alignment failed for all SNPs"); return(NULL) }
    
    gsub3 <- gsub2[keep_idx,]
    eqsub3 <- eqsub2[keep_idx,]
    flips <- flips[keep_idx]
    
    # ... (beta å–è´Ÿé€»è¾‘ä¿æŒä¸å˜) ...

    # 6. æ„é€  datasets (å« s å€¼ä¿®å¤)
    # è°ƒè¯•æ£€æŸ¥ï¼šåœ¨æ„é€ æ•°æ®é›†å‰å†æ¬¡ç¡®è®¤ SNP åˆ—æ—  NA
    if (any(is.na(eqsub3$snp))) { 
        warning("FATAL DEBUG: eqsub3 çš„ SNP åˆ—åœ¨ Coloc è°ƒç”¨å‰ä»åŒ…å« NAã€‚æ­£åœ¨è·³è¿‡æ­¤ SNPã€‚")
        return(NULL) # è·³è¿‡è¯¥ lead SNP
    }

    # å°è¯•è®¡ç®— s
    s_calculated <- NA
    N_gwas <- if("n" %in% names(gsub3)) unique(gsub3$n)[1] else NA
    NCASES_gwas <- if("ncases" %in% names(gsub3)) unique(gsub3$ncases)[1] else NA
    
    if (!is.na(N_gwas) && !is.na(NCASES_gwas) && N_gwas > 0) {
        s_calculated <- NCASES_gwas / N_gwas
    }
    
    # å¦‚æœè®¡ç®—å¤±è´¥æˆ–ç»“æœæ— æ•ˆï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ 0.5 
    if (is.na(s_calculated) || s_calculated <= 0 || s_calculated >= 1) {
        s_value <- 0.5 
        # warning(paste0("GWAS 's' ç¼ºå¤±æˆ–æ— æ•ˆ...ä½¿ç”¨é»˜è®¤å€¼ s=", s_value)) # é¿å…é‡å¤è­¦å‘Š
    } else {
        s_value <- s_calculated
    }

    ds1 <- list(snp = gsub3$snp, beta = gsub3$beta, varbeta = (gsub3$se)^2,
                MAF = if("maf" %in% names(gsub3)) gsub3$maf else NULL,
                N = N_gwas,
                type = "cc",
                s = s_value) 
    ds2 <- list(snp = eqsub3$snp, beta = eqsub3$beta, varbeta = (eqsub3$se)^2,
                MAF = if("maf" %in% names(eqsub3)) eqsub3$maf else NULL,
                N = if("n" %in% names(eqsub3)) unique(eqsub3$n) else NA,
                type = "quant")


    # 7. è¿è¡Œ coloc.abf å¹¶è¿”å›
    res <- coloc.abf(dataset1 = ds1, dataset2 = ds2, p1 = prior_p1, p2 = prior_p2, p12 = prior_p12)
    return(list(summary = res$summary, results = res$results, common_snps = nrow(gsub3)))
}

```

è§£é‡Šä¸æ³¨æ„ï¼š

-   ç­‰ä½åŸºå› å¯¹é½éå¸¸å…³é”®ï¼šè‹¥ä¸å¯¹é½ï¼Œbeta æ–¹å‘é”™ä½ä¼šå¯¼è‡´å®Œå…¨é”™è¯¯çš„ç»“è®ºã€‚å‡½æ•°å¤„ç†äº†ç›´æ¥ç›¸åŒã€flipã€ä»¥åŠäº’è¡¥ï¼ˆAâ†”T, Câ†”Gï¼‰çš„æƒ…å†µã€‚ambiguousï¼ˆæ— æ³•åˆ¤å®šï¼‰åˆ™è¢«å‰”é™¤ã€‚
-   `ds1$type = "cc"` å‡è®¾ GWAS ä¸º case-controlï¼›è‹¥æˆ‘ä»¬çš„ GWAS å·²ç»æ˜¯æŸç§è¿ç»­è¡¨å‹ï¼Œè¯·æ”¹æˆ `"quant"`ã€‚
-   `ds1$s`ï¼ˆcases proportionï¼‰è‹¥å¯å¾—ï¼Œåº”å¡«å†™ï¼Œå¦åˆ™ `coloc` å°†è¿‘ä¼¼ä¼°è®¡ï¼Œå¯ä¿¡åº¦ç•¥ä½ã€‚
-   è‹¥ region å†… SNP å¾ˆå°‘ï¼ˆ\<10ï¼‰ï¼Œè­¦å‘Šç»“æœå¯èƒ½ä¸ç¨³å¥ã€‚

------------------------------------------------------------------------

# 5. æ‰¹é‡è¿è¡Œï¼šå¯¹æ‰€æœ‰ leadï¼ˆchr1 / chr2ï¼‰å¾ªç¯å¹¶ä¿å­˜æ±‡æ€»è¡¨

æŠŠä¸‹é¢ä»£ç åŠ åˆ°ä¸Šé¢çš„å‡½æ•°åè¿è¡Œï¼Œå®ƒä¼šå¯¹è‡ªåŠ¨æ£€æµ‹çš„ leadï¼ˆé€ä¸€è¿è¡Œå¹¶ä¿å­˜ `coloc_results_summary.tsv`ã€‚

```r
## ğŸ” å…³é”®è¯Šæ–­å’Œæ¸…ç†æ­¥éª¤ ğŸ› ï¸

# æ‰¾å‡ºé‡å¤åˆ—åçš„è¾…åŠ©å‡½æ•°
find_and_fix_duplicates <- function(df, df_name) {
    if (is.null(df) || nrow(df) == 0) {
        warning(paste(df_name, "is empty or NULL, skipping duplicate check."))
        return(df)
    }
    
    dup_names <- names(df)[duplicated(names(df))]
    
    if (length(dup_names) > 0) {
        cat(paste0("âš ï¸ WARNING: ", df_name, " å‘ç°é‡å¤åˆ—å: ", paste(dup_names, collapse = ", "), "\n"))
        
        # ç®€å•å»é‡ç­–ç•¥ï¼šä¿ç•™ç¬¬ä¸€æ¬¡å‡ºç°çš„åˆ—
        # è¿™ä¸€æ­¥å¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œä½†èƒ½è§£å†³ 'duplicate names' é”™è¯¯
        df <- df[, !duplicated(names(df))]
        
        cat(paste0("âœ… ", df_name, " é‡å¤åˆ—å·²ç§»é™¤ã€‚å‰©ä½™åˆ—æ•°: ", ncol(df), "\n"))
    } else {
        cat(paste0("ğŸŸ¢ ", df_name, " æ²¡æœ‰é‡å¤åˆ—åã€‚\n"))
    }
    return(df)
}

# å¯¹æ‰€æœ‰æ•°æ®æ¡†åº”ç”¨æ£€æŸ¥å’Œå»é‡
gwas1 <- find_and_fix_duplicates(gwas1, "gwas1")
gwas2 <- find_and_fix_duplicates(gwas2, "gwas2")
eqtl1 <- find_and_fix_duplicates(eqtl1, "eqtl1")
eqtl2 <- find_and_fix_duplicates(eqtl2, "eqtl2")

# å†æ¬¡æ£€æŸ¥å…³é”®åˆ—æ˜¯å¦å­˜åœ¨ï¼ˆç¡®è®¤å»é‡åå…³é”®åˆ—æ²¡æœ‰ä¸¢å¤±ï¼‰
req_cols <- c("snp","chr","pos", "p", "beta", "se", "effect_allele", "other_allele")
check_required <- function(df, req) {
    miss <- setdiff(req, names(df))
    if (length(miss) > 0) return(paste(miss, collapse = ", ")) else return("NULL")
}

cat("\n--- å…³é”®åˆ—å­˜åœ¨æ€§æ£€æŸ¥ ---\n")
cat("gwas1 missing:", check_required(gwas1, req_cols), "\n")
cat("gwas2 missing:", check_required(gwas2, req_cols), "\n")
cat("eqtl1 missing:", check_required(eqtl1, req_cols), "\n")
cat("eqtl2 missing:", check_required(eqtl2, req_cols), "\n")
cat("--------------------------\n")

# å¦‚æœæ£€æŸ¥ç»“æœæ˜¾ç¤ºå…³é”®åˆ—ç¼ºå¤±ï¼Œæˆ‘ä»¬éœ€è¦å›æº¯ä¸Šä¸€æ­¥çš„é‡å‘½åä»£ç ï¼Œç¡®ä¿é‡å‘½åå‰åªé‡å‘½åä¸€æ¬¡ã€‚
## ğŸ§¬ ç»Ÿä¸€æŸ“è‰²ä½“æ ¼å¼ä»£ç  ğŸ§¬

# ç»Ÿä¸€å¤„ç†å‡½æ•°ï¼šç§»é™¤ "chr" å‰ç¼€å¹¶è½¬æ¢ä¸ºæ•°å­—
clean_chr_column <- function(df, chr_col_name = "chr") {
    if (chr_col_name %in% names(df)) {
        # ç§»é™¤å¯èƒ½çš„ "chr", "Chr", "CHROMOSOME" ç­‰å‰ç¼€
        df[[chr_col_name]] <- gsub(pattern = "^(chr|Chr|CHROMOSOME)", replacement = "", 
                                   x = df[[chr_col_name]], 
                                   ignore.case = TRUE)
        # è½¬æ¢ä¸ºæ•°å­—ç±»å‹ï¼ˆè¿™ä¸€æ­¥è‡³å…³é‡è¦ï¼Œèƒ½å¤„ç†åƒ X/Y/MT çš„ NAï¼‰
        df[[chr_col_name]] <- as.numeric(df[[chr_col_name]])
    } else {
        warning(paste("Data frame is missing the required chromosome column:", chr_col_name))
    }
    return(df)
}

# åº”ç”¨äºæ‰€æœ‰æ•°æ®æ¡†
gwas1 <- clean_chr_column(gwas1)
gwas2 <- clean_chr_column(gwas2)
eqtl1 <- clean_chr_column(eqtl1)
eqtl2 <- clean_chr_column(eqtl2)

# æ‰“å°ç¤ºä¾‹å€¼æ£€æŸ¥
cat("ç»Ÿä¸€æ ¼å¼å GWAS1 Chr ç¤ºä¾‹:", gwas1$chr[1], " (Type:", typeof(gwas1$chr), ")\n")
cat("ç»Ÿä¸€æ ¼å¼å eQTL1 Chr ç¤ºä¾‹:", eqtl1$chr[1], " (Type:", typeof(eqtl1$chr), ")\n")

```

```r
# step3_batch_run_and_save.R
# leads_chr1_auto / leads_chr2_auto å·²å¾—åˆ°
all_results <- list()
# chr1
for (lead in leads_chr1_auto){
  cat("Running chr1 lead:", lead, "...\n")
  res <- tryCatch(run_coloc_for_lead(lead, 1, gwas1, eqtl1), error = function(e){ warning(e); NULL })
  all_results[[paste0("chr1_", lead)]] <- res
}
# chr2
for (lead in leads_chr2_auto){
  cat("Running chr2 lead:", lead, "...\n")
  res <- tryCatch(run_coloc_for_lead(lead, 2, gwas2, eqtl2), error = function(e){ warning(e); NULL })
  all_results[[paste0("chr2_", lead)]] <- res
}

# æ±‡æ€»åˆ°è¡¨æ ¼
summaries <- lapply(names(all_results), function(k){
  res <- all_results[[k]]
  if (is.null(res)) return(NULL)
  row <- as.data.frame(t(res$summary))
  row$lead_key <- k
  row$common_snps <- res$common_snps
  return(row)
})
summary_df <- do.call(rbind, summaries)
# å†™å‡ºåˆ° base_dir
out_file <- file.path(base_dir, "coloc_results_summary.tsv")
if (!is.null(summary_df)) write.table(summary_df, out_file, sep = "\t", row.names = FALSE, quote = FALSE)
cat("Saved summary to:", out_file, "\n")
print(summary_df)
```

è¾“å‡ºç¤ºä¾‹ï¼ˆè¡¨æ ¼å†…å®¹è§£é‡Šï¼‰ï¼š

-   è¡Œï¼šæ¯ä¸ª leadï¼ˆchr ä¸ rsid ç»„åˆï¼‰ï¼Œ
-   åˆ—ï¼š`PP.H0, PP.H1, PP.H2, PP.H3, PP.H4, lead_key, common_snps`ã€‚ å…³æ³¨ `PP.H4` ä¸ `common_snps`ï¼ˆå¦‚æœå…±åŒ SNP éå¸¸å°‘ï¼Œç»“æœè¦è°¨æ…ï¼‰ã€‚

``` r
Saved summary to: E:/acode/homwwork/data2/coloc_results_summary.tsv 
    nsnps     PP.H0.abf     PP.H1.abf     PP.H2.abf    PP.H3.abf    PP.H4.abf
1       6  4.731394e-06  1.854825e-09  7.512787e-01 4.584936e-05 2.486707e-01
2      10 7.232894e-129  3.236419e-19 2.234845e-110 1.000000e+00 2.586883e-10
3      10  1.966284e-67  5.299034e-05  3.709560e-63 9.997071e-01 2.398800e-04
4       1  3.707415e-02  8.241743e-04  4.141558e-02 0.000000e+00 9.206861e-01
5       1  9.995130e-01  2.497531e-05  4.508008e-04 0.000000e+00 1.126438e-05
6       8 1.163214e-118  5.204899e-09 8.295818e-111 3.705739e-01 6.294261e-01
7      10 7.232894e-129  3.236419e-19 2.234845e-110 1.000000e+00 2.586883e-10
8       8  1.377416e-41  3.101244e-03  4.426101e-39 9.965337e-01 3.650152e-04
9      10 1.157612e-118  5.179830e-09 8.295822e-111 3.705741e-01 6.294259e-01
10     11 1.225034e-118  5.481518e-09 8.295772e-111 3.705718e-01 6.294282e-01
11     10 3.529898e-118  2.681391e-11 1.318038e-110 1.212717e-06 9.999988e-01
12      9  2.216942e-05  2.552204e-07  9.847359e-01 1.133264e-02 3.909030e-03
13      9 1.157231e-118  5.178125e-09 8.295823e-111 3.705741e-01 6.294259e-01
14      3  2.322911e-57  4.865306e-62  9.898210e-01 1.056326e-05 1.016840e-02
15      9  5.837554e-67  1.573191e-04  3.707207e-63 9.990725e-01 7.702142e-04
16      9  7.923351e-42  1.783938e-03  4.432629e-39 9.980035e-01 2.125219e-04
17     11  2.920910e-22  2.279766e-04  1.275334e-18 9.953921e-01 4.379919e-03
18      9  1.981040e-67  5.338802e-05  3.709553e-63 9.997054e-01 2.411767e-04
19     10  3.464783e-04  5.125830e-03  4.487245e-02 6.635607e-01 2.860945e-01
20     10  1.966284e-67  5.299034e-05  3.709560e-63 9.997071e-01 2.398800e-04
21      2  9.491682e-01  1.832121e-03  1.853442e-02 5.315950e-06 3.045990e-02
22     12 1.291284e-258 1.120523e-241  1.152394e-17 1.000000e+00 2.594790e-20
23      8 9.603485e-120  4.297160e-10 8.299452e-111 3.707366e-01 6.292634e-01
24      6  6.766369e-01  2.216729e-03  1.831218e-01 4.623631e-04 1.375621e-01
25      8  1.377416e-41  3.101244e-03  4.426101e-39 9.965337e-01 3.650152e-04
26      9  4.902014e-44  1.508929e-06  6.701699e-41 1.063970e-03 9.989345e-01
27      8 9.961607e-128  4.457404e-18 2.234845e-110 1.000000e+00 9.913606e-10
28      8  7.366496e-01  4.046591e-02  4.709649e-02 2.413747e-03 1.733743e-01
29     10 3.529898e-118  2.681391e-11 1.318038e-110 1.212717e-06 9.999988e-01
30      8  1.363806e-08  1.114003e-02  4.593468e-07 3.745955e-01 6.142640e-01
31     10 7.232894e-129  3.236419e-19 2.234845e-110 1.000000e+00 2.586883e-10
32     11  1.147800e-67  3.093263e-05  3.709928e-63 9.998064e-01 1.626922e-04
33      9  1.219774e-08  3.886755e-07  3.138347e-05 5.217385e-08 9.999682e-01
34      9 1.157231e-118  5.178125e-09 8.295823e-111 3.705741e-01 6.294259e-01
35     12  2.888003e-22  2.254082e-04  1.275397e-18 9.954408e-01 4.333780e-03
36      9  5.837554e-67  1.573191e-04  3.707207e-63 9.990725e-01 7.702142e-04
37      8 1.163214e-118  5.204899e-09 8.295818e-111 3.705739e-01 6.294261e-01
38      9  4.902014e-44  1.508929e-06  6.701699e-41 1.063970e-03 9.989345e-01
39      8  4.807264e-70  1.295533e-07  3.710634e-63 9.999969e-01 2.992898e-06
40     10  1.966284e-67  5.299034e-05  3.709560e-63 9.997071e-01 2.398800e-04
41      9  5.837554e-67  1.573191e-04  3.707207e-63 9.990725e-01 7.702142e-04
42     25 3.378355e-130 3.198899e-129  9.550187e-02 9.042885e-01 2.096442e-04
43      9  3.790240e-04  5.607311e-03  4.351431e-02 6.434470e-01 3.070524e-01
44     10 7.232894e-129  3.236419e-19 2.234845e-110 1.000000e+00 2.586883e-10
45     10 7.232894e-129  3.236419e-19 2.234845e-110 1.000000e+00 2.586883e-10
46      9  4.902014e-44  1.508929e-06  6.701699e-41 1.063970e-03 9.989345e-01
47     35  1.105865e-22  5.051482e-20  2.184347e-03 9.977880e-01 2.766836e-05
48     15  3.555098e-65  1.931331e-04  1.767159e-61 9.599817e-01 3.982514e-02
49     12 4.007588e-263 3.477620e-246  1.152394e-17 1.000000e+00 2.594790e-20
50     10 1.157612e-118  5.179830e-09 8.295822e-111 3.705741e-01 6.294259e-01
51      8  7.292291e-08  8.391504e-10  9.847632e-01 1.132812e-02 3.908602e-03
52     10 3.529898e-118  2.681391e-11 1.318038e-110 1.212717e-06 9.999988e-01
53     30  6.475567e-24  6.705101e-19  9.657516e-06 9.999839e-01 6.448089e-06
54      9  3.790240e-04  5.607311e-03  4.351431e-02 6.434470e-01 3.070524e-01
55     10 3.529898e-118  2.681391e-11 1.318038e-110 1.212717e-06 9.999988e-01
56      8  1.377416e-41  3.101244e-03  4.426101e-39 9.965337e-01 3.650152e-04
57      3  2.322911e-57  4.865306e-62  9.898210e-01 1.056326e-05 1.016840e-02
58      8 9.603485e-120  4.297160e-10 8.299452e-111 3.707366e-01 6.292634e-01
59      6  6.766369e-01  2.216729e-03  1.831218e-01 4.623631e-04 1.375621e-01
60     10  3.782951e-04  5.596531e-03  4.354416e-02 6.438895e-01 3.065915e-01
61      9 7.315478e-129  3.273371e-19 2.234845e-110 1.000000e+00 2.602112e-10
62     13 4.818984e-261 4.181717e-244  1.152394e-17 1.000000e+00 2.594790e-20
63     26 8.911452e-113  2.948970e-41  3.021887e-72 1.000000e+00 1.164463e-38
64      9 1.098611e-118  4.915828e-09 8.295870e-111 3.705762e-01 6.294238e-01
65      5  6.732825e-22  7.565279e-21  8.898917e-05 7.940603e-09 9.999110e-01
66      6  4.731394e-06  1.854825e-09  7.512787e-01 4.584936e-05 2.486707e-01
67      9 1.104032e-118  4.940085e-09 8.295865e-111 3.705760e-01 6.294240e-01
68     15  3.555098e-65  1.931331e-04  1.767159e-61 9.599817e-01 3.982514e-02
69     10 3.529898e-118  2.681391e-11 1.318038e-110 1.212717e-06 9.999988e-01
70     13 1.064989e-264 9.241535e-248  1.152394e-17 1.000000e+00 2.594790e-20
71      7  9.288383e-05  6.110533e-07  9.187656e-01 5.969097e-03 7.517178e-02
72     17  4.747512e-23  3.705425e-05  1.280182e-18 9.991795e-01 7.834436e-04
73      9  5.837554e-67  1.573191e-04  3.707207e-63 9.990725e-01 7.702142e-04
74     13 1.064989e-264 9.241535e-248  1.152394e-17 1.000000e+00 2.594790e-20
75      5  6.732825e-22  7.565279e-21  8.898917e-05 7.940603e-09 9.999110e-01
76      4  3.548832e-39  7.990175e-01  9.485724e-41 2.117725e-02 1.798053e-01
77     10 7.232894e-129  3.236419e-19 2.234845e-110 1.000000e+00 2.586883e-10
78      8  1.377416e-41  3.101244e-03  4.426101e-39 9.965337e-01 3.650152e-04
79     10  1.966284e-67  5.299034e-05  3.709560e-63 9.997071e-01 2.398800e-04
80     22  1.610887e-34  3.696175e-19  4.358254e-16 1.000000e+00 6.937729e-15
81     33  6.198582e-24  6.418299e-19  9.657516e-06 9.999839e-01 6.448089e-06
82     10  1.966284e-67  5.299034e-05  3.709560e-63 9.997071e-01 2.398800e-04
83     10 7.232894e-129  3.236419e-19 2.234845e-110 1.000000e+00 2.586883e-10
84      9  4.902014e-44  1.508929e-06  6.701699e-41 1.063970e-03 9.989345e-01
85     29 2.696031e-112  8.921681e-41  3.021887e-72 1.000000e+00 3.325134e-38
86      8 9.603485e-120  4.297160e-10 8.299452e-111 3.707366e-01 6.292634e-01
87     10 7.232894e-129  3.236419e-19 2.234845e-110 1.000000e+00 2.586883e-10
88      9 1.157231e-118  5.178125e-09 8.295823e-111 3.705741e-01 6.294259e-01
89     13 4.818984e-261 4.181717e-244  1.152394e-17 1.000000e+00 2.594790e-20
90      9  8.910089e-01  4.449519e-02  5.585575e-02 2.783467e-03 5.856688e-03
91      9  1.619256e-09  5.298072e-07  2.752641e-03 9.005446e-01 9.670228e-02
92     22  3.470243e-57  7.962462e-42  4.358253e-16 1.000000e+00 8.218297e-19
93     11  3.434492e-04  5.081021e-03  4.499998e-02 6.654500e-01 2.841255e-01
94      7  2.240540e-41  5.044563e-03  4.416481e-39 9.943676e-01 5.878496e-04
95      9  5.191658e-15  7.278479e-10  4.489502e-06 6.290377e-01 3.709578e-01
96      8  2.289170e-05  2.614646e-07  9.848229e-01 1.124455e-02 3.909389e-03
97      7  9.000445e-01  1.334528e-04  9.924941e-02 1.415755e-05 5.585078e-04
98     11  3.439923e-20  3.370787e-22  9.810056e-01 9.603500e-03 9.390928e-03
99     12  2.650915e-20  2.599546e-22  9.809986e-01 9.610500e-03 9.390862e-03
100     9  4.902014e-44  1.508929e-06  6.701699e-41 1.063970e-03 9.989345e-01
101    11  2.920910e-22  2.279766e-04  1.275334e-18 9.953921e-01 4.379919e-03
102     2  9.491682e-01  1.832121e-03  1.853442e-02 5.315950e-06 3.045990e-02
103     9  7.923351e-42  1.783938e-03  4.432629e-39 9.980035e-01 2.125219e-04
104    16  2.775813e-09  5.538343e-12  9.888776e-01 1.963864e-03 9.158536e-03
105     9  7.365041e-01  4.047194e-02  4.723102e-02 2.422040e-03 1.733709e-01
106    13  2.835488e-22  2.213094e-04  1.275496e-18 9.955186e-01 4.260067e-03
107     9  5.837554e-67  1.573191e-04  3.707207e-63 9.990725e-01 7.702142e-04
108     8 9.603485e-120  4.297160e-10 8.299452e-111 3.707366e-01 6.292634e-01
109    21  1.532532e-34  3.516389e-19  4.358254e-16 1.000000e+00 6.759038e-15
110    25 3.640408e-130 3.447079e-129  9.550069e-02 9.042897e-01 2.096416e-04
111     9  5.837554e-67  1.573191e-04  3.707207e-63 9.990725e-01 7.702142e-04
112    10 1.157612e-118  5.179830e-09 8.295822e-111 3.705741e-01 6.294259e-01
113    15  5.146606e-79  2.006982e-68  3.932299e-14 5.339825e-04 9.994660e-01
114     6  6.766369e-01  2.216729e-03  1.831218e-01 4.623631e-04 1.375621e-01
115     6  4.731394e-06  1.854825e-09  7.512787e-01 4.584936e-05 2.486707e-01
116    10  3.782951e-04  5.596531e-03  4.354416e-02 6.438895e-01 3.065915e-01
117     9  5.837554e-67  1.573191e-04  3.707207e-63 9.990725e-01 7.702142e-04
118     5  6.732825e-22  7.565279e-21  8.898917e-05 7.940603e-09 9.999110e-01
119    26  7.009743e-65  5.294664e-62  1.322172e-03 9.986749e-01 2.904920e-06
120    10  1.966284e-67  5.299034e-05  3.709560e-63 9.997071e-01 2.398800e-04
121    13  3.320853e-14  9.156570e-17  9.948271e-01 2.740599e-03 2.432258e-03
122     3  2.322911e-57  4.865306e-62  9.898210e-01 1.056326e-05 1.016840e-02
123     6  4.731394e-06  1.854825e-09  7.512787e-01 4.584936e-05 2.486707e-01
124    14  3.907797e-65  2.122937e-04  1.761161e-61 9.567196e-01 4.306808e-02
125     7  9.288383e-05  6.110533e-07  9.187656e-01 5.969097e-03 7.517178e-02
            lead_key common_snps
1     chr1_rs6683533           6
2     chr1_rs7544590          10
3    chr1_rs12135355          10
4     chr1_rs2404715           1
5              chr1_           1
6     chr1_rs3119838           8
7     chr1_rs4582858          10
8    chr1_rs72692285           8
9    chr1_rs72702041          10
10  chr1_rs115223117          11
11   chr1_rs11805990          10
12    chr1_rs4656672           9
13    chr1_rs1226712           9
14   chr1_rs35600151           3
15   chr1_rs76036595           9
16    chr1_rs7526429           9
17   chr1_rs61477144          11
18  chr1_rs556797383           9
19     chr1_rs708109          10
20   chr1_rs11487551          10
21   chr1_rs75450729           2
22   chr1_rs12031887          12
23  chr1_rs376798493           8
24   chr1_rs10797376           6
25  chr1_rs150595340           8
26   chr1_rs12125807           9
27   chr1_rs76783613           8
28   chr1_rs17544956           8
29    chr1_rs4472809          10
30     chr1_rs834991           8
31    chr1_rs2421498          10
32     chr1_rs562837          11
33     chr1_rs942816           9
34    chr1_rs4523570           9
35    chr1_rs1892417          12
36   chr1_rs78571404           9
37   chr1_rs79008867           8
38   chr1_rs10801990           9
39   chr1_rs10919202           8
40    chr1_rs2474708          10
41   chr1_rs76735567           9
42    chr1_rs4639748          25
43     chr1_rs512406           9
44   chr1_rs10442651          10
45   chr1_rs10753826          10
46   chr1_rs10923446           9
47   chr1_rs12402006          35
48    chr1_rs3737883          15
49   chr1_rs56219455          12
50  chr1_rs114144492          10
51   chr1_rs10919196           8
52   chr1_rs75579693          10
53   chr1_rs12138564          30
54     chr1_rs447902           9
55   chr1_rs76368841          10
56  chr1_rs377497990           8
57   chr1_rs10494257           3
58   chr1_rs12141676           8
59   chr1_rs72855032           6
60   chr1_rs61825307          10
61   chr1_rs12749191           9
62    chr1_rs2501302          13
63  chr1_rs140646164          26
64    chr1_rs6674195           9
65   chr1_rs56398881           5
66    chr1_rs6425323           6
67   chr1_rs12744632           9
68    chr1_rs2270545          15
69   chr1_rs12131638          10
70   chr1_rs10917075          13
71   chr1_rs74139614           7
72   chr1_rs61780434          17
73   chr1_rs67193278           9
74    chr1_rs2501255          13
75    chr1_rs6658473           5
76    chr1_rs2896887           4
77    chr1_rs2421499          10
78   chr1_rs17106497           8
79  chr1_rs114192219          10
80     chr1_rs822505          22
81   chr1_rs12029695          33
82  chr1_rs116531609          10
83     chr1_rs926439          10
84    chr1_rs9428207           9
85   chr1_rs11264358          29
86    chr1_rs2187895           8
87    chr1_rs2421501          10
88   chr1_rs33953665           9
89   chr1_rs71638818          13
90   chr1_rs10916116           9
91  chr1_rs115332378           9
92   chr1_rs71628672          22
93   chr1_rs55873533          11
94   chr1_rs57131351           7
95    chr1_rs2075865           9
96     chr1_rs925892           8
97  chr1_rs115420575           7
98   chr1_rs12066114          11
99    chr1_rs2314147          12
100  chr1_rs12562553           9
101  chr1_rs12038386          11
102   chr1_rs6667372           2
103   chr1_rs6669003           9
104   chr1_rs1891716          16
105  chr1_rs61834590           9
106    chr1_rs213748          13
107  chr1_rs74371640           9
108  chr1_rs35863659           8
109  chr1_rs45498104          21
110  chr1_rs11247875          25
111 chr1_rs149124840           9
112   chr1_rs1854711          10
113  chr1_rs61822602          15
114   chr1_rs4576609           6
115   chr1_rs7514749           6
116    chr1_rs876180          10
117 chr1_rs190949251           9
118   chr1_rs4846479           5
119   chr1_rs1739814          26
120  chr1_rs76606834          10
121  chr1_rs11102516          13
122  chr1_rs79350682           3
123   chr1_rs1057302           6
124   chr1_rs2228079          14
125  chr1_rs77404909           7
 [ reached 'max' / getOption("max.print") -- omitted 11682 rows ]
```

------------------------------------------------------------------------

# 6. æ•æ„Ÿæ€§åˆ†æä¸å¤š causal çš„å¤„ç†å»ºè®®

**æ•æ„Ÿæ€§åˆ†æï¼ˆp12ï¼‰**ï¼šæ”¹å˜ `p12`ï¼ˆprior for shared causalï¼‰å€¼æ£€æŸ¥ PP.H4 ç¨³å¥æ€§ï¼Œå¸¸è¯• `1e-6, 1e-5, 1e-4`ã€‚ç¤ºä¾‹ï¼š

```r
# sensitivity.R
if (!is.null(summary_df) && nrow(summary_df) > 0){
  first_key <- summary_df$lead_key[1]
  res_obj <- all_results[[first_key]]
  ds1 <- res_obj$results  # æ³¨æ„ res_obj$results ä¸æ˜¯ datasetsï¼Œæœ¬ä¾‹ä»…æ¼”ç¤ºå¦‚ä½•è°ƒç”¨ coloc.abf å†è·‘ä¸åŒ p12
  # è¿™ä¸€æ­¥éœ€è¦ä½¿ç”¨åŸå§‹ dataset1/dataset2ï¼ˆå‡½æ•°å†…éƒ¨æœªä¿å­˜ï¼‰ã€‚è‹¥éœ€æ•æ„Ÿæ€§ï¼Œè¯·ä¿®æ”¹ run_coloc_for_lead ä½¿å…¶è¿”å› dataset1/dataset2ã€‚
}
```

**å¤š causalï¼ˆå¤šä¸ªç‹¬ç«‹ signalï¼‰**ï¼š`coloc.abf` å‡å®šæ¯ä¸ª trait åœ¨åˆ†æåŒºåªæœ‰ä¸€ä¸ª causal variantã€‚è‹¥æ€€ç–‘æœ‰å¤šä¸ªç‹¬ç«‹ä¿¡å·ï¼š

-   æ¨èå…ˆè¿›è¡Œ fine-mappingï¼ˆå¦‚ SuSiE æˆ–æ¡ä»¶åˆ†æï¼‰ä»¥è¯†åˆ«ç‹¬ç«‹ä¿¡å·ï¼›ç„¶åç”¨ `coloc.susie()` æˆ–å¯¹å„ç‹¬ç«‹ä¿¡å·é€å¯¹åš colocalizationã€‚
-   è‹¥ä¸åšï¼Œä¼šé”™è¯¯åœ°æŠŠå¤šä¸ªä¿¡å·æ··åˆï¼Œå¯¼è‡´ `PP.H3` æˆ– `PP.H4` è§£é‡Šå¤±çœŸã€‚

------------------------------------------------------------------------

------------------------------------------------------------------------

------------------------------------------------------------------------

å¹¶å°†ç»“æœä¿å­˜åˆ°äº† `coloc_results_summary.tsv` æ–‡ä»¶ä¸­ã€‚æ‚¨ç°åœ¨æƒ³è¦æ ¹æ®è¿™ä¸ªæ€»ç»“æ–‡ä»¶å›ç­”ä¸¤ä¸ªé—®é¢˜ï¼š

1.  **æœ‰å¤šå°‘ä¸ª Lead SNP è¾¾åˆ°äº†å…±å®šä½ (colocalization) çš„æ ‡å‡†ï¼Ÿ**

2.  **å±•ç¤º `common_snps` å­—æ®µä¸­æ•°å€¼æœ€é«˜çš„ï¼ˆå‰ 20 ä½ï¼‰ã€‚**




ä½¿ç”¨ R è¯­è¨€ä»£ç æ¥åŠ è½½å’Œåˆ†æä¿å­˜çš„ `coloc_results_summary.tsv` æ–‡ä»¶ã€‚

``` r        
# æ­¥éª¤ 1: åŠ è½½å¿…è¦çš„åº“
library(tidyverse) # æˆ–è€… library(dplyr) å’Œ library(readr)

# æ­¥éª¤ 2: è¯»å–ç»“æœæ–‡ä»¶
# âš ï¸ è¯·ç¡®ä¿è·¯å¾„æ­£ç¡®æŒ‡å‘æ‚¨çš„æ–‡ä»¶
results_df <- read_tsv("E:/acode/homwwork/data2/coloc_results_summary.tsv")

# æ­¥éª¤ 3: ç¡®å®šå…±å®šä½çš„ SNP æ•°é‡

# ğŸš© å®šä¹‰å…±å®šä½é˜ˆå€¼ï¼šé€šå¸¸ PP.H4.abf > 0.8 (æˆ– 80%) è¢«è®¤ä¸ºæ˜¯å¼ºå…±å®šä½
COLOC_THRESHOLD <- 0.8

# ç­›é€‰å‡ºå…±å®šä½æˆåŠŸçš„è¡Œ
coloc_success_df <- results_df %>%
  filter(PP.H4.abf > COLOC_THRESHOLD)

# ç»Ÿè®¡å…±å®šä½æˆåŠŸçš„æ•°é‡
coloc_count <- nrow(coloc_success_df)

# æ­¥éª¤ 4: æ’åºå¹¶å±•ç¤º common_snps æœ€é«˜çš„ (å‰ 20 ä½)

# æŒ‰ common_snps é™åºæ’åˆ—ï¼Œå¹¶é€‰æ‹©å‰ 20 è¡Œ
top_common_snps <- results_df %>%
  select(lead_key, common_snps, PP.H4.abf) %>% # åªä¿ç•™éœ€è¦çš„åˆ—
  arrange(desc(common_snps)) %>%
  head(20)

# æ­¥éª¤ 5: æ‰“å°ç»“æœ
cat("==================================================================\n")
cat(paste("1. è¾¾åˆ°å¼ºå…±å®šä½æ ‡å‡† (PP.H4.abf >", COLOC_THRESHOLD * 100, "%) çš„ Lead SNP æ•°é‡ï¼š", coloc_count, "ä¸ª\n"))
cat("==================================================================\n")
cat("\n2. äº¤é›† SNP æ•°é‡ (common_snps) æœ€é«˜çš„ Lead SNP (å‰ 20 ä½)ï¼š\n")
print(top_common_snps)
```

```r

â„¹ Use `spec()` to retrieve the full column specification for this data.
â„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
==================================================================
1. è¾¾åˆ°å¼ºå…±å®šä½æ ‡å‡† (PP.H4.abf > 80 %) çš„ Lead SNP æ•°é‡ï¼š 2831 ä¸ª
==================================================================

2. äº¤é›† SNP æ•°é‡ (common_snps) æœ€é«˜çš„ Lead SNP (å‰ 20 ä½)ï¼š
# A tibble: 20 Ã— 3
   lead_key         common_snps PP.H4.abf
   <chr>                  <dbl>     <dbl>
 1 chr1_rs3737728            55 0.0000898
 2 chr1_rs9442398            55 0.0000898
 3 chr1_rs1133647            54 0.0000898
 4 chr1_rs9442397            54 0.0000898
 5 chr1_rs12746483           54 0.0000898
 6 chr1_rs2298215            54 0.0000898
 7 chr1_rs4970401            53 0.0000898
 8 chr1_rs4326571            53 0.0000898
 9 chr1_rs11584349           53 0.0000898
10 chr1_rs7526076            53 0.0000898
11 chr1_rs4075116            53 0.0000898
12 chr1_rs9442367            53 0.0000898
13 chr1_rs3128114            49 0.0000898
14 chr1_rs2710868            49 0.0000898
15 chr1_rs1891910            47 0.0000898
16 chr1_rs6665587            47 0.0000898
17 chr1_rs3128108            47 0.0000898
18 chr1_rs3128109            47 0.0000898
19 chr1_rs111754459          47 0.0000898
20 chr1_rs2799062            47 0.0000898
```